(this["webpackJsonpspace-machine"]=this["webpackJsonpspace-machine"]||[]).push([[0],{40:function(e,t,n){e.exports=n.p+"static/media/settings.04e848f8.svg"},42:function(e,t,n){e.exports=n(86)},47:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(23),i=n.n(r),c=(n(47),n(4)),l=n(6),u=Object(l.a)({Bounder:{backgroundImage:"url(https://media.wired.com/photos/5a593a7ff11e325008172bc2/master/pass/pulsar-831502910.jpg)",width:"100vw",height:"100vh",display:"flex",fontSize:"calc(20px + 2vmin)",color:"white",position:"absolute",top:"0px",left:"0px",userSelect:"none",zIndex:"-1",overflow:"hidden"},ModuleViewBounder:{minWidth:"60vw",height:"100vh",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",zIndex:0,overflowX:"hidden",overflowY:"scroll","&::-webkit-scrollbar":{width:"0px"}}}),s="#282c34",d="#0000009e",m="#00347d",p="#001b40",f="black",v="#c0c0c038",b="#37538a",w="white",g="#007ab3",O="white",h="black",I="#cc00006e",D="#cc0000",C="red",j="#0000009e",E="white",y="#cc00006e",x="white",N="white",T="#85adad",S="#028174",M="#7D1551",R="#4C4141",k="#CA5F3C",A="#00802da6",P="#cc00006e",F={width:"400px",toggleWidth:"2vmin",item:"9vmin"},_={iconGrid:"12vmin",gutterGrid:"6vmin",icon:"10vmin",bigIcon:"27vmin",bigIconWidth:"30vmin",bigIconHeight:"50vmin"},L={large:"calc(25px + 2.8vmin)",medium:"calc(20px + 2.4vmin)",small:"calc(12px + 1.2vmin)",xsmall:"calc(8px + 1vmin)",xxsmall:"calc(7px + .8vmin)"},U={size:"2.5vmin",borderRadius:"1.5vmin"},B={size:9,markerWidth:.5,markerHeight:1.3,rotRange:[-150,150],sensitivity:1,borderWidth:8},z=Object(l.a)({DrawerBounder:{width:"0px",height:"100vh",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",color:"white",position:"absolute",top:"0px",right:"0px",userSelect:"none",zIndex:10},Drawer:{backgroundColor:d,height:"100vh",width:F.width,display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"flex-start",position:"absolute",top:"0px",right:"0px"},DrawerHeader:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"inherit",overflowX:"scroll",overflowY:"hidden","&::-webkit-scrollbar":{height:"3px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},DrawerHeaderItem:{fontSize:L.medium,padding:"1vmin 1.5vmin",color:w,textDecoration:"none",whiteSpace:"nowrap","&:hover":{cursor:"pointer"}},ItemRouter:{width:F.width,display:"flex",flexFlow:"row wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",height:"calc(100% - 60px)",overflowY:"scroll","&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},DrawerItem:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-evenly",borderRadius:"10px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",margin:"3vmin"},DrawerIcon:{backgroundColor:s,borderColor:s,borderStyle:"solid",width:F.item,height:F.item,borderRadius:"1.5vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",marginBottom:"1.5vmin","&:hover":{cursor:"pointer",borderColor:"white"}},DrawerItemText:{fontSize:L.small},Toggle:{backgroundColor:m,width:F.toggleWidth,zIndex:10,height:"100%",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{cursor:"pointer"},position:"absolute",top:"0px",right:F.width},ToggleLine:{backgroundColor:p,borderRadius:"4px",width:"0.75vmin",height:"80px"}}),H=n(10);var W=function(e){var t=e.className,n=e.text,a=e.onClick,r={color:e.selectedRoute===n?g:w};return o.a.createElement("div",{className:t,onClick:a,style:r},n)},K="CONTAINER",G="VALUE",q=[["gain","gain","GAIN"],["filter","filter","AUTOFILTER"],["kompressor","komp","KOMPRESSOR"],["signal delay","delay","SIGNAL_DELAY"],["stereo panner","pan","STEREO_PANNER"]],V=[["file","file","MEDIA_ELEMENT"],["stream","stream","LINE_IN"],["oscillator","osc","OSCILLATOR"],["constant","const","CONSTANT"]],Y=[["container","cntnr",K],["output","out","OUTPUT"]];function Q(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function X(e,t){for(var n=[],a=e;a<t;a++)n.push(a);return n}function J(e,t){return Math.min(t[1],Math.max(t[0],e))}function $(e,t){return e>=t[0]&&e<=t[1]}var Z=function(e){switch(e){case"LINE_IN":case"OSCILLATOR":case"MEDIA_ELEMENT":case"CONSTANT":return S;case"GAIN":case"AUTOFILTER":case"KOMPRESSOR":case"SIGNAL_DELAY":case"STEREO_PANNER":return M;case K:return R;case"OUTPUT":return k}},ee=0;var te=function(e){var t=e.fullName,n=e.id,a=e.moduleType,r=z();return o.a.createElement("div",{className:r.DrawerItem},o.a.createElement("div",{className:r.DrawerIcon,style:{backgroundColor:Z(a)},draggable:!0,onDragStart:function(e){e.dataTransfer.setData("id","".concat(n," ").concat(ee)),e.dataTransfer.setData("moduleType",a),e.dataTransfer.setData("name",n),window.setFillIsExpanded(!0),ee+=1},onDragEnd:function(){window.setFillIsExpanded(!1)}}),o.a.createElement("div",{className:r.DrawerItemText},t))};var ne=function(e){var t=e.moduleData;return o.a.createElement(a.Fragment,null,t.map((function(e,t){return o.a.createElement(te,{fullName:e[0],id:e[1],moduleType:e[2],key:t})})))},ae=n(38),oe=n.n(ae),re=n(39),ie=n.n(re),ce=n(5),le=function(e,t,n,a,o,r,i,c,l){return{type:"ADD_MODULE",moduleType:n,id:e,name:t,controlData:a,row:r,col:i,parentID:o,connectionInputs:c,connectionOutputs:l}},ue=function(e,t,n){return{type:"MOVE_MODULE",id:e,newRow:t,newCol:n}},se=function(e,t,n){return{type:"MARK_CONTAINER_CONTROL",modID:e,controlID:t,actualModID:n}},de=function(e,t,n){return{type:"UNMARK_CONTAINER_CONTROL",modID:e,controlID:t,actualModID:n}},me=function(e,t,n){return{type:"UPDATE_CONTROL_DATA",modID:e,controlID:t,newValue:n}},pe=function(e,t,n,a,o,r,i){return{type:"ADD_CONNECTION",fromID:e,toID:t,param:n,outputIndex:a,inputIndex:o,containerOutputChildID:r,containerInputChildID:i}},fe=function(e){return{type:"REMOVE_CONNECTION",connectionID:e}};function ve(e){return{type:"RESTORE_FROM_STATE",state:e}}var be=n(2),we=n(1),ge=new(0,window.AudioContext);var Oe=function(e){var t=ge.createConstantSource();t.offset.value=e?e.value.value:0;var n={value:function(e){t.offset.value=Number(e)},kill:function(){t.stop()}};return t.start(),{audioNode:t,connectingParamIDs:["offset"],controlSetFuncs:n}},he=["lowpass","lowshelf","highpass","highshelf","allpass","bandpass","notch","peaking"],Ie=["frequency","detune","Q","gain"];var De=function(e){var t=ge.createBiquadFilter();e&&(t.type=e["set type"].value,t.frequency.value=e.frequency.value,t.detune.value=e.detune.value,t.Q.value=e.Q.value,t.gain.value=e.gain.value);var n={"set type":function(e){t.type=e},frequency:function(e){t.frequency.value=Number(e)},detune:function(e){t.detune.value=Number(e)},Q:function(e){t.Q.value=Number(e)},gain:function(e){t.gain.value=Number(e)}};return{audioNode:t,typeTypes:he,connectingParamIDs:Ie,controlSetFuncs:n}};var Ce=function(e){ge.resume();var t=ge.createGain();t.connect(ge.destination),t.gain.value=e?e["master gain"].value:1;var n={"master gain":function(e){t.gain.value=Number(e)},resume:function(e){ge.resume()},suspend:function(e){ge.suspend()}};return{audioNode:t,connectingParamIDs:[],controlSetFuncs:n}};var je=function(e){var t=ge.createStereoPanner();e&&(t.pan.value=e.pan.value);var n={pan:function(e){t.pan.value=Number(e)}};return{audioNode:t,connectingParamIDs:["pan"],controlSetFuncs:n}};var Ee=function(e){var t=ge.createDelay(60);e&&(t.delayTime.value=e["delay time"].value);var n={"delay time":function(e){t.delayTime.value=Number(e)}};return{audioNode:t,connectingParamIDs:["delayTime"],controlSetFuncs:n}};var ye=function(e){var t=ge.createDynamicsCompressor();e&&(t.threshold.value=e.threshold.value,t.knee.value=e.knee.value,t.ratio.value=e.ratio.value,t.attack.value=e.attack.value,t.release.value=e.release.value);var n={threshold:function(e){t.threshold.value=Number(e)},knee:function(e){t.knee.value=Number(e)},ratio:function(e){t.ratio.value=Number(e)},attack:function(e){t.attack.value=Number(e)},release:function(e){t.release.value=Number(e)}};return{audioNode:t,connectingParamIDs:["threshold","knee","ratio","attack","release"],controlSetFuncs:n}};var xe=function(e){var t=ge.createGain();t.gain.value=e?e.gain.value:0;var n={gain:function(e){t.gain.value=Number(e)}};return{audioNode:t,connectingParamIDs:["gain"],controlSetFuncs:n}};var Ne=["sine","square","triangle","sawtooth"];var Te=function(e){var t=ge.createOscillator();e&&(t.type=e["set type"].value,t.frequency.value=e.frequency.value,t.detune.value=e.detune.value);var n={"set type":function(e){t.type=e},frequency:function(e){t.frequency.value=Number(e)},detune:function(e){t.detune.value=Number(e)},kill:function(){t.stop()}};return t.start(),{audioNode:t,typeTypes:Ne,connectingParamIDs:["frequency","detune"],controlSetFuncs:n}};var Se=function(e){navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1,latency:0}}).then((function(t){var n=ge.createMediaStreamSource(t),a=ge.createChannelSplitter(2);n.connect(a);var o={audioNode:a,connectingParamIDs:[],controlSetFuncs:{mute:function(e){t.getAudioTracks()[0].enabled="true"===e}}};window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,o))}))};var Me=function(e){return{connectingParamIDs:[],controlSetFuncs:{open:function(){window.fillContainerID=e,window.highlightedID="",window.currUnHighlight=function(){},window.reRenderFillContainer()}}}};var Re=function(e,t,n){switch(t){case"OSCILLATOR":var a=Te(n);window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,a));break;case"GAIN":var o=xe(n);window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,o));break;case"OUTPUT":var r=Ce(n);window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,r));break;case"AUTOFILTER":var i=De(n);window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,i));break;case"KOMPRESSOR":var c=ye(n);window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,c));break;case"STEREO_PANNER":var l=je(n);window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,l));break;case"SIGNAL_DELAY":var u=Ee(n);window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,u));break;case"CONSTANT":var s=Oe(n);window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,s));break;case"MEDIA_ELEMENT":window.addAudioTag(e),window.reRenderAudioTags();break;case"LINE_IN":Se(e);break;case K:var d=Me(e);window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,d))}};function ke(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;0===n.length?e.audioNode.connect(t.audioNode,a,o):t.audioNode[n]?e.audioNode.connect(t.audioNode[n],a):alert("param does not exist")}function Ae(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0;0===n.length?"number"===typeof a?e.audioNode.disconnect(t.audioNode,a):e.audioNode.disconnect(t.audioNode):t.audioNode[n]?"number"===typeof a?e.audioNode.disconnect(t.audioNode[n],a):e.audioNode.disconnect(t.audioNode[n]):alert("param does not exist")}var Pe=oe()(),Fe=ie()("http://192.168.1.81:30300");Pe.configure(Fe.fetch(window.fetch)),window.spaceDBSaveService=Pe.service("spaceDB-save-service");var _e={backgroundColor:"transparent"};var Le=function(){var e=Object(a.useState)([]),t=Object(c.a)(e,2),n=t[0],r=t[1],i=Object(ce.b)();return Object(a.useEffect)((function(){window.spaceDBSaveService.find().then((function(e){r(e)}))}),[]),o.a.createElement("div",null,o.a.createElement(ft,{style:_e,onClick:function(){window.spaceDBSaveService.find().then((function(e){r(e)}))}},"refresh saves"),o.a.createElement("div",null,n.map((function(e){return o.a.createElement("div",{style:{display:"flex",flexDirection:"row"},key:e},o.a.createElement(ft,{style:_e,onClick:function(){window.spaceDBSaveService.get(e).then((function(e){i(ve(e)),function(e){var t=e.modules,n=e.connections;Object.keys(t).forEach((function(e){var n=t[e],a=n.moduleType,o=n.controlData;Re(e,a,o),console.log(window.audioModules)})),n&&Object.keys(n).forEach((function(e){var a=n[e],o=a.fromID,r=a.toID,i=a.param,c=a.outputIndex,l=a.inputIndex,u=a.actualOutputID,s=a.actualInputID,d=t[s||r].moduleType,m=t[u||o].moduleType;"MEDIA_ELEMENT"===d||"MEDIA_ELEMENT"===m||"LINE_IN"===d||"LINE_IN"===m?window.setTimeout((function(){ke(window.audioModules[u||o],window.audioModules[s||r],i,c,l)}),200):ke(window.audioModules[u||o],window.audioModules[s||r],i,c,l)}))}(e)}))}},e),o.a.createElement(ft,{style:{backgroundColor:I},onClick:function(){window.openConfirmDeleteMenu(e,(function(){window.setTimeout((function(){window.spaceDBSaveService.find().then((function(e){r(e)}))}),1e3)}))}},"delete"))}))),o.a.createElement(ft,{style:_e,onClick:function(){window.openSaveMenu(n,(function(){window.setTimeout((function(){window.spaceDBSaveService.find().then((function(e){r(e)}))}),1e3)}))}},"save"))};var Ue=window.require("fs");var Be=function(){var e=Object(ce.c)((function(e){return e})),t=Object(a.useRef)(null),n=e.modules[e.baseContainerID].name,r=Object(a.useState)(n),i=Object(c.a)(r,2),l=i[0],u=i[1],s=Object(ce.b)();return Object(a.useEffect)((function(){window.setTimeout((function(){t.current&&(t.current.webkitdirectory=!0)}),50)}),[]),o.a.createElement("div",null,o.a.createElement("label",{htmlFor:"chooseFile"},o.a.createElement(ft,null,"open file")),o.a.createElement("input",{style:{width:0,height:0,opacity:0},id:"chooseFile",type:"file",onChange:function(e){var t=e.target.files[0];if(t){var n=t.path;Ue.readFile(n,(function(e,t){if(e)throw e;var n=JSON.parse(t);s(ve(n)),ve(n)})),console.log(n)}}}),o.a.createElement("input",{style:{fontSize:L.small},placeholder:n,value:l,onChange:function(e){u(e.target.value)}}),o.a.createElement("label",{htmlFor:"chooseFolder"},o.a.createElement(ft,null,"save (select folder)")),o.a.createElement("input",{style:{width:0,height:0,opacity:0},id:"chooseFolder",type:"file",ref:t,onChange:function(t){var n=function(e){for(var t=e.length;t>0;t--)if("/"===e[t])return e.slice(0,t+1);return e}(t.target.files[0].path);""!==l&&(console.log(n+l+".sm"),Ue.writeFile(n+l+".sm",JSON.stringify(e),(function(e){if(console.log("saved maybe"),e)throw e})))}}))},ze=F.width;var He=function(){var e=z(),t=Object(a.useState)(!0),n=Object(c.a)(t,2),r=n[0],i=n[1],l=Object(a.useState)(ze),u=Object(c.a)(l,2),s=u[0],d=u[1],m=Object(H.b)({transform:r?"translate(0px, 0px)":"translate(".concat(s,"px, 0px)"),config:{tension:220,clamp:!0}}),p=Object(a.useState)("sources"),f=Object(c.a)(p,2),v=f[0],b=f[1],w=Object(a.useRef)(null),g=Object(a.useRef)(null),O=Object(a.useRef)(null),h=Object(a.useRef)(null),I=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),D=!1,C=Object(a.useState)({}),j=Object(c.a)(C,2)[1];return Object(a.useEffect)((function(){window.addEventListener("resize",(function(){window.setTimeout((function(){j({})}),500)}))})),o.a.createElement(H.a.div,{className:e.DrawerBounder,style:m,onPointerDown:function(e){return e.stopPropagation()}},o.a.createElement("div",{className:e.Toggle,ref:g,onPointerDown:function(e){var t;r&&e.shiftKey?(D=!0,null===(t=g.current)||void 0===t||t.setPointerCapture(e.pointerId)):i(!r)},onPointerMove:function(e){D&&(ze="".concat(J(I-e.clientX,[150,700]),"px"),w.current&&(w.current.style.width=ze),O.current&&(O.current.style.width=ze),h.current&&(h.current.style.width=ze),g.current&&(g.current.style.right=ze))},onPointerUp:function(e){var t;D&&(D=!1,d(ze),null===(t=g.current)||void 0===t||t.releasePointerCapture(e.pointerId))}},o.a.createElement("div",{className:e.ToggleLine,onClick:function(){i(!r)}})),o.a.createElement("div",{className:e.Drawer,ref:w},o.a.createElement("div",{className:e.DrawerHeader,ref:O,onWheel:function(e){O&&O.current&&(O.current.scrollLeft+=e.deltaY)}},o.a.createElement(W,{className:e.DrawerHeaderItem,text:"sources",onClick:function(){b("sources")},selectedRoute:v}),o.a.createElement(W,{className:e.DrawerHeaderItem,text:"effects",onClick:function(){b("effects")},selectedRoute:v}),o.a.createElement(W,{className:e.DrawerHeaderItem,text:"utility",onClick:function(){b("utility")},selectedRoute:v}),o.a.createElement(W,{className:e.DrawerHeaderItem,text:"spaceDB",onClick:function(){b("spaceDB")},selectedRoute:v}),o.a.createElement(W,{className:e.DrawerHeaderItem,text:"file",onClick:function(){b("file")},selectedRoute:v})),o.a.createElement("div",{className:e.ItemRouter,ref:h},"sources"===v?o.a.createElement(ne,{moduleData:V}):"effects"===v?o.a.createElement(ne,{moduleData:q}):"utility"===v?o.a.createElement(ne,{moduleData:Y}):"spaceDB"===v?o.a.createElement(Le,null):"file"===v?o.a.createElement(Be,null):null)))},We=Object(l.a)({FillBounder:{backgroundColor:v,display:"flex",flexDirection:"column",margin:"5vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderRadius:"2vmin"},FillHeaderBounder:{display:"flex",justifyContent:"space-between"},FillHeader:{borderColor:"white",borderStyle:"none none none none",padding:"1vmin",marginLeft:"2vmin","&:hover":{cursor:"pointer"}},Fill:{display:"grid",minWidth:_.iconGrid,minHeight:_.iconGrid,padding:"4vmin",zIndex:1,rowGap:_.gutterGrid,columnGap:_.gutterGrid},ArcherContainer:{width:"100%",height:"100%",zIndex:0,display:"grid"},Icon:{backgroundColor:b,borderRadius:"1.5vmin",borderStyle:"none",borderColor:"white",whiteSpace:"wrap",fontSize:L.medium,padding:"1vmin",display:"flex",flexFlow:"column nowrap",alignItems:"flex-end",justifyContent:"space-between",overflow:"hidden",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)","&:hover":{cursor:"pointer",borderStyle:"solid"},zIndex:2},IconControlContainer:{width:_.bigIconWidth,maxHeight:_.bigIconHeight,justifySelf:"flex-end",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",overflowY:"scroll",overflowX:"hidden"},ArcherElement:{zIndex:1,display:"grid",backgroundColor:"transparent",gridTemplateRows:"10px auto 10px",gridTemplateColumns:"10px auto 10px",padding:"1vmin"},IconName:{fontSize:L.small,"&:hover":{cursor:"pointer"}},IconConnector:{backgroundColor:C,width:U.size,height:U.size,borderRadius:U.borderRadius,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderStyle:"solid",borderColor:"transparent","&:hover":{cursor:"pointer",borderColor:"white"},justifySelf:"flex-start",alignSelf:"flex-end"}}),Ke=n(19),Ge=Object(l.a)({MenuHeader:{fontSize:L.medium,borderStyle:"none none solid none",margin:"1vmin",width:"90%"},Connection:{fontSize:L.small,backgroundColor:v,margin:".5vmin 3vmin",borderRadius:"1vmin",borderColor:"transparent",borderStyle:"solid",minWidth:"30%",padding:"1vmin",display:"flex",justifyContent:"center",alignItems:"center","&:hover":{cursor:"pointer",borderColor:I},boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},ControlBounder:{display:"flex",flexFlow:"row wrap",alignItems:"center",fontSize:L.small,margin:"0vmin 1vmin"},ControlMenu:{display:"flex",flexFlow:"row wrap",width:"100%",alignItems:"center",justifyContent:"center"}}),qe=Object(l.a)({ControlTypeSelect:{minWidth:"9vmin",maxWidth:"5em",margin:"1vmin",fontSize:L.small,backgroundColor:j,color:E,textAlign:"center"},ControlInput:{minWidth:"9vmin",maxWidth:"5em",margin:"1vmin",fontSize:L.small},ControlMenu:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center"}});var Ve=function(e){var t=e.controlID,n=e.setFunc,a=e.reRenderIcon,r=e.modName,i=qe();return o.a.createElement("div",{className:i.ControlMenu},o.a.createElement("label",{style:{minWidth:"50%"},htmlFor:window.highlightedID+t},o.a.createElement(ft,{style:{borderColor:I}},r?"".concat(r," - ").concat(t):t)),o.a.createElement("input",{style:{width:0,height:0,opacity:0},type:"file",id:window.highlightedID+t,onChange:function(e){var t=e.target.files[0];n(URL.createObjectURL(t)),window.audioTags[window.highlightedID].srcName=t.name,window.reRenderAudioTags(),a()}}),o.a.createElement("p",{style:{fontSize:L.xsmall,textAlign:"center",whiteSpace:"normal",justifyContent:"center",width:"100%",overflowWrap:"break-word",wordWrap:"break-word",hyphens:"auto"}},window.audioTags[window.highlightedID].srcName))};var Ye=function(e){var t=e.setFunc,n=e.audioModule,r=e.controlID,i=e.value,c=e.modID,l=e.modName,u=qe(),s=n.audioNode,d=Object(ce.b)();return o.a.createElement(a.Fragment,null,o.a.createElement("label",{htmlFor:"type"},l?"set type - ".concat(l):"set type"),o.a.createElement("select",{className:u.ControlTypeSelect,name:"type",id:"type",onChange:function(e){t(e.target.value),d(me(c,r,e.target.value))},value:i||s.type},n.typeTypes.map((function(e){return o.a.createElement("option",{value:e,key:c+e},e)}))))};function Qe(e,t){return(e-t[0])/(t[1]-t[0])*(B.rotRange[1]-B.rotRange[0])+B.rotRange[0]}function Xe(e){var t=(Math.floor(10*e)/10).toString();return"."===t.slice(t.length-2,t.length-1)?t:t+".0"}var Je=function(e){var t=e.controlID,n=e.setFunc,r=e.actualModID,i=e.displayModName,l=r||window.highlightedID,u=Object(ce.c)((function(e){return[e.modules[l].controlData[t].value,e.modules[l].controlData[t].range]})),s=Object(c.a)(u,2),d=s[0],m=s[1],p=Object(a.useState)(Xe(d)),f=Object(c.a)(p,2),v=f[0],b=f[1],w=Object(ce.b)();return o.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},o.a.createElement(Ct,{initValue:d,range:m,inputVal:v,setInputVal:b,onEveryChange:function(e){n(e.toString())},onChange:function(e){n(e.toString()),w(me(l,t,e))},onSettingsClick:function(){window.openRangeSetMenu(l,t,(function(e){n(J(d,e).toString()),b(Xe(J(d,e))),w(function(e,t,n){return{type:"UPDATE_CONTROL_RANGE",modID:e,controlID:t,newRange:n}}(l,t,e))}))}}),o.a.createElement("div",null,i?"".concat(i," - ").concat(t):t))};var $e=function(e){var t=e.setFunc,n=e.controlID,a=e.modName;return o.a.createElement(ft,{style:{borderColor:I,width:"50%"},onClick:function(){t("")}},a?"".concat(a," - ").concat(n):n)};var Ze=function(e){var t=e.controlID,n=e.setFunc,a=e.actualModID,r=e.modName,i=Object(ce.c)((function(e){return e.modules[a].controlData[t].value}));return o.a.createElement(Ot,{text:r?"".concat(r," - ").concat(t):t,initState:i,onSwitch:function(e){n(e?"true":"false")}})};var et=function(e){var t=e.audioModule,n=e.selectedModule,a=e.reRenderIcon,r=Ge();return o.a.createElement("div",{className:r.ControlMenu},Object.keys(n.controlData).map((function(e,i){var c=n.controlData[e],l=c.controlType,u=c.value,s=t.controlSetFuncs[e];return o.a.createElement("div",{className:r.ControlBounder,key:n.id+e+i},l===G?o.a.createElement(Je,{controlID:e,setFunc:s}):"BUTTON"===l?o.a.createElement($e,{setFunc:s,controlID:e}):"TYPE"===l?o.a.createElement(Ye,{setFunc:s,audioModule:t,controlID:e,value:u,modID:n.id}):"FILE"===l?o.a.createElement(Ve,{controlID:e,setFunc:s,reRenderIcon:a}):"SWITCH"===l?o.a.createElement(Ze,{controlID:e,setFunc:s,actualModID:n.id}):null)})))};var tt=function(e){var t=e.selectedModule,n=e.modules,r=Ge(),i=Object(ce.b)(),c=window.audioModules,l=Object(ce.c)((function(e){return e.connections}));return o.a.createElement(a.Fragment,null,t?0===t.inputs.length?null:o.a.createElement("div",{className:r.MenuHeader},"inputs"):null,t?t.inputs.map((function(e,a){var u=l[e],s=u.fromID,d=u.param,m=u.outputIndex,p=u.actualOutputID,f=u.actualInputID,v=n[s].name;return o.a.createElement("div",{className:r.Connection,key:s+d+"inp"+a,onClick:function(){i(fe(e)),Ae(c[p||s],c[f||t.id],d,m)}},"".concat(v).concat(p?" - ".concat(n[p].name):"").concat(0!==d.length?" - ".concat(d):""))})):null,t?0===t.outputs.length?null:o.a.createElement("div",{className:r.MenuHeader},"outputs"):null,t?t.outputs.map((function(e,a){var u=l[e],s=u.toID,d=u.param,m=u.outputIndex,p=u.actualOutputID,f=u.actualInputID,v=n[s].name;return o.a.createElement("div",{className:r.Connection,key:s+d+"out"+a,onClick:function(){i(fe(e)),Ae(c[p||t.id],c[f||s],d,m)}},"".concat(v).concat(f?" - ".concat(n[f].name):"").concat(0!==d.length?" - ".concat(d):""))})):null)};var nt=function(e){var t=e.selectedModule,n=Object(a.useState)(!1),r=Object(c.a)(n,2),i=r[0],l=r[1],u=Object(ce.b)(),s=Object(ce.c)((function(e){return e.modules}));return o.a.createElement(a.Fragment,null,o.a.createElement(ft,{style:{fontSize:L.xsmall,marginTop:"2vmin"},onClick:function(){l(!i)}},"mark container controls"),o.a.createElement("div",null,i?Object.keys(t.controlData).map((function(e,n){return o.a.createElement(Ot,{initState:Q(t.id+e,t.toContainerControls),text:e,style:{fontSize:L.xsmall,padding:"1vmin"},key:e+n,onSwitch:function(n){u(n?se(t.id,e,t.id):de(t.id,e,t.id))}})})):null,i&&t.moduleType===K?t.containerControls.map((function(e,n){var a=e.modID,r=e.controlID,i=e.actualModID,c=s[a].name;return o.a.createElement(Ot,{initState:Q(i+r,t.toContainerControls),text:"".concat(c," - ").concat(r),style:{fontSize:L.xsmall,padding:"1vmin"},key:a+n,onSwitch:function(e){u(e?se(t.id,r,i):de(t.id,r,i))}})})):null))},at={fontSize:L.xsmall,padding:"1vmin"};var ot=function(e){var t=e.baseContainerID,n=e.selectedModule,r=Object(ce.b)();return n&&window.fillContainerID!==t?o.a.createElement(a.Fragment,null,0===Object.keys(window.audioModules[n.id]).length?null:o.a.createElement(nt,{selectedModule:n}),0===n.connectionInputs.length?null:o.a.createElement(Ot,{style:at,key:n.id+"inputSwitch",text:"mark as container input",initState:n.isContainerInput,onSwitch:function(e){r(e?{type:"MARK_CONTAINER_INPUT",id:window.highlightedID}:function(e){return{type:"UNMARK_CONTAINER_INPUT",id:e}}(window.highlightedID))}}),0===n.connectionOutputs.length?null:o.a.createElement(Ot,{style:at,key:n.id+"outputSwitch",text:"mark as container output",initState:n.isContainerOutput,onSwitch:function(e){r(e?{type:"MARK_CONTAINER_OUTPUT",id:window.highlightedID}:function(e){return{type:"UNMARK_CONTAINER_OUTPUT",id:e}}(window.highlightedID))}})):null};var rt=function(e){var t=e.selectedModule,n=window.audioModules,a=Object(ce.b)(),r=Object(ce.c)((function(e){return e.connections}));return o.a.createElement(ft,{style:{backgroundColor:I,width:"50%",fontSize:L.small},onClick:function(){t.inputs.forEach((function(e){var t=r[e],a=t.fromID,o=t.toID,i=t.param,c=t.outputIndex,l=t.actualOutputID,u=t.actualInputID;Ae(n[l||a],n[u||o],i,c)})),t.outputs.forEach((function(e){var t=r[e],a=t.fromID,o=t.toID,i=t.param,c=t.outputIndex,l=t.actualOutputID,u=t.actualInputID;Ae(n[l||a],n[u||o],i,c)})),a({type:"REMOVE_MODULE",id:window.highlightedID}),window.highlightedID=""}},"delete")};var it=function(e){var t=e.selectedModule,n=e.reRenderIcon,a=Ge(),r=Object(ce.c)((function(e){return e.modules}));return o.a.createElement("div",{className:a.ControlMenu},t.containerControls.map((function(e,i){var c=e.modID,l=e.controlID,u=e.actualModID,s=window.audioModules[u],d=r[c].controlData[l],m=d.controlType,p=d.value,f=s.controlSetFuncs[l],v=r[c].name;return o.a.createElement("div",{className:a.ControlBounder,key:c+l+i},m===G?o.a.createElement(Je,{controlID:l,setFunc:f,actualModID:u,displayModName:v}):"BUTTON"===m?o.a.createElement($e,{setFunc:f,controlID:l,modName:v}):"TYPE"===m?o.a.createElement(Ye,{setFunc:f,audioModule:s,controlID:l,value:p,modID:t.id,modName:v}):"FILE"===m?o.a.createElement(Ve,{controlID:l,setFunc:f,reRenderIcon:n,modName:v}):"SWITCH"===m?o.a.createElement(Ze,{controlID:l,setFunc:f,actualModID:u,modName:v}):null)})))};window.currUnHighlight=function(){};var ct=function(e){var t=e.mod,n=e.gridCol,r=e.gridRow,i=We(),l=Object(a.useState)(t.id===window.highlightedID),u=Object(c.a)(l,2),s=u[0],d=u[1],m=Object(a.useState)(!1),p=Object(c.a)(m,2),f=p[0],v=p[1],b=Object(a.useState)(!1),w=Object(c.a)(b,2),g=w[0],O=w[1];function h(){O(!g)}var I={gridColumn:"".concat(n," / span 1"),gridRow:"".concat(r," / span 1"),borderStyle:s?"solid":"none",backgroundColor:Z(t.moduleType)},D={gridColumn:"".concat(n," / span 1"),gridRow:"".concat(r," / span 1")},C=Object(H.b)({width:s?_.bigIconWidth:_.icon,height:s?_.bigIconHeight:_.icon,config:{tension:350,clamp:!0},onFrame:window.refreshArcherContainer,onRest:function(){v(s)}}),j=Object(H.b)({fontSize:s?L.medium:L.small,config:{tension:350,clamp:!0}}),E=Object(ce.c)((function(e){return e})),y=E.modules,x=E.baseContainerID,N=E.connections,T=Object(ce.b)();return o.a.createElement(a.Fragment,null,o.a.createElement(H.a.div,{className:i.Icon,style:Object.assign({},C,I),onPointerDown:function(e){return e.stopPropagation()},onDragOver:function(e){e.preventDefault()},onDrop:function(e){var n=e.dataTransfer.getData("id");if(n){if(y[n]){var a=e.dataTransfer.getData("fromRow"),o=e.dataTransfer.getData("fromCol");window.setFillIsExpanded(!1),T(ue(n,t.row,t.col)),T(ue(t.id,Number(a),Number(o))),window.setTimeout(window.refreshArcherContainer,100)}}else if(0===t.connectionInputs.length&&0===window.audioModules[t.id].connectingParamIDs.length)alert("mod cannot accept input");else{var r=e.dataTransfer.getData("fromID");r&&window.openConnectionMenu(r,t.id)}d(!1)},draggable:!s,onDragStart:function(e){e.dataTransfer.setData("id",t.id),e.dataTransfer.setData("fromRow","".concat(t.row)),e.dataTransfer.setData("fromCol","".concat(t.col)),window.setFillIsExpanded(!0)},onDragEnd:function(){window.setFillIsExpanded(!1)},onClick:function(e){e.stopPropagation&&e.stopPropagation(),t.id===window.highlightedID?(window.currUnHighlight(),window.currUnHighlight=function(){}):(window.currUnHighlight(),d(!0),window.highlightedID=t.id,window.currUnHighlight=function(){window.highlightedID="",v(!1),d(!1)})}},0===t.connectionOutputs.length?null:o.a.createElement("div",{className:i.IconConnector,draggable:!0,onDragStart:function(e){e.stopPropagation(),e.dataTransfer.setData("fromID",t.id)}}),o.a.createElement(H.a.div,{className:i.IconName,style:j,onClick:function(e){s&&(e.stopPropagation(),window.openRenameMenu(t.id))}},t.name),f?o.a.createElement("div",{className:i.IconControlContainer,onClick:function(e){return e.stopPropagation()}},t.moduleType===K?o.a.createElement(it,{selectedModule:t,reRenderIcon:h}):null,o.a.createElement(et,{audioModule:window.audioModules[t.id],selectedModule:t,reRenderIcon:h}),o.a.createElement(tt,{selectedModule:t,modules:y}),o.a.createElement(ot,{baseContainerID:x,selectedModule:t}),o.a.createElement(rt,{selectedModule:t})):null),o.a.createElement(H.a.div,{className:i.ArcherElement,style:Object.assign({},C,D)},o.a.createElement("div",{style:{gridColumn:"".concat(1," / span 1"),gridRow:"".concat(1," / span 1")}},o.a.createElement(Ke.ArcherElement,{id:t.id+" input"},o.a.createElement("div",{style:{width:"10px",height:"10px"}}))),o.a.createElement("div",{style:{gridColumn:"".concat(1," / span 1"),gridRow:"".concat(3," / span 1")}},o.a.createElement(Ke.ArcherElement,{id:t.id+" controls"},o.a.createElement("div",{style:{width:"10px",height:"10px"}}))),o.a.createElement("div",{style:{gridColumn:"".concat(3," / span 1"),gridRow:"".concat(1," / span 1")}},o.a.createElement(Ke.ArcherElement,{id:t.id+" output",relations:t.outputs.filter((function(e){var t=N[e],n=t.fromID;return t.actualOutputID!==n})).map((function(e){var t=N[e],n=t.toID,a=t.param;return{targetId:""===a?n+" input":n+" controls",targetAnchor:"left",sourceAnchor:"right",style:{strokeColor:""===a?"red":"blue"}}}))},o.a.createElement("div",{style:{width:"10px",height:"10px"}})))))};var lt=Object(l.a)({DropSquare:{width:_.iconGrid,height:_.iconGrid,borderStyle:"solid",borderRadius:"10px",zIndex:1}});var ut=function(e){var t=e.row,n=e.col,r=lt(),i=Object(ce.b)(),l=Object(ce.c)((function(e){return{modules:e.modules}})).modules,u=Object(a.useState)(!1),s=Object(c.a)(u,2),d=s[0],m=s[1],p={gridColumn:"".concat(n+1," / span 1"),gridRow:"".concat(t+1," / span 1"),borderColor:d?O:"transparent"};return o.a.createElement("div",{className:r.DropSquare,style:p,onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){3===e.dataTransfer.types.length&&m(!0)},onDragLeave:function(e){3===e.dataTransfer.types.length&&m(!1)},onDrop:function(e){var a=e.dataTransfer.getData("id"),o=l[window.fillContainerID],r=o.childModules.concat(o.childModules),c=l[a],u=function(e,t,n,a){for(var o=0;o<n.length;o++){var r=a[n[o]];if(r.row===e&&r.col===t)return r.id}return!1}(t,n,r,l);if(c)if(u){var s=e.dataTransfer.getData("fromRow"),d=e.dataTransfer.getData("fromCol");m(!1),window.setFillIsExpanded(!1),i(ue(a,t,n)),i(ue(u,Number(s),Number(d))),window.setTimeout(window.refreshArcherContainer,1)}else m(!1),window.setFillIsExpanded(!1),i(ue(a,t,n)),window.setTimeout(window.refreshArcherContainer,1);else if(!u){var p=e.dataTransfer.getData("moduleType"),f=e.dataTransfer.getData("name");m(!1),window.addModule(a,f,window.fillContainerID,p,i,t,n),window.setFillIsExpanded(!1)}}})};var st=function(){var e=We(),t=Object(a.useState)(!1),n=Object(c.a)(t,2),r=n[0],i=n[1];window.setFillIsExpanded=i;var l=Object(a.useState)(!1),u=Object(c.a)(l,2),s=u[0],d=u[1];window.reRenderFillContainer=function(){d(!s)};var m,p=Object(ce.c)((function(e){return{modules:e.modules,baseContainerID:e.baseContainerID}})),f=p.modules,v=p.baseContainerID,b=f[window.fillContainerID],w=function(e,t){var n=0,a=0;return e.forEach((function(e){var o=t[e];o.row>n&&(n=o.row),o.col>a&&(a=o.col)})),{maxRow:n,maxCol:a}}(b.childModules,f),g=w.maxRow,O=w.maxCol,h=0===b.childModules.length;m=h?{gridTemplateRows:"repeat(".concat(1,", ","auto",")"),gridTemplateColumns:"repeat(".concat(1,", ","auto",")")}:{gridTemplateRows:"repeat(".concat(r?g+2:g+1,", ","auto",")"),gridTemplateColumns:"repeat(".concat(r?O+2:O+1,", ","auto",")")};var I=Object(a.useRef)(null);return window.refreshArcherContainer=function(){var e;null===(e=I.current)||void 0===e||e.refreshScreen()},o.a.createElement("div",{className:e.FillBounder},o.a.createElement("div",{className:e.FillHeaderBounder},o.a.createElement("div",{className:e.FillHeader,style:{width:"".concat(b.name.length/2,"em")},onClick:function(e){e.stopPropagation(),window.openRenameMenu(window.fillContainerID)},onPointerDown:function(e){return e.stopPropagation()}},b.name),b.id===v?null:o.a.createElement(ft,{style:{height:".7em"},onPointerDown:function(){window.fillContainerID=b.parentID,window.currUnHighlight(),window.reRenderFillContainer()}},o.a.createElement("div",null,"back"))),o.a.createElement(Ke.ArcherContainer,{ref:I,svgContainerStyle:{zIndex:-1},strokeWidth:4,arrowLength:0},o.a.createElement("div",{className:e.Fill,style:m},h?o.a.createElement(ut,{row:0,col:0}):X(0,r?g+2:g+1).map((function(e){return X(0,r?O+2:O+1).map((function(t){return o.a.createElement(ut,{key:"".concat(e," ").concat(t),row:e,col:t})}))})).flat(),b.childModules.map((function(e){var t=f[e];return o.a.createElement(ct,{key:t.id,mod:t,gridRow:t.row+1,gridCol:t.col+1})})))))};var dt=Object(l.a)({CenterMenuBounder:{backgroundColor:"rgba(0,0,0,0.7)",position:"absolute",top:0,left:0,width:"100vw",height:"100vh",zIndex:100},CenterMenu:{backgroundColor:f,position:"absolute",top:"50vh",left:"50vw",transform:"translate(-50%, calc(-50% - 50px))",display:"flex",flexDirection:"column",alignItems:"center",borderRadius:"2vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",minWidth:"15vw",padding:"1vmin 2vmin 2vmin 2vmin",border:"1px solid white",zIndex:101},Header:{padding:"1vmin 2vmin",margin:"0vmin 0vmin 2vmin 0vmin",borderColor:"white",borderStyle:"none none solid none",fontSize:L.large}});var mt=function(e){var t=e.children,n=e.header,a=e.onClose,r=dt();return o.a.createElement("div",{className:r.CenterMenuBounder,onPointerDown:function(e){e.stopPropagation(),a()}},o.a.createElement("div",{className:r.CenterMenu,onPointerDown:function(e){e.stopPropagation()}},o.a.createElement("div",{className:r.Header},n),t))};Object(l.a)({TestingArea:{backgroundColor:"black",position:"absolute",top:"45vh",left:"25vw",width:"45vw",height:"50vh",display:"flex",flexDirection:"column",zIndex:150},ButtonDiv:{display:"flex",flexFlow:"row wrap"},Button:{margin:"2vmin",padding:"1vmin",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{cursor:"pointer"}}});var pt=Object(l.a)({Button:{backgroundColor:h,borderColor:"transparent",borderRadius:"1vmin",borderStyle:"solid","&:active":{borderColor:"transparent"},"&:hover":{cursor:"pointer",borderColor:"white"},display:"flex",alignItems:"center",justifyContent:"center",padding:"1vmin",margin:"1vmin",textAlign:"center"}});var ft=function(e){var t=e.onClick,n=e.children,a=e.style,r=e.onPointerDown,i=e.ref,c=e.onKeyDown,l=pt();return o.a.createElement("div",{className:l.Button,onClick:t,onPointerDown:r,style:a,ref:i,onKeyDown:c},n)};var vt=function(e){if(e.current){var t={"choose file":function(t){e.current.src=t}};return{audioNode:ge.createMediaElementSource(e.current),ref:e,connectingParamIDs:[],controlSetFuncs:t}}return null};var bt=function(e){var t=e.id,n=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(!window.audioModules[t]){var e=vt(n);e&&(window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},t,e)))}})),o.a.createElement("audio",{ref:n,autoPlay:!0})};window.addAudioTag=function(e){window.audioTags[e]={id:e,srcName:""}},window.audioTags={};var wt=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),n=t[0],r=t[1];window.reRenderAudioTags=function(){r(!n)};var i=Object.keys(window.audioTags);return o.a.createElement(a.Fragment,null,i.map((function(e){return o.a.createElement(bt,{key:e,id:e})})))},gt=Object(l.a)({Bounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around",borderRadius:"15px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",userSelect:"none",margin:"10px","&:hover":{cursor:"pointer"}},Switch:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",justifySelf:"flex-end",borderRadius:"15px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",userSelect:"none",margin:"10px"}});var Ot=function(e){var t=e.text,n=e.onSwitch,r=e.initState,i=e.style,l=Object(a.useState)(r),u=Object(c.a)(l,2),d=u[0],m=u[1],p=gt(),f=Object(H.b)({cx:d?"65":"25",fill:d?"green":"red",config:{tension:250}});return o.a.createElement("div",{className:p.Bounder,style:i},o.a.createElement("div",{onClick:function(){n(!d),m(!d)}},t),o.a.createElement("svg",{onClick:function(){n(!d),m(!d)},width:"90",height:"30"},o.a.createElement("rect",{width:"50",height:"20",x:"20",y:"5",rx:"10",ry:"10",fill:s}),o.a.createElement(H.a.circle,{cx:f.cx,cy:"15",r:"15",fill:f.fill})))},ht=Object(l.a)({KnobContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"auto",placeItems:"center",margin:"1vmin"},KnobSVG:{gridRow:"1",gridColumn:"1",width:"".concat(B.size+1,"vmin"),height:"".concat(B.size+1,"vmin"),zIndex:9},KnobText:{gridRow:"1",gridColumn:"1",fontSize:L.xxsmall,textAlign:"center",color:E,zIndex:10,width:"4em",borderStyle:"none",backgroundColor:"transparent","&::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"&::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}},InteractionLayer:{gridRow:"1",gridColumn:"1",zIndex:11,width:"".concat(B.size,"vmin"),height:"".concat(B.size,"vmin")},SettingsButton:{width:"".concat(B.size/6,"vmin"),height:"".concat(B.size/6,"vmin"),gridRow:"1",gridColumn:"1",placeSelf:"end",zIndex:12}}),It=n(40),Dt=n.n(It);var Ct=function(e){var t=e.initValue,n=e.range,r=e.onChange,i=e.onEveryChange,c=e.onSettingsClick,l=e.inputVal,u=e.setInputVal,s=ht(),d=Object(a.useRef)(null),m=(n[1]-n[0])*B.sensitivity/200,p=J(t,n),f=Object(a.useRef)(null),v=function(e){p=J(p-e.movementY*m,n),d.current&&(d.current.style.transform="rotate(".concat(Qe(p,n),"deg)")),f.current&&(f.current.value="".concat(Xe(p))),i&&i(p)},b=function(){r&&r(p),u(Xe(p))};return o.a.createElement("div",{className:s.KnobContainer},o.a.createElement("svg",{className:s.KnobSVG,width:"".concat(B.size+1,"vmin"),height:"".concat(B.size+1,"vmin"),ref:d,style:{transform:"rotate(".concat(Qe(t,n),"deg)")}},o.a.createElement("circle",{cx:"".concat((B.size+1)/2,"vmin"),cy:"".concat((B.size+1)/2,"vmin"),r:"".concat(B.size/2,"vmin"),stroke:y,strokeWidth:B.borderWidth,fill:j}),o.a.createElement("rect",{width:"".concat(B.markerWidth,"vmin"),height:"".concat(B.markerHeight,"vmin"),x:"".concat((B.size+1)/2-B.markerWidth/2,"vmin"),y:".5vmin",fill:x})),o.a.createElement("input",{className:s.KnobText,ref:f,onChange:function(e){u(e.target.value),i&&i(J(Number(e.target.value),n))},onBlur:function(e){var t=J(Number(e.target.value),n);r&&r(t),u(Xe(t))},onKeyDown:function(e){var t;13===e.keyCode&&(null===(t=f.current)||void 0===t||t.blur())},type:"number",value:l}),o.a.createElement("div",{className:s.InteractionLayer,title:"".concat(t),onClick:function(e){return e.stopPropagation()},onDragStart:function(e){return e.stopPropagation()},onPointerDown:function(e){e.stopPropagation(),e.preventDefault(),e.shiftKey?f.current&&(f.current.placeholder=f.current.value,f.current.value="",f.current.focus()):window.openPointerLayer(e.pointerId,v,b)}}),c?o.a.createElement("img",{className:s.SettingsButton,src:Dt.a,alt:"settings",onClick:c}):null)};var jt=Object(l.a)({PointerLayer:{width:"100vw",height:"100vh",position:"absolute",top:0,left:0,zIndex:300}});var Et=function(e){var t=e.pointerLayerData,n=e.resetPointerLayerData,r=jt(),i=t.pointerId,c=t.onPointerMove,l=t.onPointerUp,u=Object(a.useRef)(null);return Object(a.useEffect)((function(){})),o.a.createElement("div",{className:r.PointerLayer,ref:u,onPointerMove:function(e){e.pointerId===i&&c(e)},onPointerUp:function(e){e.pointerId===i&&(l(e),n())}})};function yt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{isOpen:e,fromID:t,toID:n}}function xt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return{isOpen:e,modID:t,controlID:n,onChangeSubmit:a}}function Nt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,saveList:t,onClose:n}}function Tt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,saveName:t,onClose:n}}var St=Object(l.a)({IORecursionBounder:{display:"flex",alignSelf:"flex-start",marginLeft:"5vmin",flexDirection:"column",alignItems:"flex-start",height:"60vmin",width:"90%",overflowY:"scroll",overflowX:"visible","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white",borderRadius:"2px"}},IORecursionInnerBounder:{display:"flex",alignSelf:"flex-start",marginLeft:"2vmin",flexDirection:"column",alignItems:"flex-start"}});var Mt=function e(t){var n=t.id,r=t.isOutput,i=t.setConnection,l=Object(ce.c)((function(e){return[e.modules[n].moduleType===K,e.modules[n].name,r?e.modules[n].connectionOutputs:e.modules[n].connectionInputs]})),u=Object(c.a)(l,3),s=u[0],d=u[1],m=u[2],p=Object(a.useState)(!1),f=Object(c.a)(p,2),v=f[0],b=f[1],w=St();return s?o.a.createElement(a.Fragment,null,o.a.createElement(ft,{style:{color:T},onClick:function(){b(!v)}},d),v?o.a.createElement("div",{className:w.IORecursionInnerBounder},m.map((function(t){return o.a.createElement(e,{key:t,id:t,isOutput:r,setConnection:i})}))):null):m.length>1?o.a.createElement(a.Fragment,null,o.a.createElement(ft,{style:{color:T},onClick:function(){b(!v)}},d),v?o.a.createElement("div",{className:w.IORecursionInnerBounder},m.map((function(e,t){return o.a.createElement(ft,{style:{color:N},onClick:function(){i(n,t)}},e)}))):null):o.a.createElement(ft,{onClick:function(){i(n,0)}},d)};function Rt(e,t,n){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=0;o<t.outputs.length;o++){var r=e[t.outputs[o]],i=r.actualInputID,c=r.param;if(i===n&&a===c)return!0}return!1}var kt={};var At=function(e){var t=e.fromID,n=e.toID,r=e.onClose,i=St(),l=window.audioModules,u=Object(ce.c)((function(e){return[e.modules,e.connections]})),s=Object(c.a)(u,2),d=s[0],m=s[1],p=d[t],f=d[n],v=Object(a.useState)(0),b=Object(c.a)(v,2),w=b[0],g=b[1],O=Object(a.useState)(0),h=Object(c.a)(O,2),I=h[0],D=h[1],C=Object(a.useState)(t),j=Object(c.a)(C,2),E=j[0],y=j[1],x=Object(a.useState)(n),N=Object(c.a)(x,2),T=N[0],S=N[1],M=Object(ce.b)(),R=p.moduleType===K,k=f.moduleType===K,A=p.connectionOutputs.length>1||R?"CHOOSE_OUTPUT":f.connectionInputs.length>1||k?"CHOOSE_INPUT":"CONNECT_TO",P=Object(a.useState)(A),F=Object(c.a)(P,2),_=F[0],L=F[1];return o.a.createElement(a.Fragment,null,"CHOOSE_OUTPUT"===_?o.a.createElement(mt,{header:"choose output",onClose:r},o.a.createElement("div",{className:i.IORecursionBounder},p.connectionOutputs.map((function(e){return o.a.createElement(Mt,{key:e+"output",id:R?e:t,isOutput:!0,setConnection:function(e,t){y(e),g(t),f.connectionInputs.length>1||f.moduleType===K?L("CHOOSE_INPUT"):L("CONNECT_TO")}})})))):"CHOOSE_INPUT"===_?o.a.createElement(mt,{header:"choose input",onClose:r},o.a.createElement("div",{className:i.IORecursionBounder},f.connectionInputs.map((function(e){return o.a.createElement(Mt,{key:e+"input",id:k?e:n,isOutput:!1,setConnection:function(e,t){S(e),D(t),L("CONNECT_TO")}})})))):"CONNECT_TO"===_?o.a.createElement(mt,{header:"connect ".concat(R?p.name+" - "+d[E].name:p.name," to ").concat(k?f.name+" - "+d[T].name:f.name),onClose:r},(k?0===d[f.connectionInputs[I]].connectionInputs.length:0===f.connectionInputs.length)?null:o.a.createElement(ft,{style:kt,onClick:function(){Rt(m,p,T)?alert("modules already connected"):(ke(l[E],l[T],"",w,I),M(pe(t,n,"",w,I,R?E:void 0,k?T:void 0))),r()}},"module"),0===l[T].connectingParamIDs.length?null:o.a.createElement(ft,{style:kt,onClick:function(e){e.stopPropagation(),L("CHOOSE_PARAM")}},"params")):"CHOOSE_PARAM"===_?o.a.createElement(mt,{header:"props",onClose:r},l[T].connectingParamIDs.map((function(e,a){return o.a.createElement(ft,{style:kt,key:t+n+a,onClick:function(){Rt(m,p,T,e)?alert("modules already connected"):(ke(l[E],l[T],e,w,I),M(pe(t,n,e,w,I,R?E:void 0,k?T:void 0))),r()}},e)}))):null)},Pt=Object(l.a)({CMInputBounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},CenterMenuInput:{backgroundColor:s,color:"white",height:"2vmin",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:L.small,width:"23vmin","&:hover":{cursor:"text"}},InputSubmit:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:s,height:"2vmin",padding:"1vmin",margin:"1.5vmin 1.5vmin 1.5vmin 0.75vmin",borderRadius:"1vmin","&:hover":{cursor:"pointer"},fontSize:L.small},Error:{backgroundColor:D,width:"90%",color:"white",fontSize:L.small,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"1vmin",padding:"1vmin 0vmin",marginBottom:"1vmin"}});var Ft=function(e){var t,n=e.toRenameID,r=e.onClose,i=Pt(),l=Object(a.useRef)(null),u=Object(ce.c)((function(e){return e.modules})),s=Object(ce.b)(),d=Object(a.useState)(!1),m=Object(c.a)(d,2),p=m[0],f=m[1];function v(){if(l&&l.current){var e=l.current.value;0===e.length?f(!0):(s(function(e,t){return{type:"RENAME_MODULE",id:e,newName:t}}(n,e)),r())}}return o.a.createElement(mt,{header:"rename",onClose:r},o.a.createElement("div",{className:i.CMInputBounder},o.a.createElement("input",{className:i.CenterMenuInput,placeholder:null===(t=u[n])||void 0===t?void 0:t.name,onKeyUp:function(e){13===e.keyCode?v():27===e.keyCode&&r()},ref:l,autoFocus:!0}),o.a.createElement("div",{className:i.InputSubmit,onClick:function(){v()}},"enter")),p?o.a.createElement("div",{className:i.Error},"please enter a name"):null)},_t=Object(l.a)({CMInputBounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},CenterMenuInput:{backgroundColor:s,color:"white",height:"2vmin",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:L.small,width:"15vmin","&:hover":{cursor:"text"}}});var Lt=function(e){var t=e.onClose,n=e.modID,r=e.controlID,i=e.onChangeSubmit,l=Object(ce.c)((function(e){return e.modules[n].controlData[r]})),u=l.maxRange,s=l.range,d=Object(a.useState)(s[0]),m=Object(c.a)(d,2),p=m[0],f=m[1],v=Object(a.useState)(s[1]),b=Object(c.a)(v,2),w=b[0],g=b[1],O=_t();return o.a.createElement(mt,{header:"set ".concat(r," range"),onClose:t},o.a.createElement("div",{style:{fontSize:L.small}},u?"max range from ".concat(u[0]," to ").concat(u[1]):null),o.a.createElement("div",{className:O.CMInputBounder,onKeyDown:function(e){27===e.keyCode?t():13===e.keyCode&&(i([p,w]),t())}},o.a.createElement("input",{className:O.CenterMenuInput,onChange:function(e){f(Number(e.target.value))},value:p,type:"number"}),o.a.createElement("input",{className:O.CenterMenuInput,onChange:function(e){g(Number(e.target.value))},value:w,type:"number"})),o.a.createElement(ft,{onClick:function(){u?$(p,u)&&$(w,u)?w>p?(i([p,w]),t()):alert("min must be less than max"):alert("a value is not within maximum range bounds"):w>p?(i([p,w]),t()):alert("min must be less than max")}},"confirm"))};var Ut=function(e){var t=e.saveList,n=e.onClose,r=Object(ce.c)((function(e){return[e.baseContainerID,e.modules]})),i=Object(c.a)(r,2),l=i[0],u=i[1],s=Object(a.useState)(u[l].name),d=Object(c.a)(s,2),m=d[0],p=d[1],f=Object(a.useState)({isOpen:!1,message:""}),v=Object(c.a)(f,2),b=v[0],w=v[1],g=Object(ce.c)((function(e){return e})),O=Object(a.useRef)(null);return o.a.createElement(mt,{header:"save project",onClose:n},o.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},o.a.createElement("input",{style:{fontSize:L.small},value:m,placeholder:u[l].name,onChange:function(e){p(e.target.value)},onKeyDown:function(e){switch(e.keyCode){case 13:Q(m,t)?w({isOpen:!0,message:"would you like to overwrite this save?"}):(window.spaceDBSaveService.create({saveName:m,state:g}),n());break;case 27:n()}},ref:O,autoFocus:!0}),o.a.createElement(ft,{onPointerDown:function(e){return e.preventDefault()},onClick:function(e){e.preventDefault(),Q(m,t)?w({isOpen:!0,message:"would you like to overwrite this save?"}):(window.spaceDBSaveService.create({saveName:m,state:g}),n())}},"save to spaceDB")),b.isOpen?o.a.createElement("div",null,o.a.createElement("div",null,"save already exists. do you want to replace it?"),o.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"}},o.a.createElement(ft,{style:{backgroundColor:P,marginRight:"3vmin"},onClick:function(){var e;null===(e=O.current)||void 0===e||e.focus(),w({isOpen:!1,message:""})}},"no"),o.a.createElement(ft,{style:{backgroundColor:A},onClick:function(){window.spaceDBSaveService.update(m,g),n()}},"yes"))):null)};var Bt=function(e){var t=e.saveName,n=e.onClose;return o.a.createElement(mt,{header:"are you sure you want to delete ".concat(t,"?"),onClose:n},o.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"}},o.a.createElement(ft,{style:{backgroundColor:P,marginRight:"3vmin"},onClick:function(){n()}},"no"),o.a.createElement(ft,{style:{backgroundColor:A},onClick:function(){window.spaceDBSaveService.remove(t),n()}},"yes")))};var zt=function(){var e=Object(a.useState)(yt(!1)),t=Object(c.a)(e,2),n=t[0],r=t[1];window.openConnectionMenu=function(e,t){r(yt(!0,e,t))};var i=Object(a.useState)({isOpen:!1,toRenameID:""}),l=Object(c.a)(i,2),u=l[0],s=l[1];window.openRenameMenu=function(e){s({isOpen:!0,toRenameID:e})};var d=Object(a.useState)(xt(!1)),m=Object(c.a)(d,2),p=m[0],f=m[1];window.openRangeSetMenu=function(e,t,n){f(xt(!0,e,t,n))};var v=Object(a.useState)(Nt(!1)),b=Object(c.a)(v,2),w=b[0],g=b[1];window.openSaveMenu=function(e,t){g({isOpen:!0,saveList:e,onClose:t})};var O=Object(a.useState)(Tt(!1)),h=Object(c.a)(O,2),I=h[0],D=h[1];return window.openConfirmDeleteMenu=function(e,t){D(Tt(!0,e,t))},o.a.createElement(a.Fragment,null,n.isOpen?o.a.createElement(At,{fromID:n.fromID,toID:n.toID,onClose:function(){r(yt(!1))}}):null,u.isOpen?o.a.createElement(Ft,{toRenameID:u.toRenameID,onClose:function(){s({isOpen:!1,toRenameID:""})}}):null,p.isOpen?o.a.createElement(Lt,{modID:p.modID,controlID:p.controlID,onClose:function(){f(xt(!1))},onChangeSubmit:function(e){p.onChangeSubmit(e)}}):null,w.isOpen?o.a.createElement(Ut,{saveList:w.saveList,onClose:function(){w.onClose(),g(Nt(!1))}}):null,I.isOpen?o.a.createElement(Bt,{saveName:I.saveName,onClose:function(){I.onClose(),D(Tt(!1))}}):null)};var Ht=function(){return function(e,t,n,a,o,r,i){switch(a){case"OSCILLATOR":var c=Te(),l={"set type":{controlType:"TYPE",paramID:"type",value:(N=c.audioNode).type},frequency:{controlType:G,paramID:"frequency",value:N.frequency.value,range:[0,2e4]},detune:{controlType:G,paramID:"detune",value:N.detune.value,range:[-50,50]}};window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,c)),o(le(e,t,a,l,n,r,i,[],["0"]));break;case"GAIN":var u=xe(),s={gain:{controlType:G,paramID:"gain",value:0,range:[-1,1]}};window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,u)),o(le(e,t,a,s,n,r,i,["0"],["0"]));break;case"OUTPUT":var d=Ce(),m={"master gain":{controlType:G,paramID:"gain",value:1,range:[0,1],maxRange:[0,20]},resume:{controlType:"BUTTON",paramID:"n/a"},suspend:{controlType:"BUTTON",paramID:"n/a"}};window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,d)),o(le(e,t,a,m,n,r,i,["0"],[]));break;case"AUTOFILTER":var p=De(),f={"set type":{controlType:"TYPE",paramID:"type",value:(x=p.audioNode).type},frequency:{controlType:G,paramID:"frequency",value:x.frequency.value,range:[0,ge.sampleRate/2],maxRange:[0,ge.sampleRate/2]},detune:{controlType:G,paramID:"detune",value:x.detune.value,range:[-50,50],maxRange:[-153600,153600]},Q:{controlType:G,paramID:"Q",value:x.Q.value,range:[-30,30]},gain:{controlType:G,paramID:"gain",value:x.gain.value,range:[-2e4,1400],maxRange:[-2e4,1400]}};window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,p)),o(le(e,t,a,f,n,r,i,["0"],["0"]));break;case"KOMPRESSOR":var v=ye(),b=(y=v.audioNode,{threshold:{controlType:G,paramID:"threshold",value:y.threshold.value,range:[-100,0],maxRange:[-100,0]},knee:{controlType:G,paramID:"knee",value:y.knee.value,range:[0,40],maxRange:[0,40]},ratio:{controlType:G,paramID:"ratio",value:y.ratio.value,range:[1,20],maxRange:[1,20]},attack:{controlType:G,paramID:"attack",value:y.attack.value,range:[0,1],maxRange:[0,1]},release:{controlType:G,paramID:"release",value:y.release.value,range:[0,1],maxRange:[0,1]}});window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,v)),o(le(e,t,a,b,n,r,i,["0"],["0"]));break;case"STEREO_PANNER":var w=je(),g={pan:{controlType:G,paramID:"pan",value:0,range:[-1,1],maxRange:[-1,1]}};window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,w)),o(le(e,t,a,g,n,r,i,["0"],["0"]));break;case"SIGNAL_DELAY":var O=Ee(),h={"delay time":{controlType:G,paramID:"delayTime",value:0,range:[0,2],maxRange:[0,60]}};window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,O)),o(le(e,t,a,h,n,r,i,["0"],["0"]));break;case"CONSTANT":var I=Oe(),D={value:{controlType:G,paramID:"offset",value:0,range:[-100,100]},kill:{controlType:"BUTTON",paramID:"n/a"}};window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,I)),o(le(e,t,a,D,n,r,i,[],["0"]));break;case"MEDIA_ELEMENT":var C={"choose file":{controlType:"FILE",paramID:"n/a"}};window.addAudioTag(e),window.reRenderAudioTags(),o(le(e,t,a,C,n,r,i,[],["0"]));break;case"LINE_IN":Se(e),o(le(e,t,a,{mute:{controlType:"SWITCH",paramID:"n/a",value:!1}},n,r,i,[],["0 (L)","1 (R)"]));break;case K:var j=Me(e),E={open:{controlType:"BUTTON",paramID:"n/a"}};window.audioModules=Object(we.a)(Object(we.a)({},window.audioModules),{},Object(be.a)({},e,j)),o(le(e,t,a,E,n,r,i,[],[]))}var y,x,N}};function Wt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return{isOpen:e,pointerId:t,onPointerMove:n,onPointerUp:a}}window.highlightedID="project",window.fillContainerID="project",window.audioModules={},window.addModule=Ht();var Kt=function(){var e=u(),t=Object(a.useState)(Wt(!1)),n=Object(c.a)(t,2),r=n[0],i=n[1];return window.openPointerLayer=function(e,t,n){i(Wt(!0,e,t,n))},o.a.createElement("div",{className:e.Bounder,onPointerDown:function(){window.currUnHighlight(),window.currUnHighlight=function(){}}},o.a.createElement("div",{className:e.ModuleViewBounder},o.a.createElement(st,null)),o.a.createElement(He,null),o.a.createElement(wt,null),r.isOpen?o.a.createElement(Et,{pointerLayerData:r,resetPointerLayerData:function(){i(Wt(!1))}}):null,o.a.createElement(zt,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Gt=n(21),qt=n(41),Vt=n(7),Yt=function(e,t){var n,a,o=t.id,r=t.name,i=t.moduleType,c=t.controlData,l=t.row,u=t.col,s=t.parentID,d=t.connectionInputs,m=t.connectionOutputs;switch(i){case K:return Object.assign({},e,(n={},Object(be.a)(n,o,{id:o,name:r,row:l,col:u,parentID:s,moduleType:i,controlData:c,connectionInputs:d,connectionOutputs:m,inputs:[],outputs:[],containerControls:[],toContainerControls:[],childModules:[],isBaseContainer:!1,isContainerInput:!1,isContainerOutput:!1}),Object(be.a)(n,s,Object(we.a)(Object(we.a)({},e[s]),{},{childModules:[].concat(Object(Vt.a)(e[s].childModules),[o])})),n));default:return Object.assign({},e,(a={},Object(be.a)(a,o,{id:o,name:r,row:l,col:u,parentID:s,moduleType:i,controlData:c,connectionInputs:d,connectionOutputs:m,toContainerControls:[],isContainerInput:!1,isContainerOutput:!1,inputs:[],outputs:[]}),Object(be.a)(a,s,Object(we.a)(Object(we.a)({},e[s]),{},{childModules:[].concat(Object(Vt.a)(e[s].childModules),[o])})),a))}},Qt=function(e,t){var n=t.id,a=t.newRow,o=t.newCol;return Object.assign({},e,Object(be.a)({},n,Object(we.a)(Object(we.a)({},e[n]),{},{row:a,col:o})))},Xt=function(e,t){var n=t.id,a=t.newName;return Object.assign({},e,Object(be.a)({},n,Object(we.a)(Object(we.a)({},e[n]),{},{name:a})))},Jt=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(be.a)(n,a,Object(we.a)(Object(we.a)({},e[a]),{},{isContainerInput:!0})),Object(be.a)(n,o,Object(we.a)(Object(we.a)({},e[o]),{},{connectionInputs:[].concat(Object(Vt.a)(e[o].connectionInputs),[a])})),n))},$t=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(be.a)(n,a,Object(we.a)(Object(we.a)({},e[a]),{},{isContainerInput:!1})),Object(be.a)(n,o,Object(we.a)(Object(we.a)({},e[o]),{},{connectionInputs:e[o].connectionInputs.filter((function(e){return e!==a}))})),n))},Zt=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(be.a)(n,a,Object(we.a)(Object(we.a)({},e[a]),{},{isContainerOutput:!0})),Object(be.a)(n,o,Object(we.a)(Object(we.a)({},e[o]),{},{connectionOutputs:[].concat(Object(Vt.a)(e[o].connectionOutputs),[a])})),n))},en=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(be.a)(n,a,Object(we.a)(Object(we.a)({},e[a]),{},{isContainerInput:!1})),Object(be.a)(n,o,Object(we.a)(Object(we.a)({},e[o]),{},{connectionOutputs:e[o].connectionOutputs.filter((function(e){return e!==a}))})),n))},tn=function(e,t){var n,a=t.modID,o=t.controlID,r=t.actualModID,i=e[a].parentID;return Object.assign({},e,(n={},Object(be.a)(n,a,Object(we.a)(Object(we.a)({},e[a]),{},{toContainerControls:[].concat(Object(Vt.a)(e[a].toContainerControls),[r+o])})),Object(be.a)(n,i,Object(we.a)(Object(we.a)({},e[i]),{},{containerControls:[].concat(Object(Vt.a)(e[i].containerControls),[{modID:a,controlID:o,actualModID:r}])})),n))},nn=function(e,t){var n,a=t.modID,o=t.controlID,r=t.actualModID,i=e[a].parentID;return Object.assign({},e,(n={},Object(be.a)(n,a,Object(we.a)(Object(we.a)({},e[a]),{},{toContainerControls:e[a].toContainerControls.filter((function(e){return e!==r+o}))})),Object(be.a)(n,i,Object(we.a)(Object(we.a)({},e[i]),{},{containerControls:e[i].containerControls.filter((function(e){return e.modID!==a||e.controlID!==o||e.actualModID!==r}))})),n))},an=function(e,t){var n=t.modID,a=t.controlID,o=t.newValue;return Object.assign({},e,Object(be.a)({},n,Object(we.a)(Object(we.a)({},e[n]),{},{controlData:Object(we.a)(Object(we.a)({},e[n].controlData),{},Object(be.a)({},a,Object(we.a)(Object(we.a)({},e[n].controlData[a]),{},{value:o})))})))},on=function(e,t){var n=t.modID,a=t.controlID,o=t.newRange;return Object.assign({},e,Object(be.a)({},n,Object(we.a)(Object(we.a)({},e[n]),{},{controlData:Object(we.a)(Object(we.a)({},e[n].controlData),{},Object(be.a)({},a,Object(we.a)(Object(we.a)({},e[n].controlData[a]),{},{range:o,value:J(e[n].controlData[a].value,o)})))})))},rn={project:{id:"project",name:"project",row:0,col:0,moduleType:K,controlData:{open:{controlType:"BUTTON",paramID:"n/a"}},connectionInputs:[],connectionOutputs:[],toContainerControls:[],inputs:[],outputs:[],parentID:null,childModules:[],isBaseContainer:!0,isContainerInput:!1,isContainerOutput:!1,containerControls:[]}},cn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rn,t=arguments.length>1?arguments[1]:void 0;if(!t)return e;switch(t.type){case"ADD_MODULE":return Yt(e,t);case"MOVE_MODULE":return Qt(e,t);case"RENAME_MODULE":return Xt(e,t);case"MARK_CONTAINER_INPUT":return Jt(e,t);case"UNMARK_CONTAINER_INPUT":return $t(e,t);case"MARK_CONTAINER_OUTPUT":return Zt(e,t);case"UNMARK_CONTAINER_OUTPUT":return en(e,t);case"MARK_CONTAINER_CONTROL":return tn(e,t);case"UNMARK_CONTAINER_CONTROL":return nn(e,t);case"UPDATE_CONTROL_DATA":return an(e,t);case"UPDATE_CONTROL_RANGE":return on(e,t);default:return e}},ln=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"project",t=arguments.length>1?arguments[1]:void 0;if(!t)return e;switch(t.type){case"DOWN_1_BASE":case"CHANGE_BASE":return t.newID;default:return e}},un=0,sn=function(e,t,n){var a,o=n.fromID,r=n.toID,i=n.param,c=n.outputIndex,l=n.inputIndex,u=n.containerOutputChildID,s=n.containerInputChildID,d="".concat(o," ").concat(r," ").concat(un);return un++,{newModules:Object.assign({},e,(a={},Object(be.a)(a,o,Object(we.a)(Object(we.a)({},e[o]),{},{outputs:[].concat(Object(Vt.a)(e[o].outputs),[d])})),Object(be.a)(a,r,Object(we.a)(Object(we.a)({},e[r]),{},{inputs:[].concat(Object(Vt.a)(e[r].inputs),[d])})),a),u?Object(be.a)({},u,Object(we.a)(Object(we.a)({},e[u]),{},{outputs:[].concat(Object(Vt.a)(e[u].outputs),[d])})):{},s?Object(be.a)({},s,Object(we.a)(Object(we.a)({},e[s]),{},{inputs:[].concat(Object(Vt.a)(e[s].inputs),[d])})):{}),newConnections:Object(we.a)(Object(we.a)({},t),{},Object(be.a)({},d,{connectionID:d,fromID:o,toID:r,param:i,outputIndex:c,inputIndex:l,actualOutputID:u,actualInputID:s}))}};function dn(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){for(var n=0;n<t.length;n++)if(e[0]===t[n])return!1;return!0})))}var mn=function(e,t,n){var a,o=n.connectionID,r=t[o],i=r.fromID,c=r.toID,l=r.actualOutputID,u=r.actualInputID;return{newModules:Object.assign({},e,(a={},Object(be.a)(a,i,Object(we.a)(Object(we.a)({},e[i]),{},{outputs:e[i].outputs.filter((function(e){return e!==o}))})),Object(be.a)(a,c,Object(we.a)(Object(we.a)({},e[c]),{},{inputs:e[c].inputs.filter((function(e){return e!==o}))})),a),l?Object(be.a)({},l,Object(we.a)(Object(we.a)({},e[l]),{},{outputs:e[l].outputs.filter((function(e){return e!==o}))})):{},u?Object(be.a)({},u,Object(we.a)(Object(we.a)({},e[u]),{},{inputs:e[i].outputs.filter((function(e){return e!==o}))})):{}),newConnections:dn(t,[o])}},pn=function(e,t,n){var a=n.id,o=e[a].parentID,r=dn(e,[a]);return{newModules:Object.assign({},Object.fromEntries(Object.entries(r).map((function(t){return[t[0],Object(we.a)(Object(we.a)({},t[1]),{},{inputs:t[1].inputs.filter((function(t){return!Q(t,[].concat(Object(Vt.a)(e[a].inputs),Object(Vt.a)(e[a].outputs)))})),outputs:t[1].outputs.filter((function(t){return!Q(t,[].concat(Object(Vt.a)(e[a].inputs),Object(Vt.a)(e[a].outputs)))}))})]}))),Object(be.a)({},o,Object(we.a)(Object(we.a)({},e[o]),{},{childModules:e[o].childModules.filter((function(e){return e!==a})),connectionInputs:e[o].connectionInputs.filter((function(e){return e!==a})),connectionOutputs:e[o].connectionOutputs.filter((function(e){return e!==a})),containerControls:e[o].containerControls.filter((function(e){return e.modID!==a}))}))),newConnections:dn(t,[].concat(Object(Vt.a)(e[a].inputs),Object(Vt.a)(e[a].outputs)))}},fn=function(e,t,n){if(!n)return{newModules:e,newConnections:t};switch(n.type){case"ADD_CONNECTION":return sn(e,t,n);case"REMOVE_CONNECTION":return mn(e,t,n);case"REMOVE_MODULE":return pn(e,t,n);default:return{newModules:e,newConnections:t}}},vn={modules:cn(),connections:{},baseContainerID:ln()};function bn(e,t){return"ADD_CONNECTION"===t.type||"REMOVE_CONNECTION"===t.type||"REMOVE_MODULE"===t.type?fn(e.modules,e.connections,t):{newModules:cn(e.modules,t),newConnections:e.connections}}var wn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn,t=arguments.length>1?arguments[1]:void 0;if("RESTORE_FROM_STATE"===t.type){var n=t.state;return Object.assign(n,n.connections?{}:{connections:{}})}var a=bn(e,t),o=a.newModules,r=a.newConnections;return{modules:o,connections:r,baseContainerID:ln(e.baseContainerID,t)}},gn=Object(Gt.createStore)(wn,Object(qt.composeWithDevTools)());i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(ce.a,{store:gn},o.a.createElement(Kt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[42,1,2]]]);
//# sourceMappingURL=main.2ebe6349.chunk.js.map