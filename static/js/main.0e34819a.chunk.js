(this["webpackJsonpspace-machine"]=this["webpackJsonpspace-machine"]||[]).push([[0],{43:function(e,n,t){e.exports=t.p+"static/media/trash.9d2c8d42.svg"},44:function(e,n,t){e.exports=t.p+"static/media/settings.04e848f8.svg"},47:function(e,n,t){e.exports=t(93)},52:function(e,n,t){},93:function(e,n,t){"use strict";t.r(n);var a=t(0),o=t.n(a),r=t(25),c=t.n(r),i=(t(52),t(3)),l=t(6),u=-1,s=100,d=50,m=0,f=Object(l.a)({Bounder:{backgroundImage:"url(https://i.imgur.com/mSjoh6M.jpg)",backgroundPosition:"center",width:"100vw",height:"100vh",display:"flex",fontSize:"calc(20px + 2vmin)",color:"white",position:"absolute",top:"0px",left:"0px",userSelect:"none",zIndex:u,overflow:"hidden"},ModuleViewBounder:{minWidth:"60vw",height:"100vh",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",zIndex:m,overflow:"scroll","&::-webkit-scrollbar":{width:"0px"}}}),p=t(2),v=t(1),b="CONTAINER",w="VALUE",g=function(e,n,t,a,o,r,c,i,l){return{type:"ADD_MODULE",moduleType:t,id:e,name:n,controlData:a,row:r,col:c,parentID:o,connectionInputs:i,connectionOutputs:l}},O=function(e,n,t){return{type:"MOVE_MODULE",id:e,newRow:n,newCol:t}},h=function(e,n,t,a){return{type:"MARK_CONTAINER_CONTROL",modID:e,controlID:n,actualModID:t,name:a}},I=function(e,n,t){return{type:"UNMARK_CONTAINER_CONTROL",modID:e,controlID:n,actualModID:t}},j=function(e,n,t){return{type:"UPDATE_CONTROL_DATA",modID:e,controlID:n,newValue:t}},D=function(e,n,t){return{type:"UPDATE_CONTROL_RANGE",modID:e,controlID:n,newRange:t}},C=function(e,n,t,a,o,r,c){return{type:"ADD_CONNECTION",fromID:e,toID:n,param:t,outputIndex:a,inputIndex:o,containerOutputChildID:r,containerInputChildID:c}},E=function(e){return{type:"REMOVE_CONNECTION",connectionID:e}},y=function(e,n,t,a,o,r){return{type:"MERGE_CONTAINER",containerID:e,newModules:n,newConnections:t,parentID:a,row:o,col:r}};function N(e){return{type:"RESTORE_FROM_STATE",state:e}}var x=new(window.AudioContext||window.webkitAudioContext);var S=function(e){var n=x.createConstantSource();n.offset.value=e?e.value.value:0;var t={value:function(e){n.offset.value=Number(e)},kill:function(){n.stop()}};return n.start(),{audioNode:n,connectingParamIDs:["offset"],controlSetFuncs:t}},M=["lowpass","lowshelf","highpass","highshelf","allpass","bandpass","notch","peaking"],T=["frequency","detune","Q","gain"];var k=function(e){var n=x.createBiquadFilter();e&&(n.type=e["set type"].value,n.frequency.value=e.frequency.value,n.detune.value=e.detune.value,n.Q.value=e.Q.value,n.gain.value=e.gain.value);var t={"set type":function(e){n.type=e},frequency:function(e){n.frequency.value=Number(e)},detune:function(e){n.detune.value=Number(e)},Q:function(e){n.Q.value=Number(e)},gain:function(e){n.gain.value=Number(e)}};return{audioNode:n,typeTypes:M,connectingParamIDs:T,controlSetFuncs:t}};var R=function(e){x.resume();var n=x.createGain();n.connect(x.destination),n.gain.value=e?e["master gain"].value:1;var t={"master gain":function(e){n.gain.value=Number(e)},resume:function(e){x.resume()},suspend:function(e){x.suspend()}};return{audioNode:n,connectingParamIDs:[],controlSetFuncs:t}};var A=function(e){var n=x.createStereoPanner();e&&(n.pan.value=e.pan.value);var t={pan:function(e){n.pan.value=Number(e)}};return{audioNode:n,connectingParamIDs:["pan"],controlSetFuncs:t}};var P=function(e){var n=x.createDelay(60);e&&(n.delayTime.value=e["delay time"].value);var t={"delay time":function(e){n.delayTime.value=Number(e)}};return{audioNode:n,connectingParamIDs:["delayTime"],controlSetFuncs:t}};var B=function(e){var n=x.createDynamicsCompressor();e&&(n.threshold.value=e.threshold.value,n.knee.value=e.knee.value,n.ratio.value=e.ratio.value,n.attack.value=e.attack.value,n.release.value=e.release.value);var t={threshold:function(e){n.threshold.value=Number(e)},knee:function(e){n.knee.value=Number(e)},ratio:function(e){n.ratio.value=Number(e)},attack:function(e){n.attack.value=Number(e)},release:function(e){n.release.value=Number(e)}};return{audioNode:n,connectingParamIDs:["threshold","knee","ratio","attack","release"],controlSetFuncs:t}};var F=function(e){var n=x.createGain();n.gain.value=e?e.gain.value:0;var t={gain:function(e){n.gain.value=Number(e)}};return{audioNode:n,connectingParamIDs:["gain"],controlSetFuncs:t}};var L=["sine","square","triangle","sawtooth"];var z=function(e){var n=x.createOscillator();e&&(n.type=e["set type"].value,n.frequency.value=e.frequency.value,n.detune.value=e.detune.value);var t={"set type":function(e){n.type=e},frequency:function(e){n.frequency.value=Number(e)},detune:function(e){n.detune.value=Number(e)},kill:function(){n.stop()}};return n.start(),{audioNode:n,typeTypes:L,connectingParamIDs:["frequency","detune"],controlSetFuncs:t}};var _=function(e){navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1,latency:0}}).then((function(n){var t=x.createMediaStreamSource(n),a=x.createChannelSplitter(2);t.connect(a);var o={audioNode:a,connectingParamIDs:[],controlSetFuncs:{mute:function(e){n.getAudioTracks()[0].enabled="true"===e}}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,o))}))};var W=function(e){return{connectingParamIDs:[],controlSetFuncs:{}}};var U=function(e){if(e.current){var n={"choose file":function(n){e.current.src=n},pause:function(){e.current.pause()},play:function(){e.current.play()}};return{audioNode:x.createMediaElementSource(e.current),ref:e,connectingParamIDs:[],controlSetFuncs:n}}return null};function H(e){for(var n,t="number"===typeof e?e:50,a=new Float32Array(44100),o=Math.PI/180,r=0;r<44100;++r)n=2*r/44100-1,a[r]=(3+t)*n*20*o/(Math.PI+t*Math.abs(n));return a}var G=function(e){var n=x.createWaveShaper();n.curve=H(e?e.amount.value:0);var t={amount:function(e){n.curve=H(Number(e))},oversample:function(e){var t=Math.floor(Number(e));n.oversample=t<2?"none":t<4?"2x":"4x"}};return{audioNode:n,connectingParamIDs:[],controlSetFuncs:t}};var K=function(e){var n=x.createAnalyser();n.fftSize=1024;var t=n.frequencyBinCount;return{audioNode:n,controlSetFuncs:{"time graph":function(){}},connectingParamIDs:[],timeArray:new Float32Array(t),bufferLength:t}};var V=function(e){var n=x.createConstantSource();n.offset.value=0;var t=.1,a=.2,o=1,r=.1;e&&(t=e.attack.value,a=e.decay.value,o=e.sustain.value,r=e.release.value);var c={trigger:function(e){var c=x.currentTime;"on"===e?(n.offset.linearRampToValueAtTime(1,c+t),n.offset.setTargetAtTime(o,c+t,a)):(n.offset.cancelAndHoldAtTime(c),n.offset.setTargetAtTime(0,c,r))},attack:function(e){t=Number(e)},decay:function(e){a=Number(e)},sustain:function(e){o=Number(e)},release:function(e){r=Number(e)}};return n.start(),{audioNode:n,connectingParamIDs:[],controlSetFuncs:c}};var q=10*x.sampleRate;var Y=function(e){for(var n=x.createBuffer(1,q,x.sampleRate),t=n.getChannelData(0),a=0;a<q;a++)t[a]=2*Math.random()-1;var o=x.createBufferSource();return o.buffer=n,o.loop=!0,o.start(),{audioNode:o,connectingParamIDs:[],controlSetFuncs:{}}};var Q=function(){window.addModule=function(e,n,t,a,o,r,c){switch(a){case"OSCILLATOR":var i=z(),l={"set type":{controlType:"TYPE",paramID:"type",value:(te=i.audioNode).type},frequency:{controlType:w,paramID:"frequency",value:te.frequency.value,range:[0,440]},detune:{controlType:w,paramID:"detune",value:te.detune.value,range:[-50,50]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,i)),o(g(e,n,a,l,t,r,c,[],["0"]));break;case"GAIN":var u=F(),s={gain:{controlType:w,paramID:"gain",value:0,range:[0,1]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,u)),o(g(e,n,a,s,t,r,c,["0"],["0"]));break;case"OUTPUT":var d=R(),m={"master gain":{controlType:w,paramID:"gain",value:1,range:[0,1],maxRange:[0,20]},resume:{controlType:"BUTTON",paramID:"n/a"},suspend:{controlType:"BUTTON",paramID:"n/a"}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,d)),o(g(e,n,a,m,t,r,c,["0"],[]));break;case"AUTOFILTER":var f=k(),O={"set type":{controlType:"TYPE",paramID:"type",value:(ne=f.audioNode).type},frequency:{controlType:w,paramID:"frequency",value:ne.frequency.value,range:[0,x.sampleRate/2],maxRange:[0,x.sampleRate/2]},detune:{controlType:w,paramID:"detune",value:ne.detune.value,range:[-50,50],maxRange:[-153600,153600]},Q:{controlType:w,paramID:"Q",value:ne.Q.value,range:[1e-4,1e3],maxRange:[1e-4,1e3]},gain:{controlType:w,paramID:"gain",value:ne.gain.value,range:[-40,40],maxRange:[-40,40]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,f)),o(g(e,n,a,O,t,r,c,["0"],["0"]));break;case"KOMPRESSOR":var h=B(),I=(ee=h.audioNode,{threshold:{controlType:w,paramID:"threshold",value:ee.threshold.value,range:[-100,0],maxRange:[-100,0]},knee:{controlType:w,paramID:"knee",value:ee.knee.value,range:[0,40],maxRange:[0,40]},ratio:{controlType:w,paramID:"ratio",value:ee.ratio.value,range:[1,20],maxRange:[1,20]},attack:{controlType:w,paramID:"attack",value:ee.attack.value,range:[0,1],maxRange:[0,1]},release:{controlType:w,paramID:"release",value:ee.release.value,range:[0,1],maxRange:[0,1]}});window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,h)),o(g(e,n,a,I,t,r,c,["0"],["0"]));break;case"STEREO_PANNER":var j=A(),D={pan:{controlType:w,paramID:"pan",value:0,range:[-1,1],maxRange:[-1,1]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,j)),o(g(e,n,a,D,t,r,c,["0"],["0"]));break;case"SIGNAL_DELAY":var C=P(),E={"delay time":{controlType:w,paramID:"delayTime",value:0,range:[0,2],maxRange:[0,60]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,C)),o(g(e,n,a,E,t,r,c,["0"],["0"]));break;case"CONSTANT":var y=S(),N={value:{controlType:w,paramID:"offset",value:0,range:[-100,100]},kill:{controlType:"BUTTON",paramID:"n/a"}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,y)),o(g(e,n,a,N,t,r,c,[],["0"]));break;case"MEDIA_ELEMENT":var M={"choose file":{controlType:"FILE"},play:{controlType:"BUTTON"},pause:{controlType:"BUTTON"}};window.addAudioTag(e),window.reRenderAudioTags(),o(g(e,n,a,M,t,r,c,[],["0"]));break;case"LINE_IN":_(e),o(g(e,n,a,{mute:{controlType:"SWITCH",paramID:"n/a",value:!1}},t,r,c,[],["0 (L)","1 (R)"]));break;case b:var T=W(e),L={};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,T)),o(g(e,n,a,L,t,r,c,[],[]));break;case"DISTORTION":var U=G(),H={amount:{controlType:w,value:0,range:[0,1e3]},oversample:{controlType:w,value:0,range:[0,4],maxRange:[0,4]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,U)),o(g(e,n,a,H,t,r,c,["0"],["0"]));break;case"ANALYZER":var q=K(),Q={"time graph":{controlType:"GRAPH",range:[-1.5,1.5]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,q)),o(g(e,n,a,Q,t,r,c,["0"],["0"]));break;case"ENVELOPED_TRIGGER":var J=V(),X={trigger:{controlType:"PAD"},attack:{controlType:w,value:.1,range:[.001,1],maxRange:[.001,100]},decay:{controlType:w,value:.2,range:[.001,1],maxRange:[.001,100]},sustain:{controlType:w,value:1,range:[0,1],maxRange:[0,100]},release:{controlType:w,value:.1,range:[.001,1],maxRange:[.001,100]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,J)),o(g(e,n,a,X,t,r,c,[],["0"]));break;case"WHITE_NOISE":var Z=Y(),$={};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,Z)),o(g(e,n,a,$,t,r,c,[],["0"]))}var ee,ne,te}};function J(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return{isOpen:e,pointerId:n,onPointerMove:t,onPointerUp:a}}var X=Object(l.a)({PointerLayer:{width:"100vw",height:"100vh",position:"absolute",top:0,left:0,zIndex:300}});var Z=function(e){var n=e.pointerLayerData,t=e.resetPointerLayerData,r=X(),c=n.pointerId,i=n.onPointerMove,l=n.onPointerUp,u=Object(a.useRef)(null);return Object(a.useEffect)((function(){})),o.a.createElement("div",{className:r.PointerLayer,ref:u,onPointerMove:function(e){e.pointerId===c&&i(e)},onPointerUp:function(e){e.pointerId===c&&(l(e),t())}})},$=t(41),ee=t.n($),ne=t(42),te=t.n(ne);var ae=function(){var e=ee()(),n=te()("http://192.168.1.64:30300");e.configure(n.fetch(window.fetch)),window.projectSaveService=e.service("project-save-service"),window.containerSaveService=e.service("container-save-service")};var oe=function(){navigator.userAgent.toLowerCase().indexOf(" electron/")>-1?window.usingElectron=!0:window.usingElectron=!1},re=t(4);function ce(e,n){return n.current?{top:window.innerHeight-e.pageY>=n.current.offsetHeight?e.pageY:window.innerHeight-n.current.offsetHeight,left:window.innerWidth-e.pageX>=n.current.offsetWidth?e.pageX:window.innerWidth-n.current.offsetWidth}:{top:-1e3,left:-1e3}}var ie="#282c34",le="#0000009e",ue="#00347d",se="#001b40",de="#000000c4",me="#000000b3",fe="#282c34",pe="#c0c0c038",ve="#37538a",be="white",we="#007ab3",ge="#ffffff61",Oe="#ffffff60",he="black",Ie="#cc00006e",je="#cc0000",De="red",Ce="#0000009e",Ee="white",ye="#cc00006e",Ne="white",xe="#da1212",Se="blue",Me="#028174",Te="#7D1551",ke="#4C4141",Re="#CA5F3C",Ae="#00347D",Pe="#00802da6",Be="#cc00006e",Fe="black",Le="#08101deb",ze="#282c349c",_e="transparent",We="#1d1d2b",Ue="white",He="#00802d",Ge={width:"400",toggleWidth:"2vmin",item:"9vmin"},Ke={iconGrid:"12vmin",gutterGrid:"6vmin",icon:"10vmin",bigIconWidth:"25vmin",bigIconHeight:"35vmin"},Ve={large:"calc(25px + 2.8vmin)",medium:"calc(20px + 2.4vmin)",small:"calc(12px + 1.2vmin)",xsmall:"calc(8px + 1vmin)",xxsmall:"calc(7px + .8vmin)"},qe={size:"2.5vmin",borderRadius:"2.5vmin",smallSize:"1.5vmin",smallBorderRadius:"1.5vmin"},Ye={size:7,markerWidth:.5,markerHeight:1.3,rotRange:[-150,150],sensitivity:1,borderWidth:8},Qe={diameter:3},Je={leftBarWidth:"20vmin",iconRouterWidth:"60vmin",height:"60vmin"},Xe=Object(l.a)({Bounder:{width:"100vw",height:"100vh",backgroundColor:"transparent",position:"absolute",overflow:"hidden",top:0,left:0,zIndex:d},ContextMenu:{maxHeight:"12em",backgroundColor:Le,padding:".2em",borderRadius:".2em",display:"flex",flexDirection:"column",position:"absolute",overflowY:"scroll","&::-webkit-scrollbar":{width:"0em"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},MenuItem:{maxWidth:"8em",borderStyle:"solid",borderColor:"transparent","&:hover":{borderColor:Fe}}});var Ze=function(e){var n=e.event,t=e.children,r=e.onClose,c=e.bounderStyle,l=e.style,u=Xe(),s=Object(a.useRef)(null),d=Object(a.useState)(ce(n,s)),m=Object(i.a)(d,2),f=m[0],p=m[1];return Object(a.useEffect)((function(){p(ce(n,s))}),[n]),o.a.createElement("div",{className:u.Bounder,onPointerDown:r,style:c},o.a.createElement("div",{className:u.ContextMenu,style:Object.assign({top:f.top,left:f.left},l),ref:s,onPointerDown:function(e){e.stopPropagation()}},t))};function $e(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;0===t.length?e.audioNode.connect(n.audioNode,a,o):n.audioNode[t]?e.audioNode.connect(n.audioNode[t],a):alert("param does not exist")}function en(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0;0===t.length?"number"===typeof a?e.audioNode.disconnect(n.audioNode,a):e.audioNode.disconnect(n.audioNode):n.audioNode[t]?"number"===typeof a?e.audioNode.disconnect(n.audioNode[t],a):e.audioNode.disconnect(n.audioNode[t]):alert("param does not exist")}var nn=Object(l.a)({Button:{backgroundColor:he,borderColor:"transparent",borderRadius:"1vmin",borderStyle:"solid","&:active":{borderColor:"transparent"},"&:hover":{cursor:function(e){return e.notClickable?"":"pointer"},borderColor:function(e){return e.notClickable?"transparent":"white"}},display:"flex",alignItems:"center",justifyContent:"center",padding:".4em",margin:".3em",textAlign:"center",fontSize:function(e){return e.fontSize},boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"}});var tn=function(e){var n=e.className,t=e.onClick,a=e.children,r=e.style,c=e.onPointerDown,i=e.ref,l=e.onKeyDown,u=e.onContextMenu,s=e.fontSize,d=e.notClickable,m=nn({fontSize:s,notClickable:d});return o.a.createElement("div",{className:n?"".concat(m.Button," ").concat(n):m.Button,onClick:t,onPointerDown:c,style:r,ref:i,onKeyDown:l,onContextMenu:u},a)},an=t(43),on=t.n(an);var rn=function(e){var n=e.className,t=e.style,a=e.alt;return o.a.createElement("img",{className:n,style:t,src:on.a,alt:a})},cn=Object(l.a)({DeleteButtonBounder:{backgroundColor:Ie,fontSize:Ve.small,padding:".2em .4em","&:hover":{borderColor:Ie}},DeleteButtonSVG:{width:"1.5em",height:"1.5em"}});var ln=function(e){var n=e.onClick,t=cn();return o.a.createElement(tn,{className:t.DeleteButtonBounder,onPointerDown:function(e){e.stopPropagation()},onClick:n},o.a.createElement(rn,{className:t.DeleteButtonSVG,alt:"delete"}))};var un=function(e){var n=e.modID,t=e.onClose,a=window.audioModules,r=Object(re.b)(),c=Object(re.c)((function(e){return e.connections})),i=Object(re.c)((function(e){return e.modules[n]}));return o.a.createElement(ln,{onClick:function(){i.inputs.forEach((function(e){var n=c[e],t=n.fromID,o=n.toID,r=n.param,i=n.outputIndex,l=n.actualOutputID,u=n.actualInputID;en(a[l||t],a[u||o],r,i)})),i.outputs.forEach((function(e){var n=c[e],t=n.fromID,o=n.toID,r=n.param,i=n.outputIndex,l=n.actualOutputID,u=n.actualInputID;en(a[l||t],a[u||o],r,i)})),r({type:"REMOVE_MODULE",id:i.id}),t()}})},sn=Object(l.a)({Connection:{fontSize:Ve.xsmall,backgroundColor:pe,margin:".5vmin 3vmin",borderRadius:"1vmin",borderColor:"transparent",borderStyle:"solid",minWidth:"30%",padding:"1vmin",display:"flex",justifyContent:"center",alignItems:"center","&:hover":{cursor:"pointer",borderColor:Ie},boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},Name:{fontSize:Ve.medium,margin:"1vmin","&:hover":{cursor:"pointer"}},MenuHeader:{fontSize:Ve.small,borderStyle:"none none solid none",margin:"1vmin",whiteSpace:"noWrap"},OpenButton:{fontSize:Ve.small},SaveButton:{fontSize:Ve.small}});var dn=function(e){var n=e.modID,t=e.modules,r=sn(),c=Object(re.b)(),i=window.audioModules,l=Object(re.c)((function(e){return e.connections})),u=Object(re.c)((function(e){return e.modules[n]}));return o.a.createElement(a.Fragment,null,0===u.inputs.length?null:o.a.createElement("div",{className:r.MenuHeader},"inputs"),u.inputs.map((function(e,n){var a=l[e],s=a.fromID,d=a.param,m=a.outputIndex,f=a.actualOutputID,p=a.actualInputID,v=t[s].name;return o.a.createElement("div",{className:r.Connection,key:s+d+"inp"+n,onClick:function(n){n.stopPropagation(),c(E(e)),en(i[f||s],i[p||u.id],d,m)},onPointerDown:function(e){e.stopPropagation()}},"".concat(v).concat(f?" - ".concat(t[f].name):"").concat(0!==d.length?" - ".concat(d):""))})),0===u.outputs.length?null:o.a.createElement("div",{className:r.MenuHeader},"outputs"),u.outputs.map((function(e,n){var a=l[e],s=a.toID,d=a.param,m=a.outputIndex,f=a.actualOutputID,p=a.actualInputID,v=t[s].name;return o.a.createElement("div",{className:r.Connection,key:s+d+"out"+n,onClick:function(n){n.stopPropagation(),c(E(e)),en(i[f||u.id],i[p||s],d,m)},onPointerDown:function(e){e.stopPropagation()}},"".concat(v).concat(p?" - ".concat(t[p].name):"").concat(0!==d.length?" - ".concat(d):""))})))};var mn=function(e){var n=e.modules,t=e.modID,r=e.onClose,c=sn();return o.a.createElement(a.Fragment,null,n[t].moduleType!==b?null:o.a.createElement(tn,{className:c.OpenButton,onClick:function(){window.fillContainerID=t,window.reRenderFillContainer(),r()},onPointerDown:function(e){e.stopPropagation()}},"open"))};var fn=function(e){var n=e.modules,t=e.modID,r=e.onClose,c=sn();return o.a.createElement(a.Fragment,null,window.usingElectron&&n[t].moduleType===b?o.a.createElement(tn,{className:c.SaveButton,onClick:function(){window.containerSaveService.find().then((function(e){window.openSpaceDBContainerSaveMenu(e,t,r)})),r()}},"save to spaceDB"):null)},pn=Object(l.a)({FlexRow:{display:"flex",flexDirection:"row",justifyContent:function(e){return e.justifyContent},alignItems:function(e){return e.alignItems},flexWrap:function(e){return e.flexWrap}},FlexCol:{display:"flex",flexDirection:"column",justifyContent:function(e){return e.justifyContent},alignItems:function(e){return e.alignItems}}});var vn=function(e){var n=e.className,t=e.children,a=e.style,r=e.ref,c=e.justifyContent,i=e.alignItems,l=e.flexWrap,u=pn({justifyContent:c,alignItems:i,flexWrap:l});return o.a.createElement("div",{className:n?"".concat(u.FlexRow," ").concat(n):u.FlexRow,style:a,ref:r},t)},bn=Object(l.a)({Bounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderRadius:"15px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",userSelect:"none",margin:"10px","&:hover":{cursor:"pointer"},padding:"1vmin"},SwitchSVG:{marginLeft:"1.5vmin",flexShrink:0},Text:{fontSize:function(e){return e.fontSize}}}),wn=t(11),gn=2*Qe.diameter,On=Qe.diameter+1,hn=1.5*Qe.diameter,In=Qe.diameter-1,jn=Qe.diameter/4,Dn=(Qe.diameter+1)/2;var Cn=function(e){var n=e.text,t=e.onSwitch,r=e.initState,c=e.style,l=e.fontSize,u=Object(a.useState)(r),s=Object(i.a)(u,2),d=s[0],m=s[1],f=bn({fontSize:l}),p=Object(wn.b)({cx:"".concat(d?gn-Qe.diameter/2:Qe.diameter/2,"vmin"),fill:d?"green":"red",config:{tension:250}});return o.a.createElement("div",{className:f.Bounder,style:c},o.a.createElement("div",{className:f.Text,onClick:function(){t(!d),m(!d)}},n),o.a.createElement("svg",{className:f.SwitchSVG,width:"".concat(gn,"vmin"),height:"".concat(On,"vmin"),onClick:function(){t(!d),m(!d)}},o.a.createElement("rect",{width:"".concat(hn,"vmin"),height:"".concat(In,"vmin"),x:"".concat(jn,"vmin"),y:"".concat(1,"vmin"),rx:"10",ry:"10",fill:ie}),o.a.createElement(wn.a.circle,{cx:p.cx,cy:"".concat(Dn,"vmin"),r:"".concat(Qe.diameter/2,"vmin"),fill:p.fill})))};var En=function(e){var n=e.className,t=e.children,a=e.style,r=e.ref,c=e.onDrop,i=e.onDragOver,l=e.justifyContent,u=e.alignItems,s=pn({justifyContent:l,alignItems:u});return o.a.createElement("div",{className:n?"".concat(s.FlexCol," ").concat(n):s.FlexCol,style:a,ref:r,onDrop:c,onDragOver:i},t)};var yn=function(e){var n=e.selectedModule,t=Object(re.b)(),r=Object(re.c)((function(e){return e.modules})),c=sn(),i=n.moduleType===b?0!==n.containerControls.length:0!==Object.keys(n.controlData).length;return o.a.createElement(a.Fragment,null,i?o.a.createElement(En,null,o.a.createElement("div",{className:c.MenuHeader}," mark as container control "),o.a.createElement(vn,{justifyContent:"center",style:{flexWrap:"wrap",maxWidth:"40vmin"}},n.moduleType===b?n.containerControls.map((function(e,a){var c,i=e.modID,l=e.controlID,u=e.actualModID,s=e.name,d=e.markedToContainer,m=r[i].name,f=!!d;return f&&(c=r[n.parentID].containerControls.filter((function(e){return e.controlID===l&&e.actualModID===u}))[0]),o.a.createElement(vn,null,o.a.createElement(Cn,{initState:f,text:s||"".concat(m," - ").concat(l),style:{fontSize:Ve.small,padding:".2em"},key:i+a,onSwitch:function(e){t(e?h(n.id,l,u):I(n.id,l,u))}}),f?o.a.createElement(tn,{fontSize:Ve.xsmall,onClick:function(){window.openControlRenameMenu(l,n.parentID,c)}},"edit"):null)})):null,n.moduleType===b?null:Object.keys(n.controlData).map((function(e,a){var c,i=!!n.controlData[e].markedToContainer;return i&&(c=r[n.parentID].containerControls.filter((function(t){return t.controlID===e&&t.actualModID===n.id}))[0]),o.a.createElement(vn,{key:a},o.a.createElement(Cn,{initState:i,text:e,style:{fontSize:Ve.xsmall,padding:"1vmin"},key:e+a,onSwitch:function(a){t(a?h(n.id,e,n.id):I(n.id,e,n.id))}}),i?o.a.createElement(tn,{style:{fontSize:Ve.small},onClick:function(){window.openControlRenameMenu(e,n.parentID,c)}},"edit"):null)})))):null)},Nn={fontSize:Ve.small,padding:".1em"};var xn=function(e){var n=e.modID,t=Object(re.b)(),r=Object(re.c)((function(e){return e.baseContainerID})),c=Object(re.c)((function(e){return e.modules[n]})),i=0!==c.connectionInputs.length,l=0!==c.connectionOutputs.length,u=sn();return window.fillContainerID!==r?o.a.createElement(a.Fragment,null,o.a.createElement(yn,{selectedModule:c}),i||l?o.a.createElement("div",{className:u.MenuHeader},"mark as container io"):null,o.a.createElement(vn,{justifyContent:"center"},i?o.a.createElement(Cn,{style:Nn,fontSize:Ve.xsmall,key:c.id+"inputSwitch",text:"input",initState:c.isContainerInput,onSwitch:function(e){t(e?{type:"MARK_CONTAINER_INPUT",id:c.id}:function(e){return{type:"UNMARK_CONTAINER_INPUT",id:e}}(c.id))}}):null,l?o.a.createElement(Cn,{style:Nn,fontSize:Ve.xsmall,key:c.id+"outputSwitch",text:"output",initState:c.isContainerOutput,onSwitch:function(e){t(e?{type:"MARK_CONTAINER_OUTPUT",id:c.id}:function(e){return{type:"UNMARK_CONTAINER_OUTPUT",id:e}}(c.id))}}):null)):null};function Sn(e,n,t){return{isOpen:e,event:n,modID:t}}var Mn=function(){var e,n=Object(re.c)((function(e){return e.modules})),t=Object(a.useState)(Sn(!1)),r=Object(i.a)(t,2),c=r[0],l=c.isOpen,u=c.event,s=c.modID,d=r[1];window.openModuleContextMenu=function(e,n){return d(Sn(!0,e,n))};var m=function(){d(Sn(!1))},f=sn();return o.a.createElement(a.Fragment,null,l?o.a.createElement(Ze,{event:u,onClose:m},o.a.createElement("div",{className:f.Name,title:"rename module",onClick:function(){window.openModuleRenameMenu(s)}},null===(e=n[s])||void 0===e?void 0:e.name),o.a.createElement(mn,{modules:n,modID:s,onClose:m}),o.a.createElement(dn,{modID:s,modules:n}),o.a.createElement(fn,{modules:n,modID:s,onClose:m}),o.a.createElement(xn,{modID:s}),o.a.createElement(un,{modID:s,onClose:m})):null)};var Tn=function(e){var n=e.saveName,t=e.onClose;return o.a.createElement(ln,{onClick:function(){window.containerSaveService.remove(n).then((function(e){console.log(e),window.refreshSpaceDBModules(),t()}))}})};function kn(e,n,t){return{isOpen:e,event:n,saveName:t}}var Rn=function(){var e=Object(a.useState)(kn(!1)),n=Object(i.a)(e,2),t=n[0],r=t.isOpen,c=t.event,l=t.saveName,u=n[1];return window.openSDBModuleContextMenu=function(e,n){u(kn(!0,e,n))},o.a.createElement(a.Fragment,null,r?o.a.createElement(Ze,{event:c,onClose:function(){return u(kn(!1))},bounderStyle:{zIndex:s+1}},o.a.createElement(Tn,{saveName:l,onClose:function(){return u(kn(!1))}})):null)};var An=function(e){var n=e.saveName,t=e.setSaveList,a=e.onClose;return o.a.createElement(ln,{onClick:function(){window.openConfirmDeleteMenu(n,(function(){window.setTimeout((function(){window.projectSaveService.find().then((function(e){t(e)}))}),1e3)})),a()}})};function Pn(e,n,t,a){return{isOpen:e,event:n,saveName:t,setSaveList:a}}var Bn=function(){var e=Object(a.useState)(Pn(!1)),n=Object(i.a)(e,2),t=n[0],r=t.isOpen,c=t.event,l=t.saveName,u=t.setSaveList,s=n[1];window.openSDBProjectContextMenu=function(e,n,t){s(Pn(!0,e,n,t))};var d=function(){s(Pn(!1))};return o.a.createElement(a.Fragment,null,r?o.a.createElement(Ze,{event:c,onClose:d},o.a.createElement(An,{saveName:l,setSaveList:u,onClose:d})):null)};var Fn=function(){return o.a.createElement(a.Fragment,null,o.a.createElement(Mn,null),o.a.createElement(Bn,null),o.a.createElement(Rn,null))},Ln=Object(l.a)({FillBounder:{backgroundColor:pe,display:"flex",flexDirection:"column",margin:"5vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderRadius:"2vmin"},FillHeaderBounder:{display:"flex",justifyContent:"space-between"},FillHeader:{borderColor:"white",borderStyle:"none none none none",padding:"1vmin",marginLeft:"2vmin","&:hover":{cursor:"pointer"}},Fill:{display:"grid",minWidth:Ke.iconGrid,minHeight:Ke.iconGrid,padding:"4vmin",zIndex:1,rowGap:Ke.gutterGrid,columnGap:Ke.gutterGrid},ArcherContainer:{width:"100%",height:"100%",zIndex:0,display:"grid"},Icon:{backgroundColor:ve,borderRadius:"1.5vmin",borderStyle:"none",borderColor:"white",whiteSpace:"wrap",fontSize:Ve.medium,padding:"1vmin",display:"flex",flexFlow:"column nowrap",alignItems:"flex-end",justifyContent:"flex-start",overflow:"hidden",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)","&:hover":{cursor:"pointer",borderStyle:"solid"},zIndex:2},IconControlContainer:{width:Ke.bigIconWidth,maxHeight:Ke.bigIconHeight,justifySelf:"flex-end",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",overflowY:"scroll",overflowX:"hidden","&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},ArcherElement:{zIndex:1,display:"grid",backgroundColor:"transparent",gridTemplateRows:"10px auto 10px",gridTemplateColumns:"10px auto 10px",padding:"1vmin"},IconName:{fontSize:Ve.small,"&:hover":{cursor:"pointer"}},IconConnector:{backgroundColor:De,width:qe.size,height:qe.size,borderRadius:qe.borderRadius,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderStyle:"solid",borderColor:"transparent","&:hover":{cursor:"pointer",borderColor:"white"},justifySelf:"flex-start",alignSelf:"flex-end",flexShrink:0}}),zn=t(21),_n=Object(l.a)({MenuHeader:{fontSize:Ve.medium,borderStyle:"none none solid none",margin:"1vmin",width:"90%"},ControlBounder:{display:"flex",flexFlow:"row wrap",alignItems:"center",fontSize:Ve.small,justifyContent:"center",margin:"0vmin 1vmin"},ControlMenu:{display:"flex",flexFlow:"row wrap",width:"100%",alignItems:"center",justifyContent:"center"}}),Wn=Object(l.a)({ControlTypeSelect:{minWidth:"9vmin",maxWidth:"5em",margin:"1vmin",fontSize:Ve.small,backgroundColor:Ce,color:Ee,textAlign:"center"},ControlInput:{minWidth:"9vmin",maxWidth:"5em",margin:"1vmin",fontSize:Ve.small},ControlMenu:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center"},Pad:{width:"20vmin",height:"15vmin",borderRadius:"2vmin",backgroundColor:"black"},SrcName:{fontSize:Ve.xsmall,textAlign:"center",whiteSpace:"normal",justifyContent:"center",width:"100%",overflowWrap:"break-word",wordWrap:"break-word",hyphens:"auto"}});var Un=function(e){var n=e.actualModID,t=e.controlID,a=e.setFunc,r=e.reRenderIcon,c=e.modName,i=e.label,l=Wn();return o.a.createElement("div",{className:l.ControlMenu},o.a.createElement("label",{style:{minWidth:"50%"},htmlFor:n+t},o.a.createElement(tn,{fontSize:Ve.small},i||(c?"".concat(c," - ").concat(t):t))),o.a.createElement("input",{style:{width:0,height:0,opacity:0},type:"file",id:n+t,onChange:function(e){var t=e.target.files[0];a(URL.createObjectURL(t)),window.audioTags[n].srcName=t.name,window.reRenderAudioTags(),r()}}),o.a.createElement("div",{className:l.SrcName},window.audioTags[n].srcName))};var Hn=function(e){var n=e.setFunc,t=e.controlID,a=e.actualModID,r=e.modName,c=e.label,i=Wn(),l=window.audioModules[a],u=l.audioNode,s=Object(re.b)(),d=Object(re.c)((function(e){return e.modules[a].controlData[t].value}));return o.a.createElement(vn,{style:{justifyContent:"center",margin:"1vmin 0vmin"}},o.a.createElement("label",{htmlFor:"type"},c||(r?"set type - ".concat(r):"set type")),o.a.createElement("select",{className:i.ControlTypeSelect,name:"type",id:"type",onChange:function(e){n(e.target.value),s(j(a,t,e.target.value))},value:d||u.type},l.typeTypes.map((function(e){return o.a.createElement("option",{value:e,key:a+e},e)}))))};function Gn(e,n){for(var t=0;t<n.length;t++)if(n[t]===e)return!0;return!1}function Kn(e,n,t){return Gn(e,t)&&Gn(n,t)}function Vn(e,n){for(var t=[],a=e;a<n;a++)t.push(a);return t}function qn(e,n){return Math.min(n[1],Math.max(n[0],e))}function Yn(e,n){return e>=n[0]&&e<=n[1]}function Qn(e,n,t){var a=(e-n[0])/(n[1]-n[0]),o=t[1]-t[0];return t[0]+a*o}function Jn(e,n){return(e-n[0])/(n[1]-n[0])*(Ye.rotRange[1]-Ye.rotRange[0])+Ye.rotRange[0]}function Xn(e){var n=(Math.floor(10*e)/10).toString();return"."===n.slice(n.length-2,n.length-1)?n:n+".0"}var Zn=Object(l.a)({KnobContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"auto",placeItems:"center",margin:"1vmin"},KnobSVG:{gridRow:"1",gridColumn:"1",width:"".concat(Ye.size+1,"vmin"),height:"".concat(Ye.size+1,"vmin"),zIndex:9},KnobText:{gridRow:"1",gridColumn:"1",fontSize:Ve.xxsmall,textAlign:"center",color:Ee,zIndex:10,width:"4em",borderStyle:"none",backgroundColor:"transparent","&::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"&::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}},InteractionLayer:{gridRow:"1",gridColumn:"1",zIndex:11,width:"".concat(Ye.size,"vmin"),height:"".concat(Ye.size,"vmin")},SettingsButton:{width:"".concat(Ye.size/6,"vmin"),height:"".concat(Ye.size/6,"vmin"),gridRow:"1",gridColumn:"1",placeSelf:"end",zIndex:12}}),$n=t(44),et=t.n($n),nt=!1;var tt=function(e){var n=e.initValue,t=e.range,r=e.onChange,c=e.onEveryChange,i=e.onSettingsClick,l=e.inputVal,u=e.setInputVal,s=Zn(),d=Object(a.useRef)(null),m=(t[1]-t[0])*Ye.sensitivity/200,f=qn(n,t),p=Object(a.useRef)(null),v=function(e){f=qn(f-e.movementY*m,t),d.current&&(d.current.style.transform="rotate(".concat(Jn(f,t),"deg)")),p.current&&(p.current.value="".concat(Xn(f))),c&&c(f)},b=function(){r&&r(f),u(Xn(f))};return o.a.createElement("div",{className:s.KnobContainer},o.a.createElement("svg",{className:s.KnobSVG,width:"".concat(Ye.size+1,"vmin"),height:"".concat(Ye.size+1,"vmin"),ref:d,style:{transform:"rotate(".concat(Jn(n,t),"deg)")}},o.a.createElement("circle",{cx:"".concat((Ye.size+1)/2,"vmin"),cy:"".concat((Ye.size+1)/2,"vmin"),r:"".concat(Ye.size/2,"vmin"),stroke:ye,strokeWidth:Ye.borderWidth,fill:Ce}),o.a.createElement("rect",{width:"".concat(Ye.markerWidth,"vmin"),height:"".concat(Ye.markerHeight,"vmin"),x:"".concat((Ye.size+1)/2-Ye.markerWidth/2,"vmin"),y:".5vmin",fill:Ne})),o.a.createElement("input",{className:s.KnobText,ref:p,onChange:function(e){u(e.target.value),c&&c(qn(Number(e.target.value),t))},onBlur:function(e){if(0!==e.target.value.length){var n=qn(Number(e.target.value),t);r&&r(n),u(Xn(n))}else p.current&&(p.current.value=l)},onKeyDown:function(e){var n;"Enter"===e.key&&(null===(n=p.current)||void 0===n||n.blur())},type:"number",value:l}),o.a.createElement("div",{className:s.InteractionLayer,title:"".concat(n),onClick:function(e){return e.stopPropagation()},onDragStart:function(e){return e.stopPropagation()},onPointerDown:function(e){e.stopPropagation(),e.preventDefault(),e.shiftKey||nt?p.current&&(p.current.placeholder=p.current.value,p.current.value="",p.current.focus()):(window.openPointerLayer(e.pointerId,v,b),nt=!0,window.setTimeout((function(){nt=!1}),200))}}),i?o.a.createElement("img",{className:s.SettingsButton,title:"edit knob range",src:et.a,alt:"settings",onClick:i}):null)};var at=function(e){var n=e.controlID,t=e.setFunc,r=e.actualModID,c=e.displayModName,l=e.label,u=Object(re.c)((function(e){return{val:e.modules[r].controlData[n].value,currRange:e.modules[r].controlData[n].range}})),s=u.val,d=u.currRange,m=Object(a.useState)(Xn(s)),f=Object(i.a)(m,2),p=f[0],v=f[1],b=Object(re.b)();return o.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},o.a.createElement(tt,{initValue:s,range:d,inputVal:p,setInputVal:v,onEveryChange:function(e){t(e.toString())},onChange:function(e){t(e.toString()),b(j(r,n,e))},onSettingsClick:function(){window.openKnobRangeSetMenu(r,n,(function(e){t(qn(s,e).toString()),v(Xn(qn(s,e))),b(D(r,n,e))}))}}),o.a.createElement("div",null,l||(c?"".concat(c," - ").concat(n):n)))};var ot=function(e){var n=e.setFunc,t=e.controlID,a=e.modName,r=e.label;return o.a.createElement(tn,{fontSize:Ve.small,onClick:function(){n("")}},r||(a?"".concat(a," - ").concat(t):t))};var rt=function(e){var n=e.controlID,t=e.setFunc,a=e.actualModID,r=e.modName,c=e.label,i=Object(re.c)((function(e){return e.modules[a].controlData[n].value}));return o.a.createElement(Cn,{text:c||(r?"".concat(r," - ").concat(n):n),initState:i,onSwitch:function(e){t(e?"true":"false")}})},ct=t(45),it=t.n(ct);var lt=function(e){var n=e.modID,t=window.audioModules[n],r=Object(re.c)((function(e){return e.modules[n].controlData["time graph"].range})),c=200-Qn(0,r,[0,200]),l=Object(a.useState)(0),u=Object(i.a)(l,2),s=u[0],d=u[1],m=Object(re.b)();return o.a.createElement(En,{style:{justifyContent:"center",alignItems:"center"}},o.a.createElement(it.a,{style:{width:Ke.bigIconWidth},setup:function(e,n){e.createCanvas(n.clientWidth,200).parent(n),e.textAlign(e.CENTER,e.CENTER),e.fill(100),d(n.clientWidth)},draw:function(e){t.audioNode.getFloatTimeDomainData(t.timeArray);var n=s/t.bufferLength;e.background(0);var a=0,o=200-Qn(t.timeArray[0],r,[0,200]);e.stroke(Ae),e.strokeWeight(6);for(var i=0;i<t.bufferLength-1;i++){var l=(i+1)*n,u=200-Qn(t.timeArray[i+1],r,[0,200]);e.line(a,o,l,u),a=l,o=u}var d=s/20;e.stroke(100),e.strokeWeight(1),e.line(0,c,d,c),e.text("0",1.5*d,c)}}),o.a.createElement(tn,{style:{width:"10em"},onClick:function(){window.openAnalyzerRangeSetMenu(r,(function(e){m(D(n,"time graph",e))}))}},"change range"))};var ut=function(e){var n=e.setFunc,t=Wn();return o.a.createElement("div",{className:t.Pad,onPointerDown:function(e){e.preventDefault(),n("on")},onPointerCancel:function(e){e.preventDefault(),n("off")},onPointerUp:function(e){e.preventDefault(),n("off")}})};var st=function(e){var n=e.audioModule,t=e.selectedModule,a=e.reRenderIcon,r=_n();return o.a.createElement("div",{className:r.ControlMenu},Object.keys(t.controlData).map((function(e,c){var i=t.controlData[e].controlType,l=n.controlSetFuncs[e];return o.a.createElement("div",{className:r.ControlBounder,key:t.id+e+c},i===w?o.a.createElement(at,{controlID:e,setFunc:l,actualModID:t.id}):"BUTTON"===i&&"open"!==e?o.a.createElement(ot,{setFunc:l,controlID:e}):"TYPE"===i?o.a.createElement(Hn,{setFunc:l,controlID:e,actualModID:t.id}):"FILE"===i?o.a.createElement(Un,{controlID:e,setFunc:l,reRenderIcon:a,actualModID:t.id}):"SWITCH"===i?o.a.createElement(rt,{controlID:e,setFunc:l,actualModID:t.id}):"GRAPH"===i?o.a.createElement(lt,{modID:t.id}):"PAD"===i?o.a.createElement(ut,{setFunc:l}):null)})))};var dt=function(e){var n=e.selectedModule,t=e.reRenderIcon,a=_n(),r=Object(re.c)((function(e){return e.modules}));return o.a.createElement("div",{className:a.ControlMenu},n.containerControls.map((function(e,n){var c=e.modID,i=e.controlID,l=e.actualModID,u=e.name,s=window.audioModules[l],d=r[l].controlData[i].controlType,m=s.controlSetFuncs[i],f=r[c].name;return o.a.createElement("div",{className:a.ControlBounder,key:c+i+n},d===w?o.a.createElement(at,{controlID:i,setFunc:m,actualModID:l,displayModName:f,label:u}):"BUTTON"===d?o.a.createElement(ot,{setFunc:m,controlID:i,modName:f,label:u}):"TYPE"===d?o.a.createElement(Hn,{setFunc:m,controlID:i,actualModID:l,modName:f,label:u}):"FILE"===d?o.a.createElement(Un,{controlID:i,setFunc:m,reRenderIcon:t,modName:f,actualModID:l,label:u}):"SWITCH"===d?o.a.createElement(rt,{controlID:i,setFunc:m,actualModID:l,modName:f,label:u}):"GRAPH"===d?o.a.createElement(lt,{modID:l}):"PAD"===d?o.a.createElement(ut,{setFunc:m}):null)})))};var mt=function(e){switch(e){case"LINE_IN":case"OSCILLATOR":case"MEDIA_ELEMENT":case"CONSTANT":case"ENVELOPED_TRIGGER":case"WHITE_NOISE":return Me;case"GAIN":case"AUTOFILTER":case"KOMPRESSOR":case"SIGNAL_DELAY":case"STEREO_PANNER":case"DISTORTION":return Te;case b:return ke;case"OUTPUT":return Re;case"ANALYZER":return Ae}},ft=Object(l.a)({DropSquare:{width:Ke.icon,height:Ke.icon,padding:".5vmin",borderStyle:"solid",borderRadius:"10px",zIndex:1,"&:hover":{cursor:"pointer"}}});function pt(e,n){return Object.fromEntries(Object.entries(e).filter((function(e){return!Gn(e[0],n)})))}function vt(e,n){return Object.fromEntries(Object.entries(e).filter((function(e){return Gn(e[0],n)})))}function bt(e,n){return e.length===n.length?Object.fromEntries(e.map((function(e,t){return[e,n[t]]}))):{}}var wt=t(7);function gt(e,n){var t=n[e].childModules,a=[];for(var o in t)n[t[o]].moduleType===b&&(a=[].concat(Object(wt.a)(a),Object(wt.a)(gt(t[o],n))));return[].concat(Object(wt.a)(t),Object(wt.a)(a))}function Ot(e,n){var t=Object.keys(e),a=[];for(var o in t){var r=e[t[o]],c=r.fromID,i=r.toID,l=r.actualOutputID,u=r.actualInputID;Kn(l||c,u||i,n)&&(a=[].concat(Object(wt.a)(a),[t[o]]))}return a}function ht(e,n){return vt(e,Ot(e,n))}function It(e,n){var t=[n].concat(Object(wt.a)(gt(n,e.modules)));return{modules:vt(e.modules,t),connections:ht(e.connections,t)}}var jt=function(e,n,t){switch(n){case"OSCILLATOR":var a=z(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,a));break;case"GAIN":var o=F(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,o));break;case"OUTPUT":var r=R(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,r));break;case"AUTOFILTER":var c=k(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,c));break;case"KOMPRESSOR":var i=B(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,i));break;case"STEREO_PANNER":var l=A(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,l));break;case"SIGNAL_DELAY":var u=P(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,u));break;case"CONSTANT":var s=S(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,s));break;case"MEDIA_ELEMENT":window.addAudioTag(e),window.reRenderAudioTags();break;case"LINE_IN":_(e);break;case b:var d=W(e);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,d));break;case"DISTORTION":var m=G(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,m));break;case"ANALYZER":var f=K(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,f));break;case"ENVELOPED_TRIGGER":var w=V(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,w));break;case"WHITE_NOISE":var g=Y(t);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,g))}};var Dt=function(e,n){Object.keys(e).forEach((function(n){var t=e[n],a=t.moduleType,o=t.controlData;jt(n,a,o)})),n&&Object.keys(n).forEach((function(t){var a=n[t],o=a.fromID,r=a.toID,c=a.param,i=a.outputIndex,l=a.inputIndex,u=a.actualOutputID,s=a.actualInputID,d=e[s||r].moduleType,m=e[u||o].moduleType;"MEDIA_ELEMENT"===d||"MEDIA_ELEMENT"===m||"LINE_IN"===d||"LINE_IN"===m?window.setTimeout((function(){$e(window.audioModules[u||o],window.audioModules[s||r],c,i,l)}),200):$e(window.audioModules[u||o],window.audioModules[s||r],c,i,l)}))};var Ct=function(e,n){return"".concat(n).concat(e).concat(Math.floor(20480*Math.random()))};function Et(e,n,t,a){var o=Object.keys(e),r=Object.keys(n),c=bt(o,o.map((function(e,n){return Ct(n,t)}))),i=bt(r,r.map((function(e,n){return Ct(n,a)}))),l=bt(Object.values(c),o.map((function(n){if(e[n].moduleType===b){var t=e[n];return Object(v.a)(Object(v.a)({},t),{},{id:c[n],inputs:t.inputs.filter((function(e){return Gn(e,r)})).map((function(e){return i[e]})),outputs:t.outputs.filter((function(e){return Gn(e,r)})).map((function(e){return i[e]})),containerControls:t.containerControls.map((function(e){return Object(v.a)(Object(v.a)({},e),{},{modID:c[e.modID],actualModID:c[e.actualModID]})})),childModules:t.childModules.map((function(e){return c[e]})),parentID:e[n].parentID?c[e[n].parentID]:null,connectionOutputs:e[n].connectionOutputs.map((function(e){return c[e]})),connectionInputs:e[n].connectionInputs.map((function(e){return c[e]}))})}return Object(v.a)(Object(v.a)({},e[n]),{},{id:c[n],inputs:e[n].inputs.filter((function(e){return Gn(e,r)})).map((function(e){return i[e]})),outputs:e[n].outputs.filter((function(e){return Gn(e,r)})).map((function(e){return i[e]})),parentID:c[e[n].parentID]})}))),u=bt(Object.values(i),r.map((function(e){var t=n[e];return Object(v.a)(Object(v.a)({},t),{},{fromID:c[t.fromID],toID:c[t.toID],actualOutputID:t.actualOutputID?c[t.actualOutputID]:void 0,actualInputID:t.actualInputID?c[t.actualInputID]:void 0})})));return{modIDConverter:c,newModules:l,newConnections:u}}function yt(e,n,t,a,o,r,c,i,l){var u=Et(n,t,a,o),s=u.modIDConverter,d=u.newModules,m=u.newConnections;Dt(d,m),e(y(s[c],d,m,r,i,l))}var Nt=function(e,n,t,a,o){var r=Ct(0,Object.keys(n.modules).length),c=n.modules[t],i=c.name,l=c.moduleType,u=c.controlData,s=c.parentID,d=c.connectionInputs,m=c.connectionOutputs;jt(r,l,u),e(g(r,i,l,u,s,a,o,d,m))};function xt(e,n,t,a,o,r){var c=e.dataTransfer.getData("id"),i=t.modules[window.fillContainerID].childModules,l=t.modules[c],u=function(e,n,t,a){for(var o=0;o<t.length;o++){var r=a[t[o]];if(r.row===e&&r.col===n)return r.id}return!1}(a,o,i,t.modules);if(l)if(u){var s=e.dataTransfer.getData("fromRow"),d=e.dataTransfer.getData("fromCol");r(!1),n(O(c,a,o)),n(O(u,Number(s),Number(d))),window.setTimeout(window.refreshArcherContainer,1)}else{var m=e.dataTransfer.getData("type");switch(r(!1),m){case St:n(O(c,a,o));break;case Mt:t.modules[c].moduleType===b?function(e,n,t,a,o,r){var c=It(n,a);yt(e,c.modules,c.connections,Object.keys(n.modules).length,Object.keys(n.connections).length,t,a,o,r)}(n,t,window.fillContainerID,c,a,o):Nt(n,t,c,a,o)}window.setTimeout(window.refreshArcherContainer,1)}else if(!u){var f=e.dataTransfer.getData("type"),p=e.dataTransfer.getData("name");switch(f){case"ADD_MODULE":var v=e.dataTransfer.getData("moduleType");window.addModule(c,p,window.fillContainerID,v,n,a,o);break;case"CONTAINER_RESTORE":var w=Object.keys(t.modules).length,g=Object.keys(t.connections).length;window.containerSaveService.get(p).then((function(e){var t=e.containerID,r=e.modules,c=e.connections;yt(n,r,c,w,g,window.fillContainerID,t,a,o)}))}r(!1)}}var St="MOVE",Mt="COPY";var Tt=function(e){var n=e.row,t=e.col,r=ft(),c=Object(re.b)(),l=Object(re.c)((function(e){return e})),u=Object(a.useState)(!1),s=Object(i.a)(u,2),d=s[0],m=s[1],f={gridColumn:"".concat(t+1," / span 1"),gridRow:"".concat(n+1," / span 1"),borderColor:d?Oe:"transparent"};return o.a.createElement("div",{className:r.DropSquare,style:f,onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.dataTransfer.types.length>=3&&m(!0)},onDragLeave:function(e){m(!1)},onDrop:function(e){xt(e,c,l,n,t,m)},onContextMenu:function(e){e.preventDefault(),window.openAddModuleMenu(n,t)},onPointerEnter:function(e){e.preventDefault(),m(!0)},onPointerLeave:function(e){e.preventDefault(),m(!1)}})};var kt=function(e){var n=e.mod,t=e.gridCol,r=e.gridRow,c=Ln(),l=Object(a.useState)(!1),u=Object(i.a)(l,2),s=u[0],d=u[1],m=Object(a.useState)(!1),f=Object(i.a)(m,2),p=f[0],v=f[1],w=function(){v(!p)},g={gridColumn:"".concat(t," / span 1"),gridRow:"".concat(r," / span 1"),width:s?Ke.bigIconWidth:Ke.icon,height:s?Ke.bigIconHeight:Ke.icon},h=Object.assign({},g,{borderStyle:s?"solid":"none",backgroundColor:mt(n.moduleType)}),I={fontSize:Ve.small},j=Object(re.c)((function(e){return e})),D=j.modules,C=j.connections,E=Object(re.b)();return o.a.createElement(a.Fragment,null,o.a.createElement("div",{className:c.Icon,style:h,onPointerDown:function(e){return e.stopPropagation()},onDragOver:function(e){e.preventDefault()},onDrop:function(e){!function(e,n,t,a){e.stopPropagation();var o=e.dataTransfer.getData("id"),r=e.dataTransfer.getData("type");if(o){if(n[o]&&r===St){var c=e.dataTransfer.getData("fromRow"),i=e.dataTransfer.getData("fromCol");a(O(o,t.row,t.col)),a(O(t.id,Number(c),Number(i))),window.setTimeout(window.refreshArcherContainer,100)}}else if(0===t.connectionInputs.length&&0===window.audioModules[t.id].connectingParamIDs.length)alert("mod cannot accept input");else{var l=e.dataTransfer.getData("fromID");l&&window.openConnectionMenu(l,t.id)}}(e,D,n,E)},draggable:!s,onDragStart:function(e){!function(e,n){e.shiftKey?e.dataTransfer.setData("type",Mt):e.dataTransfer.setData("type",St),e.dataTransfer.setData("id",n.id),e.dataTransfer.setData("fromRow","".concat(n.row)),e.dataTransfer.setData("fromCol","".concat(n.col))}(e,n)},onClick:function(e){e.stopPropagation(),d(!s),window.setTimeout(window.refreshArcherContainer,0)},onContextMenu:function(e){e.preventDefault(),e.persist(),window.openModuleContextMenu(e,n.id)}},0===n.connectionOutputs.length?null:o.a.createElement("div",{className:c.IconConnector,draggable:!0,onDragStart:function(e){e.stopPropagation(),e.dataTransfer.setData("fromID",n.id)}}),o.a.createElement("div",{className:c.IconName,style:I,onClick:function(e){s&&(e.stopPropagation(),window.openModuleRenameMenu(n.id))}},n.name),s?o.a.createElement("div",{className:c.IconControlContainer,onClick:function(e){return e.stopPropagation()}},n.moduleType===b?o.a.createElement(dt,{selectedModule:n,reRenderIcon:w}):null,n.moduleType!==b?o.a.createElement(st,{audioModule:window.audioModules[n.id],selectedModule:n,reRenderIcon:w}):null):null),o.a.createElement("div",{className:c.ArcherElement,style:g},o.a.createElement("div",{style:{gridColumn:"".concat(1," / span 1"),gridRow:"".concat(1," / span 1")}},o.a.createElement(zn.ArcherElement,{id:n.id+" input"},o.a.createElement("div",{style:{width:"10px",height:"10px"}}))),o.a.createElement("div",{style:{gridColumn:"".concat(1," / span 1"),gridRow:"".concat(3," / span 1")}},o.a.createElement(zn.ArcherElement,{id:n.id+" controls"},o.a.createElement("div",{style:{width:"10px",height:"10px"}}))),o.a.createElement("div",{style:{gridColumn:"".concat(3," / span 1"),gridRow:"".concat(1," / span 1")}},o.a.createElement(zn.ArcherElement,{id:n.id+" output",relations:n.outputs.filter((function(e){var n=C[e];return Kn(n.fromID,n.toID,D[window.fillContainerID].childModules)})).map((function(e){var n=C[e],t=n.toID,a=n.param;return{targetId:""===a?t+" input":t+" controls",targetAnchor:"left",sourceAnchor:"right",style:{strokeColor:""===a?"red":"blue"}}}))},o.a.createElement("div",{style:{width:"10px",height:"10px"}})))))};var Rt=function(){var e=Ln(),n=Object(a.useState)(!1),t=Object(i.a)(n,2),r=t[0],c=t[1];window.reRenderFillContainer=function(){c(!r)};var l,u=Object(re.c)((function(e){return{modules:e.modules,baseContainerID:e.baseContainerID}})),s=u.modules,d=u.baseContainerID,m=s[window.fillContainerID],f=function(e,n){var t=0,a=0;return e.forEach((function(e){var o=n[e];o.row>t&&(t=o.row),o.col>a&&(a=o.col)})),{maxRow:t,maxCol:a}}(m.childModules,s),p=f.maxRow,v=f.maxCol,b=0===m.childModules.length;l=b?{gridTemplateRows:"repeat(".concat(1,", ","auto",")"),gridTemplateColumns:"repeat(".concat(1,", ","auto",")")}:{gridTemplateRows:"repeat(".concat(p+2,", ","auto",")"),gridTemplateColumns:"repeat(".concat(v+2,", ","auto",")")};var w=Object(a.useRef)(null);return window.refreshArcherContainer=function(){var e;null===(e=w.current)||void 0===e||e.refreshScreen()},o.a.createElement("div",{className:e.FillBounder},o.a.createElement("div",{className:e.FillHeaderBounder},o.a.createElement("div",{className:e.FillHeader,style:{width:"".concat(m.name.length/2,"em")},onClick:function(e){e.stopPropagation(),window.openModuleRenameMenu(window.fillContainerID)},onPointerDown:function(e){return e.stopPropagation()}},m.name),m.id===d?null:o.a.createElement(tn,{style:{height:".7em"},onPointerDown:function(){window.fillContainerID=m.parentID,window.reRenderFillContainer()}},o.a.createElement("div",null,"back"))),o.a.createElement(zn.ArcherContainer,{ref:w,svgContainerStyle:{zIndex:-1},strokeWidth:8,arrowLength:0},o.a.createElement("div",{className:e.Fill,style:l},b?o.a.createElement(Tt,{row:0,col:0}):Vn(0,p+2).map((function(e){return Vn(0,v+2).map((function(n){return o.a.createElement(Tt,{key:"".concat(e," ").concat(n),row:e,col:n})}))})).flat(),m.childModules.map((function(e){var n=s[e];return o.a.createElement(kt,{key:n.id,mod:n,gridRow:n.row+1,gridCol:n.col+1})})))))},At=Object(l.a)({DrawerBounder:{width:"0px",height:"100vh",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",color:"white",position:"absolute",top:"0px",right:"0px",userSelect:"none",zIndex:10},Drawer:{backgroundColor:le,height:"100vh",width:"".concat(Ge.width,"px"),display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"flex-start",position:"absolute",top:"0px",right:"0px"},DrawerHeader:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"inherit",overflowX:"scroll",overflowY:"hidden","&::-webkit-scrollbar":{height:"3px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},DrawerHeaderItem:{fontSize:Ve.medium,padding:"1vmin 1.5vmin",color:be,textDecoration:"none",whiteSpace:"nowrap","&:hover":{cursor:"pointer"}},ItemRouter:{width:"".concat(Ge.width,"px"),height:"calc(100% - 60px)",display:"flex",flexFlow:"column wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start","&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},Toggle:{backgroundColor:ue,width:Ge.toggleWidth,zIndex:10,height:"100%",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{cursor:"pointer"},position:"absolute",top:"0px",right:"".concat(Ge.width,"px")},ToggleLine:{backgroundColor:se,borderRadius:"4px",width:"0.75vmin",height:"80px"},SDBSaveList:{display:"flex",flexDirection:"column",overflow:"scroll",height:"60%","&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}}});var Pt=function(e){var n=e.className,t=e.text,a=e.onClick,r={color:e.selectedRoute===t?we:be};return o.a.createElement("div",{className:n,onClick:a,style:r},t)};var Bt=function(e,n){var t=n.modules,a=n.connections;Object.keys(e).forEach((function(n){var t=e[n],a=t.fromID,o=t.toID,r=t.param,c=t.outputIndex,i=t.actualOutputID,l=t.actualInputID;window.audioModules[i||a]&&window.audioModules[l||o]&&en(window.audioModules[i||a],window.audioModules[l||o],r,c)})),window.numberRestores++,window.audioModules={},window.audioTags={},Object.keys(t).forEach((function(e){var n=t[e],a=n.moduleType,o=n.controlData;jt(e,a,o)})),a&&Object.keys(a).forEach((function(e){var n=a[e],o=n.fromID,r=n.toID,c=n.param,i=n.outputIndex,l=n.inputIndex,u=n.actualOutputID,s=n.actualInputID,d=t[s||r].moduleType,m=t[u||o].moduleType;"MEDIA_ELEMENT"===d||"MEDIA_ELEMENT"===m||"LINE_IN"===d||"LINE_IN"===m?function e(n,t,a,o,r,c,i,l){n>10?alert("restore failed"):window.setTimeout((function(){window.audioModules[i||t]&&window.audioModules[l||a]?$e(window.audioModules[i||t],window.audioModules[l||a],o,r,c):e(n+1,t,a,o,r,c,i,l)}),500)}(0,o,r,c,i,l,u,s):$e(window.audioModules[u||o],window.audioModules[s||r],c,i,l)}))},Ft={backgroundColor:"transparent"};var Lt=function(){var e=Object(a.useState)([]),n=Object(i.a)(e,2),t=n[0],r=n[1],c=Object(re.b)(),l=Object(re.c)((function(e){return e.connections}));Object(a.useEffect)((function(){window.projectSaveService.find().then((function(e){r(e)}))}),[]);var u=At();return o.a.createElement("div",{style:{}},o.a.createElement(tn,{style:{backgroundColor:ze},onClick:function(){window.openSpaceDBProjectSaveMenu(t,(function(){window.setTimeout((function(){window.projectSaveService.find().then((function(e){r(e)}))}),1e3)}))}},"save project"),o.a.createElement("div",{className:u.SDBSaveList},t.map((function(e,n){return o.a.createElement(tn,{style:Ft,key:n,onClick:function(){window.projectSaveService.get(e).then((function(e){Bt(l,e),c(N(e))}))},onContextMenu:function(n){n.preventDefault(),n.persist(),window.openSDBProjectContextMenu(n,e,r)}},e)}))))};var zt=function(){var e=Object(re.c)((function(e){return Object.keys(e.modules).length}));return o.a.createElement(a.Fragment,null,e<2?null:o.a.createElement(tn,{onClick:function(){window.openConfirmBlankProjectMenu()}},"blank project"))},_t=t(9),Wt=t.n(_t),Ut=t(10);function Ht(e,n){return Gt.apply(this,arguments)}function Gt(){return(Gt=Object(Ut.a)(Wt.a.mark((function e(n,t){var a;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.createWritable();case 2:return a=e.sent,e.next=5,a.write(JSON.stringify(t));case 5:return e.next=7,a.close();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kt(e){return Vt.apply(this,arguments)}function Vt(){return(Vt=Object(Ut.a)(Wt.a.mark((function e(n){var t,a,o,r,c;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showOpenFilePicker();case 2:if(t=e.sent,a=Object(i.a)(t,1),!(o=a[0])){e.next=16;break}return n&&n(o),e.next=9,o.getFile();case 9:return r=e.sent,e.next=12,r.text();case 12:return c=e.sent,e.abrupt("return",JSON.parse(c));case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qt(e,n){return Yt.apply(this,arguments)}function Yt(){return(Yt=Object(Ut.a)(Wt.a.mark((function e(n,t){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showSaveFilePicker({types:[{description:"space machine project",accept:{"example/*":[".sm"]}}]});case 2:return window.saveFileHandle=e.sent,e.next=5,Ht(window.saveFileHandle,n);case 5:t&&t();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qt(e){var n=e.name;return n.slice(0,n.length-3)}var Jt=function(e){var n=e.reRender,t=e.state,a=Object(re.b)();return o.a.createElement(tn,{fontSize:Ve.medium,onClick:Object(Ut.a)(Wt.a.mark((function e(){var o;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Kt((function(e){window.saveFileHandle=e}));case 2:(o=e.sent)?(Bt(t.connections,o),a(N(o)),n()):window.flashNotification("rgba(1, 1, 1, .4)","no file selected");case 4:case"end":return e.stop()}}),e)})))},"open")};var Xt=function(e){var n=e.state,t=e.reRender;return o.a.createElement(tn,{fontSize:Ve.medium,onClick:Object(Ut.a)(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:qt(n,(function(){t(),window.flashNotification(He,"".concat(Qt(window.saveFileHandle)," saved"))}));case 1:case"end":return e.stop()}}),e)})))},"save as")};var Zt=function(e){var n=e.state;return o.a.createElement(a.Fragment,null,window.saveFileHandle?o.a.createElement(tn,{fontSize:Ve.medium,onClick:Object(Ut.a)(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ht(window.saveFileHandle,n);case 2:window.flashNotification(He,"".concat(Qt(window.saveFileHandle)," saved"));case 3:case"end":return e.stop()}}),e)})))},"save ".concat(Qt(window.saveFileHandle))):o.a.createElement(tn,{fontSize:Ve.medium,notClickable:!0,style:{backgroundColor:"transparent",color:ge}}," no file open "))};var $t=function(){var e=Object(re.c)((function(e){return e})),n=Object(a.useState)({}),t=Object(i.a)(n,2)[1];return window.reRenderFileMenu=function(){t({})},o.a.createElement(vn,{alignItems:"center",flexWrap:"wrap",style:{width:"100%"}},o.a.createElement(Jt,{state:e,reRender:window.reRenderFileMenu}),o.a.createElement(Xt,{state:e,reRender:window.reRenderFileMenu}),o.a.createElement(Zt,{state:e}),o.a.createElement(zt,null))},ea="".concat(Ge.width),na=function(e){return"".concat(e,"px")};var ta=function(){var e=At(),n=Object(a.useState)(!0),t=Object(i.a)(n,2),r=t[0],c=t[1],l=Object(a.useState)(ea),u=Object(i.a)(l,2),s=u[0],d=u[1],m=Object(wn.b)({transform:r?"translate(0px, 0px)":"translate(".concat(s,"px, 0px)"),config:{tension:220,clamp:!0}}),f=Object(a.useState)(window.usingElectron?"spaceDB projects":"file"),p=Object(i.a)(f,2),v=p[0],b=p[1],w=Object(a.useRef)(null),g=Object(a.useRef)(null),O=Object(a.useRef)(null),h=Object(a.useRef)(null),I=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),j=!1,D=Object(a.useState)({}),C=Object(i.a)(D,2)[1];return Object(a.useEffect)((function(){window.addEventListener("resize",(function(){window.setTimeout((function(){C({})}),500)}))}),[]),o.a.createElement(wn.a.div,{className:e.DrawerBounder,style:m,onPointerDown:function(e){return e.stopPropagation()}},o.a.createElement("div",{className:e.Toggle,ref:g,onPointerDown:function(e){var n;r&&e.shiftKey?(j=!0,null===(n=g.current)||void 0===n||n.setPointerCapture(e.pointerId)):c(!r)},onPointerMove:function(e){j&&(ea="".concat(qn(I-e.clientX,[150,700])),w.current&&(w.current.style.width=na(ea)),O.current&&(O.current.style.width=na(ea)),h.current&&(h.current.style.width=na(ea)),g.current&&(g.current.style.right=na(ea)))},onPointerUp:function(e){var n;j&&(j=!1,d(ea),null===(n=g.current)||void 0===n||n.releasePointerCapture(e.pointerId))}},o.a.createElement("div",{className:e.ToggleLine,onClick:function(){c(!r)}})),o.a.createElement("div",{className:e.Drawer,ref:w},o.a.createElement("div",{className:e.DrawerHeader,ref:O,onWheel:function(e){O&&O.current&&(O.current.scrollLeft+=e.deltaY)}},window.usingElectron?o.a.createElement(Pt,{className:e.DrawerHeaderItem,text:"spaceDB projects",onClick:function(){b("spaceDB projects")},selectedRoute:v}):null,o.a.createElement(Pt,{className:e.DrawerHeaderItem,text:"file",onClick:function(){b("file")},selectedRoute:v})),o.a.createElement("div",{className:e.ItemRouter,ref:h},"spaceDB projects"===v?o.a.createElement(Lt,null):"file"===v?o.a.createElement($t,null):null)))};var aa=function(e){var n=e.id,t=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(!window.audioModules[n]){var e=U(t);e&&(window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},n,e)))}})),o.a.createElement("audio",{ref:t,autoPlay:!0})};window.addAudioTag=function(e){window.audioTags[e]={id:e,srcName:""}},window.audioTags={},window.numberRestores=0;var oa=function(){var e=Object(a.useState)(!1),n=Object(i.a)(e,2),t=n[0],r=n[1];window.reRenderAudioTags=function(){r(!t)};var c=Object.keys(window.audioTags);return o.a.createElement(a.Fragment,null,c.map((function(e){return o.a.createElement(aa,{key:e+window.numberRestores,id:e})})))},ra=Object(l.a)({CenterMenuBounder:{backgroundColor:me,backdropFilter:"blur(5px)",position:"absolute",top:0,left:0,width:"100vw",height:"100vh",zIndex:s},CenterMenu:{backgroundColor:de,position:"absolute",top:"50vh",left:"50vw",transform:"translate(-50%, calc(-50% - 50px))",display:"flex",flexDirection:"column",alignItems:"center",borderRadius:"1.2vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",minWidth:"15vw",padding:"1vmin 2vmin 2vmin 2vmin",border:".1em solid ".concat(fe)},Header:{padding:"1vmin 2vmin",margin:"0vmin 0vmin 2vmin 0vmin",borderColor:"white",borderStyle:"none none solid none",fontSize:Ve.large}});var ca=function(e){var n=e.isClosed,t=e.className,r=e.style,c=e.headerClassName,i=e.headerStyle,l=e.children,u=e.header,s=e.onClose,d=e.bounderStyle,m=ra();return o.a.createElement(a.Fragment,null,n?null:o.a.createElement(wn.a.div,{className:m.CenterMenuBounder,onPointerDown:function(e){e.stopPropagation(),s()},style:d},o.a.createElement("div",{className:t?"".concat(m.CenterMenu," ").concat(t):m.CenterMenu,onPointerDown:function(e){e.stopPropagation()},style:r},u?o.a.createElement("div",{className:c?"".concat(m.Header," ").concat(c):m.Header,style:i},u):null,l)))},ia=Object(l.a)({AutoPlacingGrid:{display:"grid",gridTemplateRows:function(e){var n=e.numRows;return"repeat(".concat(n,", auto)")},gridTemplateColumns:function(e){var n=e.numCols;return"repeat(".concat(n,", auto)")},gridAutoFlow:function(e){return e.direction},gridAutoRows:function(e){return e.numRows?null:"auto"},gridAutoColumns:function(e){return e.numCols?null:"auto"},gap:function(e){return e.gap},justifyItems:"center"}});var la=function(e){var n=e.children,t=e.className,a=e.style,r=e.numRows,c=e.numCols,i=e.direction,l=e.gap,u=ia({numRows:r,numCols:c,direction:i,gap:l});return o.a.createElement("div",{className:t?"".concat(u.AutoPlacingGrid," ").concat(t):u.AutoPlacingGrid,style:a},n)};function ua(e,n,t){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=0;o<n.outputs.length;o++){var r=e[n.outputs[o]],c=r.actualInputID,i=r.param;if(c===t&&a===i)return!0}return!1}var sa=Object(l.a)({Module:{borderRadius:"1.5vmin",display:"flex",flexDirection:"column",alignItems:"center",flexGrow:1,flexShrink:1,"&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"},padding:".2em .5em",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},IconConnector:{backgroundColor:De,width:qe.size,height:qe.size,borderRadius:qe.borderRadius,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderStyle:"solid",borderColor:"transparent","&:hover":{cursor:"pointer",borderColor:"white"}},ConnectorBounder:{alignItems:"center"},Name:{whiteSpace:"noWrap",fontSize:Ve.medium,marginBottom:".2em","&:hover":{cursor:"pointer"}},ConnectorName:{whiteSpace:"noWrap",fontSize:Ve.small},ParamName:{whiteSpace:"noWrap",fontSize:Ve.small},ConnectionReciever:{backgroundColor:"black",width:qe.size,height:qe.size,borderRadius:qe.borderRadius,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderStyle:"solid",borderColor:xe,borderWidth:".25em"},SmallConnectionReciever:{backgroundColor:"black",width:qe.smallSize,height:qe.smallSize,borderRadius:qe.smallBorderRadius,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderStyle:"solid",borderColor:Se,borderWidth:".2em"}});var da=function(e){var n=e.modID,t=e.startsBig,r=e.fromID,c=e.toID,l=e.isFromContainer,u=e.isToContainer,s=e.onClose,d=sa(),m=Object(re.c)((function(e){return e.modules[n]})),f=Object(re.c)((function(e){return e})),p=f.modules,v=f.connections,b=window.audioModules[n],w=window.audioModules,g=Object(a.useState)(t),O=Object(i.a)(g,2),h=O[0],I=O[1],j=Object(re.b)();return o.a.createElement("div",{className:d.Module,style:{backgroundColor:mt(m.moduleType)}},o.a.createElement("div",{className:d.Name,style:{marginBottom:".2em"},onClick:function(){I(!h)}},m.name),o.a.createElement(vn,{style:{justifyContent:"center"}},o.a.createElement(En,{style:{marginRight:0!==b.connectingParamIDs.length?".4em":"0em"}},h?m.connectionInputs.map((function(e,t){return o.a.createElement(En,{key:t},o.a.createElement("div",{className:d.ConnectionReciever,onDragOver:function(e){e.preventDefault()},onDrop:function(e){e.preventDefault();var a=e.dataTransfer.getData("actualFromID"),o=p[a],i=Number(e.dataTransfer.getData("outputIndex"));ua(v,o,n)?alert("modules already connected"):($e(w[a],w[n],"",i,t),j(C(r,c,"",i,t,l?a:void 0,u?n:void 0)),window.flashNotification(He,"connection created"),s())}}),1!==m.connectionInputs.length?e:null)})):null),0===b.connectingParamIDs.length?null:o.a.createElement(la,{direction:"row",numCols:"2",gap:".2em"},h?b.connectingParamIDs.map((function(e,t){return o.a.createElement(En,{style:{alignItems:"center"},key:t,onDragOver:function(e){e.preventDefault()},onDrop:function(t){t.preventDefault();var a=t.dataTransfer.getData("actualFromID"),o=p[a],i=Number(t.dataTransfer.getData("outputIndex"));ua(v,o,n,e)?alert("modules already connected"):($e(w[a],w[n],e,i,0),j(C(r,c,e,i,0,l?a:void 0,u?n:void 0)),window.flashNotification(He,"connection created"),s())}},o.a.createElement("div",{className:d.SmallConnectionReciever}),o.a.createElement("div",{className:d.ParamName},e))})):null)))};var ma=function e(n){var t=n.modID,r=n.startsBig,c=n.fromID,l=n.toID,u=n.isFromContainer,s=n.onClose,d=n.isBase,m=sa(),f=Object(re.c)((function(e){return e.modules})),p=f[t],v=p.connectionInputs,w=v.length<=2,g=Object(a.useState)(r),O=Object(i.a)(g,2),h=O[0],I=O[1];return o.a.createElement("div",{className:m.Module,style:{backgroundColor:mt(b),maxHeight:d?"60vmin":"40vmin",overflowY:d?"scroll":"visible"}},o.a.createElement("div",{className:m.Name,onClick:function(){I(!h)}},p.name),o.a.createElement(la,{direction:"row",numCols:2,gap:".2em"},h?v.map((function(n,t){return f[n].moduleType===b?o.a.createElement(e,{key:t,modID:n,fromID:c,toID:l,isFromContainer:u,onClose:s,isBase:!1,startsBig:w}):o.a.createElement(da,{key:t,modID:n,fromID:c,toID:l,isFromContainer:!0,isToContainer:!0,onClose:s,startsBig:w})})):null))};var fa=function(e){var n=e.modID,t=e.startsBig,r=e.isBase,c=sa(),l=Object(re.c)((function(e){return e.modules[n]})),u=Object(a.useState)(t),s=Object(i.a)(u,2),d=s[0],m=s[1];return o.a.createElement("div",{className:c.Module,style:{backgroundColor:mt(l.moduleType),overflow:"visible",marginRight:r?"1em":"0em"}},o.a.createElement("div",{className:c.Name,onClick:function(){m(!d)}},l.name),d?l.connectionOutputs.length>1?o.a.createElement(la,{direction:"row",numCols:"2",gap:".2em"},l.connectionOutputs.map((function(e,t){return o.a.createElement(En,{className:c.ConnectorBounder,key:t},o.a.createElement("div",{className:c.IconConnector,draggable:!0,onDragStart:function(e){e.dataTransfer.setData("actualFromID",n),e.dataTransfer.setData("outputIndex",t.toString())}}),1===l.connectionOutputs.length?null:o.a.createElement("div",{className:c.ConnectorName},e))}))):o.a.createElement(En,{className:c.ConnectorBounder},o.a.createElement("div",{className:c.IconConnector,draggable:!0,onDragStart:function(e){e.dataTransfer.setData("actualFromID",n),e.dataTransfer.setData("outputIndex","0")}})):null)};var pa=function e(n){var t=n.modID,r=n.startsBig,c=n.isBase,l=sa(),u=Object(re.c)((function(e){return e.modules})),s=u[t],d=s.connectionOutputs,m=d.length<=2,f=Object(a.useState)(r),p=Object(i.a)(f,2),v=p[0],w=p[1];return o.a.createElement("div",{className:l.Module,style:{backgroundColor:mt(s.moduleType),marginRight:c?"1em":"0em",maxHeight:c?"60vmin":"40vmin",overflowY:c?"scroll":"visible"}},o.a.createElement("div",{className:l.Name,onClick:function(){w(!v)}},s.name),o.a.createElement(la,{direction:"row",numCols:2,gap:".2em"},v?d.map((function(n,t){return u[n].moduleType===b?o.a.createElement(e,{key:t,modID:n,startsBig:m,isBase:!1}):o.a.createElement(fa,{key:t,modID:n,startsBig:m,isBase:!1})})):null))};function va(e,n,t){return{isOpen:e,fromMod:n,toMod:t}}var ba=function(){var e=Object(a.useState)(va(!1)),n=Object(i.a)(e,2),t=n[0],r=t.isOpen,c=t.fromMod,l=t.toMod,u=n[1],s=Object(re.c)((function(e){return e})).modules;window.openConnectionMenu=function(e,n){u(va(!0,s[e],s[n]))};var d=function(){u(va(!1))};return o.a.createElement(ca,{header:"add connection",isClosed:!r,onClose:d},o.a.createElement(vn,null,(null===c||void 0===c?void 0:c.moduleType)===b?o.a.createElement(pa,{modID:null===c||void 0===c?void 0:c.id,startsBig:!0,isBase:!0}):o.a.createElement(fa,{modID:null===c||void 0===c?void 0:c.id,startsBig:!0,isBase:!0}),(null===l||void 0===l?void 0:l.moduleType)===b?o.a.createElement(ma,{modID:null===l||void 0===l?void 0:l.id,startsBig:!0,fromID:null===c||void 0===c?void 0:c.id,toID:null===l||void 0===l?void 0:l.id,isFromContainer:(null===c||void 0===c?void 0:c.moduleType)===b,onClose:d,isBase:!0}):o.a.createElement(da,{modID:null===l||void 0===l?void 0:l.id,startsBig:!0,fromID:null===c||void 0===c?void 0:c.id,toID:null===l||void 0===l?void 0:l.id,isFromContainer:(null===c||void 0===c?void 0:c.moduleType)===b,isToContainer:!1,onClose:d})))},wa=Object(l.a)({CMInputBounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},CenterMenuInput:{backgroundColor:ie,color:"white",height:"2vmin",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:Ve.small,width:"15vmin","&:hover":{cursor:"text"}}});function ga(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,controlID:n,onChangeSubmit:t}}var Oa=function(){var e=Object(a.useState)(ga(!1)),n=Object(i.a)(e,2),t=n[0],r=t.isOpen,c=t.controlID,l=t.onChangeSubmit,u=n[1],s=Object(re.c)((function(e){return e.modules})),d=Object(a.useState)(0),m=Object(i.a)(d,2),f=m[0],p=m[1],v=Object(a.useState)(0),b=Object(i.a)(v,2),w=b[0],g=b[1],O=Object(a.useState)(void 0),h=Object(i.a)(O,2),I=h[0],j=h[1];window.openKnobRangeSetMenu=function(e,n,t){var a=s[e].controlData[n],o=a.range,r=a.maxRange;u(ga(!0,n,t)),p(o[0]),g(o[1]),j(r)};var D=function(){u(ga(!1))},C=wa();return o.a.createElement(ca,{isClosed:!r,header:"set ".concat(c," range"),onClose:D},o.a.createElement("div",{style:{fontSize:Ve.small}},I?"max range from ".concat(I[0]," to ").concat(I[1]):null),o.a.createElement("div",{className:C.CMInputBounder,onKeyDown:function(e){"Escape"===e.key?D():"Enter"===e.key&&(l([f,w]),D())}},o.a.createElement("input",{className:C.CenterMenuInput,onChange:function(e){p(Number(e.target.value))},value:f,type:"number"}),o.a.createElement("input",{className:C.CenterMenuInput,onChange:function(e){g(Number(e.target.value))},value:w,type:"number"})),o.a.createElement(tn,{style:{fontSize:Ve.small,backgroundColor:Pe},onClick:function(){I?Yn(f,I)&&Yn(w,I)?w>f?(l([f,w]),D()):alert("min must be less than max"):alert("a value is not within maximum range bounds"):w>f?(l([f,w]),D()):alert("min must be less than max")}},"confirm"))},ha=Object(l.a)({CenterMenuInput:{backgroundColor:ie,color:"white",height:"1em",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:Ve.medium,textAlign:"center","&:hover":{cursor:"text"}}});function Ia(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,saveList:n,preOnClose:t}}var ja=function(){var e=Object(a.useState)(Ia(!1)),n=Object(i.a)(e,2),t=n[0],r=t.isOpen,c=t.saveList,l=t.preOnClose,u=n[1],s=Object(re.c)((function(e){return e})),d=s.baseContainerID,m=s.modules,f=Object(a.useState)(""),p=Object(i.a)(f,2),v=p[0],b=p[1],w=Object(a.useState)({isOpen:!1,message:""}),g=Object(i.a)(w,2),O=g[0],h=g[1];window.openSpaceDBProjectSaveMenu=function(e,n){b(m[d].name),h({isOpen:!1,message:""}),u(Ia(!0,e,n))};var I=function(){l(),u(Ia(!1))},j=Object(a.useRef)(null),D=ha();return o.a.createElement(ca,{header:"save project",isClosed:!r,onClose:I},o.a.createElement(vn,{style:{alignItems:"center"}},o.a.createElement("input",{className:D.CenterMenuInput,value:v,placeholder:m[d].name,onChange:function(e){b(e.target.value)},onKeyDown:function(e){switch(e.key){case"Enter":Gn(v,c)?h({isOpen:!0,message:"would you like to overwrite this save?"}):(window.projectSaveService.create({saveName:v,state:s}).then((function(e){e&&window.flashNotification("green","project saved")})),I());break;case"Escape":I()}},ref:j,autoFocus:!0}),o.a.createElement(tn,{onPointerDown:function(e){return e.preventDefault()},onClick:function(e){e.preventDefault(),Gn(v,c)?h({isOpen:!0,message:"save already exists. do you want to replace it?"}):(window.projectSaveService.create({saveName:v,state:s}).then((function(e){e&&window.flashNotification("green","project saved")})),I())}},"save to spaceDB")),O.isOpen?o.a.createElement(En,null,o.a.createElement("div",{style:{fontSize:Ve.small}},O.message),o.a.createElement(vn,{style:{justifyContent:"center"}},o.a.createElement(tn,{style:{backgroundColor:Be,marginRight:"3vmin"},onClick:function(){var e;null===(e=j.current)||void 0===e||e.focus(),h({isOpen:!1,message:""})}},"no"),o.a.createElement(tn,{style:{backgroundColor:Pe},onClick:function(){window.projectSaveService.update(v,s).then((function(e){e&&window.flashNotification("green","project updated")})),I()}},"yes"))):null)};function Da(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,saveName:n,preOnClose:t}}var Ca=function(){var e=Object(a.useState)(Da(!1)),n=Object(i.a)(e,2),t=n[0],r=t.isOpen,c=t.saveName,l=t.preOnClose,u=n[1];window.openConfirmDeleteMenu=function(e,n){u(Da(!0,e,n))};var s=function(){l(),u(Da(!1))};return o.a.createElement(ca,{header:"are you sure you want to delete ".concat(c,"?"),isClosed:!r,onClose:s},o.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"}},o.a.createElement(tn,{style:{backgroundColor:Be,marginRight:"3vmin"},onClick:function(){s()}},"no"),o.a.createElement(tn,{style:{backgroundColor:Pe},onClick:function(){window.projectSaveService.remove(c),s()}},"yes")))};var Ea=function(){var e=Object(a.useState)(!1),n=Object(i.a)(e,2),t=n[0],r=n[1],c=Object(a.useState)(""),l=Object(i.a)(c,2),u=l[0],s=l[1];window.openFileSaveMenu=function(){s(d.modules[d.baseContainerID].name),r(!0)};var d=Object(re.c)((function(e){return e})),m=ha();return o.a.createElement(ca,{header:"save project as file",isClosed:!t,onClose:function(){r(!1)}},o.a.createElement("input",{className:m.CenterMenuInput,placeholder:d.modules[d.baseContainerID].name,value:u,onChange:function(e){s(e.target.value)}}),o.a.createElement(tn,{onClick:Object(Ut.a)(Wt.a.mark((function e(){var n,t;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.saveDirectoryHandle){e.next=4;break}return e.next=3,window.showDirectoryPicker();case 3:window.saveDirectoryHandle=e.sent;case 4:return e.next=6,window.saveDirectoryHandle.getFileHandle("".concat(u,".sm"),{create:!0});case 6:return n=e.sent,e.next=9,n.createWritable();case 9:return t=e.sent,e.next=12,t.write(JSON.stringify(d));case 12:return e.next=14,t.close();case 14:case"end":return e.stop()}}),e)})))},"choose folder and save"))};function ya(e,n,t,a,o,r){if(Gn(t,a))e({isOpen:!0,message:"module with this name already exists. would you like to update it?"});else{var c=It(o,n),i=c.modules,l=c.connections;window.containerSaveService.create({saveName:t,containerID:n,modules:i,connections:l}).then((function(e){e&&(window.flashNotification("green","module saved to spaceDB"),window.refreshSpaceDBModules())})),r()}}function Na(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return{isOpen:e,id:n,saveList:t,preOnClose:a,initName:o}}var xa=function(){var e=Object(a.useState)(Na(!1)),n=Object(i.a)(e,2),t=n[0],r=t.isOpen,c=t.id,l=t.saveList,u=t.preOnClose,s=t.initName,d=n[1],m=Object(re.c)((function(e){return e})),f=Object(a.useState)(""),p=Object(i.a)(f,2),v=p[0],b=p[1];window.openSpaceDBContainerSaveMenu=function(e,n,t){d(Na(!0,n,e,t,m.modules[n].name)),b(m.modules[n].name)};var w=function(){u(),d(Na(!1))},g=Object(a.useState)({isOpen:!1,message:""}),O=Object(i.a)(g,2),h=O[0],I=O[1],j=Object(a.useRef)(null),D=ha();return o.a.createElement(ca,{header:"save container module",isClosed:!r,onClose:w},o.a.createElement("input",{className:D.CenterMenuInput,value:v,placeholder:s,ref:j,onChange:function(e){b(e.target.value)},onKeyDown:function(e){switch(e.key){case"Enter":ya(I,c,v,l,m,w);break;case"Escape":w()}},autoFocus:!0}),o.a.createElement(tn,{onClick:function(){ya(I,c,v,l,m,w)}},"confirm"),h.isOpen?o.a.createElement(a.Fragment,null,o.a.createElement("div",{style:{fontSize:Ve.small}},h.message),o.a.createElement("div",{style:{display:"flex"}},o.a.createElement(tn,{style:{backgroundColor:Be},onClick:function(){j.current&&(j.current.value="",j.current.focus()),I({isOpen:!1,message:""})}},"no"),o.a.createElement(tn,{style:{backgroundColor:Pe},onClick:function(){var e=It(m,c),n=e.modules,t=e.connections;window.containerSaveService.update(v,{saveName:v,containerID:c,modules:n,connections:t}).then((function(e){e&&(window.flashNotification("green","module updated"),window.refreshSpaceDBModules())})),w()}},"yes"))):null)};function Sa(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,range:n,onChangeSubmit:t}}var Ma=function(){var e=Object(a.useState)(Sa(!1)),n=Object(i.a)(e,2),t=n[0],r=t.isOpen,c=t.range,l=t.onChangeSubmit,u=n[1];window.openAnalyzerRangeSetMenu=function(e,n){u(Sa(!0,e,n))};var s=function(){u(Sa(!1))},d=wa(),m=Object(a.useState)(c[0]),f=Object(i.a)(m,2),p=f[0],v=f[1],b=Object(a.useState)(c[1]),w=Object(i.a)(b,2),g=w[0],O=w[1];return o.a.createElement(ca,{isClosed:!r,header:"set analyzer range",onClose:s},o.a.createElement("div",{className:d.CMInputBounder,onKeyDown:function(e){"Escape"===e.key?s():"Enter"===e.key&&(l([p,g]),s())}},o.a.createElement("input",{className:d.CenterMenuInput,onChange:function(e){v(Number(e.target.value))},value:p,type:"number"}),o.a.createElement("input",{className:d.CenterMenuInput,onChange:function(e){O(Number(e.target.value))},value:g,type:"number"})),o.a.createElement(tn,{style:{fontSize:Ve.small,backgroundColor:Pe},onClick:function(){l([p,g]),s()}},"confirm"))},Ta=Object(l.a)({CMInputBounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},CenterMenuInput:{backgroundColor:ie,color:"white",height:"2vmin",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:Ve.small,width:"23vmin","&:hover":{cursor:"text"}},InputSubmit:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:ie,height:"2vmin",padding:"1vmin",margin:"1.5vmin 1.5vmin 1.5vmin 0.75vmin",borderRadius:"1vmin","&:hover":{cursor:"pointer"},fontSize:Ve.small},Error:{backgroundColor:je,width:"90%",color:"white",fontSize:Ve.small,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"1vmin",padding:"1vmin 0vmin",marginBottom:"1vmin"}});var ka=function(e){var n=e.isOpen,t=e.header,r=e.onSubmit,c=e.placeholder,l=e.onClose,u=Ta(),s=Object(a.useState)(""),d=Object(i.a)(s,2),m=d[0],f=d[1],p=Object(a.useState)(!1),v=Object(i.a)(p,2),b=v[0],w=v[1];function g(){m.length>0?(r(m),l(),f("")):w(!0)}return o.a.createElement(ca,{isClosed:!n,header:t,onClose:function(){l(),f("")}},o.a.createElement("div",{className:u.CMInputBounder},o.a.createElement("input",{className:u.CenterMenuInput,placeholder:c,value:m,onChange:function(e){f(e.target.value)},onKeyDown:function(e){switch(e.key){case"Enter":g();break;case"Escape":l()}},autoFocus:!0}),o.a.createElement(tn,{onClick:function(){g()}},"confirm"),b?o.a.createElement("div",{className:u.Error},"please enter a name"):null))};function Ra(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{isOpen:e,toRenameID:n}}var Aa=function(){var e,n=Object(a.useState)(Ra(!1)),t=Object(i.a)(n,2),r=t[0],c=r.isOpen,l=r.toRenameID,u=t[1];window.openModuleRenameMenu=function(e){u(Ra(!0,e))};var s=Object(re.c)((function(e){return e.modules})),d=Object(re.b)();return o.a.createElement(ka,{header:"rename module",isOpen:c,onSubmit:function(e){d(function(e,n){return{type:"RENAME_MODULE",id:e,newName:n}}(l,e))},placeholder:null===(e=s[l])||void 0===e?void 0:e.name,onClose:function(){u(Ra(!1))}})};function Pa(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0;return{isOpen:e,placeholder:n,containerControl:a,parentModID:t}}var Ba=function(){var e=Object(a.useState)(Pa(!1)),n=Object(i.a)(e,2),t=n[0],r=t.isOpen,c=t.placeholder,l=t.containerControl,u=t.parentModID,s=n[1];window.openControlRenameMenu=function(e,n,t){s(Pa(!0,e,n,t))};var d=Object(re.b)();return o.a.createElement(ka,{header:"rename control",isOpen:r,onSubmit:function(e){var n=l,t=n.modID,a=n.controlID,o=n.actualModID;d(function(e,n,t,a,o){return{type:"RENAME_CONTAINER_CONTROL",name:e,parentModID:n,modID:t,controlID:a,actualModID:o}}(e,u,t,a,o)),window.flashNotification("green","control passthrough renamed")},placeholder:c,onClose:function(){return s(Pa(!1))}})},Fa=Object(l.a)({LeftBar:{width:Je.leftBarWidth,backgroundColor:_e},LeftBarButton:{borderRadius:"0em",margin:"0em",backgroundColor:"transparent",borderColor:"transparent",borderWidth:"1px","&:hover":{borderColor:"transparent"}},RouterBounder:{alignItems:"center"},IconRouter:{width:Je.iconRouterWidth,height:Je.height,overflowY:"scroll",display:"grid",gridTemplateColumns:"repeat(3, auto)",gridAutoRows:"20vmin",gridAutoFlow:"row",placeItems:"center","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},SearchBar:{width:"80%",height:"1.5em",marginTop:"1.3em",marginBottom:".4em",fontSize:Ve.small,backgroundColor:We,color:Ue,textAlign:"center",borderStyle:"none",borderRadius:".2em","&:focus":{outline:"none"}},DrawerItem:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-evenly",borderRadius:"10px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},DrawerIcon:{backgroundColor:ie,borderColor:ie,borderStyle:"solid",width:Ge.item,height:Ge.item,borderRadius:"1.5vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",marginBottom:"1.5vmin","&:hover":{cursor:"pointer",borderColor:"white"}},DrawerItemText:{fontSize:Ve.small}});var La=function(e){var n=e.selectedGroup,t=e.setSG,a=Fa();return o.a.createElement(En,{className:a.LeftBar},to.filter((function(e){return window.usingElectron||e!==eo})).map((function(e,r){var c=e===n;return o.a.createElement(tn,{className:a.LeftBarButton,key:r,style:{color:c?we:"white"},onClick:function(){t(e)}},e)})))};var za=function(e){var n=e.fullName,t=e.shortName,a=e.moduleType,r=e.isFocussed,c=e.totNumModules,i=e.row,l=e.col,u=e.onClose,s=Fa(),d=Object(re.b)();function m(){window.addModule(Ct(0,c),t,window.fillContainerID,a,d,i,l),u()}return r&&(window.addSelectedSearchModule=m),o.a.createElement("div",{className:s.DrawerItem},o.a.createElement("div",{className:s.DrawerIcon,style:{backgroundColor:mt(a),borderColor:r?"white":ie},onFocus:function(e){e.preventDefault(),console.log("focussing 2")},onClick:m,draggable:!0,onDragStart:function(e){e.persist(),e.dataTransfer.setData("type","ADD_MODULE"),e.dataTransfer.setData("id",Ct(0,c)),e.dataTransfer.setData("moduleType",a),e.dataTransfer.setData("name",t)},onKeyDown:function(e){switch(e.key){case"Enter":m()}}}),o.a.createElement("div",{className:s.DrawerItemText},n))};var _a=function(e){var n=e.totNumModules,t=e.moduleData,r=e.row,c=e.col,l=e.onClose;return o.a.createElement(a.Fragment,null,t.map((function(e,t){var a=Object(i.a)(e,3),u=a[0],s=a[1],d=a[2];return o.a.createElement(za,{key:t,fullName:u,shortName:s,moduleType:d,totNumModules:n,row:r,col:c,onClose:l})})))},Wa=[["gain","gain","GAIN"],["filter","filter","AUTOFILTER"],["kompressor","komp","KOMPRESSOR"],["signal delay","delay","SIGNAL_DELAY"],["stereo panner","pan","STEREO_PANNER"],["distortion","dist","DISTORTION"]],Ua=[["file","file","MEDIA_ELEMENT"],["stream","stream","LINE_IN"],["oscillator","osc","OSCILLATOR"],["constant","const","CONSTANT"],["enveloped pad","env","ENVELOPED_TRIGGER"],["white noise","noise","WHITE_NOISE"]],Ha=[["container","cntnr",b],["output","out","OUTPUT"],["analyzer","analyzer","ANALYZER"]],Ga=Wa.concat(Ua).concat(Ha);var Ka=function(e){var n=e.moduleName,t=e.totNumberModules,a=e.onClose,r=e.row,c=e.col,i=e.isFocussed,l=Fa(),u=Object(re.b)();function s(){window.containerSaveService.get(n).then((function(e){var n=e.containerID,a=e.modules,o=e.connections;yt(u,a,o,t,d,window.fillContainerID,n,r,c)})),a()}i&&(window.addSelectedSearchModule=s);var d=Object(re.c)((function(e){return Object.keys(e.connections).length}));return o.a.createElement("div",{className:l.DrawerItem},o.a.createElement("div",{className:l.DrawerIcon,style:{backgroundColor:mt(b),borderColor:i?"white":ie},onClick:s,onContextMenu:function(e){e.preventDefault(),e.persist(),window.openSDBModuleContextMenu(e,n)}}),o.a.createElement("div",{className:l.DrawerItemText},n))};var Va=function(e){var n=e.spaceDBModules,t=e.totNumModules,r=e.onClose,c=e.row,i=e.col;return Object(a.useEffect)((function(){window.refreshSpaceDBModules()}),[]),o.a.createElement(a.Fragment,null,n.map((function(e,n){return o.a.createElement(Ka,{moduleName:e,key:n,totNumberModules:t,onClose:r,row:c,col:i})})))};var qa=function(e){var n=e.query,t=e.spaceDBModules,r=e.totNumModules,c=e.onClose,l=e.row,u=e.col,s=n.toUpperCase(),d=t.filter((function(e){return e.toUpperCase().slice(0,s.length)===s})),m=Ga.filter((function(e){return Object(i.a)(e,2)[0].toUpperCase().slice(0,s.length)===s}));return o.a.createElement(a.Fragment,null,d.map((function(e,n){return o.a.createElement(Ka,{key:n,moduleName:e,totNumberModules:r,onClose:c,row:l,col:u,isFocussed:0===n})})),m.map((function(e,n){var t=Object(i.a)(e,3),a=t[0],s=t[1],m=t[2];return o.a.createElement(za,{isFocussed:0===d.length&&0===n,key:n,fullName:a,shortName:s,moduleType:m,totNumModules:r,row:l,col:u,onClose:c})})))};var Ya,Qa=function(e){var n=e.selectedGroup,t=e.row,a=e.col,r=e.onClose,c=e.query,i=e.spaceDBModules,l=Object(re.c)((function(e){return Object.keys(e.modules).length})),u=Fa();return o.a.createElement("div",{className:u.IconRouter},o.a.createElement(_a,{totNumModules:l,moduleData:n===Xa?Wa:n===Za?Ua:n===$a?Ha:[],row:t,col:a,onClose:r}),n!==eo?null:o.a.createElement(Va,{spaceDBModules:i,totNumModules:l,onClose:r,row:t,col:a}),n!==no?null:o.a.createElement(qa,{query:c,spaceDBModules:i,totNumModules:l,onClose:r,row:t,col:a}))};var Ja=function(e){var n=e.selectedGroup,t=e.setSG,a=e.setQuery,r=e.searchRef,c=e.onClose,i=Fa();return n!==no&&(Ya=n),o.a.createElement("input",{className:i.SearchBar,ref:r,onChange:function(e){0===e.target.value.length?(t(Ya),window.addSelectedSearchModule=function(){}):(a(e.target.value),t(no))},onKeyDown:function(e){switch(e.key){case"Escape":c();break;case"Enter":window.addSelectedSearchModule()}},placeholder:"search"})},Xa="effects",Za="sources",$a="utility",eo="spaceDB",no="search",to=[Xa,Za,$a,eo];function ao(e,n,t){return{isOpen:e,row:n,col:t}}var oo=function(){var e=Object(a.useState)(ao(!1)),n=Object(i.a)(e,2),t=n[0],r=t.isOpen,c=t.row,l=t.col,d=n[1],m=Object(a.useRef)(null);window.openAddModuleMenu=function(e,n){d(ao(!0,e,n)),m.current&&m.current.focus()};var f=function(){d(ao(!1))},p=Object(a.useState)(Xa),v=Object(i.a)(p,2),b=v[0],w=v[1],g=Object(a.useState)(""),O=Object(i.a)(g,2),h=O[0],I=O[1],j=Object(a.useState)([]),D=Object(i.a)(j,2),C=D[0],E=D[1];window.refreshSpaceDBModules=function(){window.containerSaveService.find().then((function(e){E(e)}))};var y=Object(wn.b)({opacity:r?1:0,config:{tension:270}});Object(a.useEffect)((function(){window.usingElectron&&window.refreshSpaceDBModules()}),[]);var N=Fa();return o.a.createElement(ca,{header:"add module",onClose:f,bounderStyle:Object.assign({},y,{zIndex:r?s:u-1})},o.a.createElement(vn,null,o.a.createElement(En,{className:N.RouterBounder},o.a.createElement(Ja,{selectedGroup:b,setSG:w,setQuery:I,searchRef:m,onClose:f}),o.a.createElement(La,{selectedGroup:b,setSG:w})),o.a.createElement(Qa,{selectedGroup:b,row:c,col:l,onClose:f,query:h,spaceDBModules:C})))},ro=function(e,n){var t,a,o=n.id,r=n.name,c=n.moduleType,i=n.controlData,l=n.row,u=n.col,s=n.parentID,d=n.connectionInputs,m=n.connectionOutputs;switch(c){case b:return Object.assign({},e,(t={},Object(p.a)(t,o,{id:o,name:r,row:l,col:u,parentID:s,moduleType:c,controlData:i,connectionInputs:d,connectionOutputs:m,inputs:[],outputs:[],containerControls:[],toContainerControls:[],childModules:[],isBaseContainer:!1,isContainerInput:!1,isContainerOutput:!1}),Object(p.a)(t,s,Object(v.a)(Object(v.a)({},e[s]),{},{childModules:[].concat(Object(wt.a)(e[s].childModules),[o])})),t));default:return Object.assign({},e,(a={},Object(p.a)(a,o,{id:o,name:r,row:l,col:u,parentID:s,moduleType:c,controlData:i,connectionInputs:d,connectionOutputs:m,toContainerControls:[],isContainerInput:!1,isContainerOutput:!1,inputs:[],outputs:[]}),Object(p.a)(a,s,Object(v.a)(Object(v.a)({},e[s]),{},{childModules:[].concat(Object(wt.a)(e[s].childModules),[o])})),a))}},co=function(e,n){var t=n.id,a=n.newRow,o=n.newCol;return Object.assign({},e,Object(p.a)({},t,Object(v.a)(Object(v.a)({},e[t]),{},{row:a,col:o})))},io=function(e,n){var t=n.id,a=n.newName;return Object.assign({},e,Object(p.a)({},t,Object(v.a)(Object(v.a)({},e[t]),{},{name:a})))},lo=function(e,n){var t,a=n.id,o=e[a].parentID;return Object.assign({},e,(t={},Object(p.a)(t,a,Object(v.a)(Object(v.a)({},e[a]),{},{isContainerInput:!0})),Object(p.a)(t,o,Object(v.a)(Object(v.a)({},e[o]),{},{connectionInputs:[].concat(Object(wt.a)(e[o].connectionInputs),[a])})),t))},uo=function(e,n){var t,a=n.id,o=e[a].parentID;return Object.assign({},e,(t={},Object(p.a)(t,a,Object(v.a)(Object(v.a)({},e[a]),{},{isContainerInput:!1})),Object(p.a)(t,o,Object(v.a)(Object(v.a)({},e[o]),{},{connectionInputs:e[o].connectionInputs.filter((function(e){return e!==a}))})),t))},so=function(e,n){var t,a=n.id,o=e[a].parentID;return Object.assign({},e,(t={},Object(p.a)(t,a,Object(v.a)(Object(v.a)({},e[a]),{},{isContainerOutput:!0})),Object(p.a)(t,o,Object(v.a)(Object(v.a)({},e[o]),{},{connectionOutputs:[].concat(Object(wt.a)(e[o].connectionOutputs),[a])})),t))},mo=function(e,n){var t,a=n.id,o=e[a].parentID;return Object.assign({},e,(t={},Object(p.a)(t,a,Object(v.a)(Object(v.a)({},e[a]),{},{isContainerInput:!1})),Object(p.a)(t,o,Object(v.a)(Object(v.a)({},e[o]),{},{connectionOutputs:e[o].connectionOutputs.filter((function(e){return e!==a}))})),t))},fo=function(e,n){var t,a,o=n.modID,r=n.controlID,c=n.actualModID,i=n.name,l=e[o].parentID;return e[o].moduleType===b?Object.assign({},e,(t={},Object(p.a)(t,o,Object(v.a)(Object(v.a)({},e[o]),{},{containerControls:e[o].containerControls.map((function(e){return e.controlID!==r||e.actualModID!==c?e:Object(v.a)(Object(v.a)({},e),{},{markedToContainer:!0})}))})),Object(p.a)(t,l,Object(v.a)(Object(v.a)({},e[l]),{},{containerControls:[].concat(Object(wt.a)(e[l].containerControls),[{modID:o,controlID:r,actualModID:c,name:i,markedToContainer:!1}])})),t)):Object.assign({},e,(a={},Object(p.a)(a,c,Object(v.a)(Object(v.a)({},e[c]),{},{controlData:Object(v.a)(Object(v.a)({},e[c].controlData),{},Object(p.a)({},r,Object(v.a)(Object(v.a)({},e[c].controlData[r]),{},{markedToContainer:!0})))})),Object(p.a)(a,l,Object(v.a)(Object(v.a)({},e[l]),{},{containerControls:[].concat(Object(wt.a)(e[l].containerControls),[{modID:o,controlID:r,actualModID:c,name:i,markedToContainer:!1}])})),a))},po=function(e,n){var t,a,o=n.modID,r=n.controlID,c=n.actualModID,i=e[o].parentID;return e[o].moduleType===b?Object.assign({},e,(t={},Object(p.a)(t,o,Object(v.a)(Object(v.a)({},e[o]),{},{containerControls:e[o].containerControls.map((function(e){return e.controlID!==r||e.actualModID!==c?e:Object(v.a)(Object(v.a)({},e),{},{markedToContainer:!1})}))})),Object(p.a)(t,i,Object(v.a)(Object(v.a)({},e[i]),{},{containerControls:e[i].containerControls.filter((function(e){return e.modID!==o||e.controlID!==r||e.actualModID!==c}))})),t)):Object.assign({},e,(a={},Object(p.a)(a,c,Object(v.a)(Object(v.a)({},e[c]),{},{controlData:Object(v.a)(Object(v.a)({},e[c].controlData),{},Object(p.a)({},r,Object(v.a)(Object(v.a)({},e[c].controlData[r]),{},{markedToContainer:!1})))})),Object(p.a)(a,i,Object(v.a)(Object(v.a)({},e[i]),{},{containerControls:e[i].containerControls.filter((function(e){return e.modID!==o||e.controlID!==r||e.actualModID!==c}))})),a))},vo=function(e,n){var t=n.name,a=n.parentModID,o=(n.modID,n.controlID),r=n.actualModID,c=e[a];return Object.assign({},e,Object(p.a)({},a,Object(v.a)(Object(v.a)({},c),{},{containerControls:c.containerControls.map((function(e){return e.controlID!==o||e.actualModID!==r?e:Object(v.a)(Object(v.a)({},e),{},{name:t})}))})))},bo=function(e,n){var t=n.modID,a=n.controlID,o=n.newValue;return Object.assign({},e,Object(p.a)({},t,Object(v.a)(Object(v.a)({},e[t]),{},{controlData:Object(v.a)(Object(v.a)({},e[t].controlData),{},Object(p.a)({},a,Object(v.a)(Object(v.a)({},e[t].controlData[a]),{},{value:o})))})))},wo=function(e,n){var t=n.modID,a=n.controlID,o=n.newRange;return Object.assign({},e,Object(p.a)({},t,Object(v.a)(Object(v.a)({},e[t]),{},{controlData:Object(v.a)(Object(v.a)({},e[t].controlData),{},Object(p.a)({},a,Object(v.a)(Object(v.a)({},e[t].controlData[a]),{},{range:o,value:qn(e[t].controlData[a].value,o)})))})))},go={project:{id:"project",name:"project",row:0,col:0,moduleType:b,controlData:{open:{controlType:"BUTTON",paramID:"n/a"}},connectionInputs:[],connectionOutputs:[],inputs:[],outputs:[],parentID:null,childModules:[],isBaseContainer:!0,isContainerInput:!1,isContainerOutput:!1,containerControls:[]}},Oo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:go,n=arguments.length>1?arguments[1]:void 0;if(!n)return e;switch(n.type){case"ADD_MODULE":return ro(e,n);case"MOVE_MODULE":return co(e,n);case"RENAME_MODULE":return io(e,n);case"MARK_CONTAINER_INPUT":return lo(e,n);case"UNMARK_CONTAINER_INPUT":return uo(e,n);case"MARK_CONTAINER_OUTPUT":return so(e,n);case"UNMARK_CONTAINER_OUTPUT":return mo(e,n);case"MARK_CONTAINER_CONTROL":return fo(e,n);case"UNMARK_CONTAINER_CONTROL":return po(e,n);case"UPDATE_CONTROL_DATA":return bo(e,n);case"UPDATE_CONTROL_RANGE":return wo(e,n);case"RENAME_CONTAINER_CONTROL":return vo(e,n);default:return e}},ho=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"project",n=arguments.length>1?arguments[1]:void 0;if(!n)return e;switch(n.type){case"DOWN_1_BASE":case"CHANGE_BASE":return n.newID;default:return e}},Io=function(e,n,t){var a,o=t.fromID,r=t.toID,c=t.param,i=t.outputIndex,l=t.inputIndex,u=t.containerOutputChildID,s=t.containerInputChildID,d=Ct(0,Object.keys(n).length);return{newModules:Object.assign({},e,(a={},Object(p.a)(a,o,Object(v.a)(Object(v.a)({},e[o]),{},{outputs:[].concat(Object(wt.a)(e[o].outputs),[d])})),Object(p.a)(a,r,Object(v.a)(Object(v.a)({},e[r]),{},{inputs:[].concat(Object(wt.a)(e[r].inputs),[d])})),a)),newConnections:Object(v.a)(Object(v.a)({},n),{},Object(p.a)({},d,{connectionID:d,fromID:o,toID:r,param:c,outputIndex:i,inputIndex:l,actualOutputID:u,actualInputID:s}))}},jo=function(e,n,t){var a,o=t.connectionID,r=n[o],c=r.fromID,i=r.toID,l=r.actualOutputID,u=r.actualInputID;return{newModules:Object.assign({},e,(a={},Object(p.a)(a,c,Object(v.a)(Object(v.a)({},e[c]),{},{outputs:e[c].outputs.filter((function(e){return e!==o}))})),Object(p.a)(a,i,Object(v.a)(Object(v.a)({},e[i]),{},{inputs:e[i].inputs.filter((function(e){return e!==o}))})),a),l?Object(p.a)({},l,Object(v.a)(Object(v.a)({},e[l]),{},{outputs:e[l].outputs.filter((function(e){return e!==o}))})):{},u?Object(p.a)({},u,Object(v.a)(Object(v.a)({},e[u]),{},{inputs:e[c].outputs.filter((function(e){return e!==o}))})):{}),newConnections:pt(n,[o])}},Do=function(e,n,t){var a=t.id,o=e[a].parentID,r=e[a].moduleType===b?function(e,n){return[e].concat(Object(wt.a)(gt(e,n)))}(a,e):[a],c=e[a].moduleType===b?[].concat(Object(wt.a)(e[a].inputs),Object(wt.a)(e[a].outputs),Object(wt.a)(Ot(n,r))):[].concat(Object(wt.a)(e[a].inputs),Object(wt.a)(e[a].outputs)),i=pt(e,r);return{newModules:Object.assign({},Object.fromEntries(Object.entries(i).map((function(n){return[n[0],Object(v.a)(Object(v.a)({},n[1]),{},{inputs:n[1].inputs.filter((function(n){return!Gn(n,[].concat(Object(wt.a)(e[a].inputs),Object(wt.a)(e[a].outputs)))})),outputs:n[1].outputs.filter((function(n){return!Gn(n,[].concat(Object(wt.a)(e[a].inputs),Object(wt.a)(e[a].outputs)))}))})]}))),Object(p.a)({},o,Object(v.a)(Object(v.a)({},e[o]),{},{childModules:e[o].childModules.filter((function(e){return e!==a})),connectionInputs:e[o].connectionInputs.filter((function(e){return e!==a})),connectionOutputs:e[o].connectionOutputs.filter((function(e){return e!==a})),containerControls:e[o].containerControls.filter((function(e){return e.modID!==a}))}))),newConnections:pt(n,c)}},Co=function(e,n,t){var a,o=t.containerID,r=t.newModules,c=t.newConnections,i=t.row,l=t.col,u=t.parentID;return{newModules:Object.assign({},e,r,(a={},Object(p.a)(a,u,Object(v.a)(Object(v.a)({},e[u]),{},{childModules:[].concat(Object(wt.a)(e[u].childModules),[o])})),Object(p.a)(a,o,Object(v.a)(Object(v.a)({},r[o]),{},{parentID:u,row:i,col:l,isBaseContainer:!1})),a)),newConnections:Object.assign({},n,c)}},Eo=function(e,n,t){switch(t.type){case"ADD_CONNECTION":return Io(e,n,t);case"REMOVE_CONNECTION":return jo(e,n,t);case"REMOVE_MODULE":return Do(e,n,t);case"MERGE_CONTAINER":return Co(e,n,t);default:return{newModules:e,newConnections:n}}};function yo(){return{modules:Oo(),connections:{},baseContainerID:ho()}}var No=yo();function xo(e,n){return"ADD_CONNECTION"===n.type||"REMOVE_CONNECTION"===n.type||"REMOVE_MODULE"===n.type||"MERGE_CONTAINER"===n.type?Eo(e.modules,e.connections,n):{newModules:Oo(e.modules,n),newConnections:e.connections}}var So=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:No,n=arguments.length>1?arguments[1]:void 0;if("RESTORE_FROM_STATE"===n.type){var t=n.state;return Object.assign(t,t.connections?{}:{connections:{}})}var a=xo(e,n),o=a.newModules,r=a.newConnections;return{modules:o,connections:r,baseContainerID:ho(e.baseContainerID,n)}};function Mo(e,n){var t=yo();Bt(n,t),e(N(t)),window.flashNotification(He,"created blank project"),window.saveFileHandle=void 0,window.reRenderFileMenu()}var To=function(){var e=Object(a.useState)(!1),n=Object(i.a)(e,2),t=n[0],r=n[1];window.openConfirmBlankProjectMenu=function(){r(!0)};var c=function(){r(!1)},l=Object(re.c)((function(e){return e})),u=Object(re.b)();return o.a.createElement(ca,{isClosed:!t,onClose:c},o.a.createElement("div",{style:{fontSize:Ve.medium,textAlign:"center"}}," would you like to save the current project before closing? "),o.a.createElement(vn,null,o.a.createElement(tn,{onClick:function(){Mo(u,l.connections),c()}},"no"),o.a.createElement(tn,{onClick:Object(Ut.a)(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.saveFileHandle){e.next=5;break}return e.next=3,Ht(window.saveFileHandle,l);case 3:e.next=7;break;case 5:return e.next=7,qt(l);case 7:Mo(u,l.connections),c();case 9:case"end":return e.stop()}}),e)})))},"yes")))};var ko=function(){return o.a.createElement(a.Fragment,null,o.a.createElement(oo,null),o.a.createElement(ba,null),o.a.createElement(Aa,null),o.a.createElement(Ba,null),o.a.createElement(Oa,null),o.a.createElement(Ma,null),o.a.createElement(ja,null),o.a.createElement(xa,null),o.a.createElement(Ca,null),o.a.createElement(Ea,null),o.a.createElement(To,null))};function Ro(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{isOpen:e,color:n,text:t}}var Ao=Object(l.a)({Notification:{position:"absolute",top:"10vh",left:"50vw",transform:"translate(-50%, 0%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"2vmin",borderRadius:"4vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",zIndex:1e3,fontSize:Ve.small}});var Po=function(){var e=Object(a.useState)(Ro(!1)),n=Object(i.a)(e,2),t=n[0],r=t.isOpen,c=t.color,l=t.text,u=n[1],s=Object(a.useState)(!1),d=Object(i.a)(s,2),m=d[0],f=d[1],p=Ao();window.flashNotification=function(e,n){u(Ro(!0,e,n)),f(!0),window.setTimeout((function(){f(!1)}),2500),window.setTimeout((function(){u(Ro(!1))}),3200)};var v=Object(wn.b)({opacity:m?1:0});return o.a.createElement(a.Fragment,null,r?o.a.createElement(wn.a.div,{className:p.Notification,style:Object.assign({backgroundColor:c},v)},l):null)};window.fillContainerID="project",window.audioModules={},Q(),ae(),oe();var Bo=function(){var e=f(),n=Object(a.useState)(J(!1)),t=Object(i.a)(n,2),r=t[0],c=t[1];return window.openPointerLayer=function(e,n,t){c(J(!0,e,n,t))},o.a.createElement("div",{className:e.Bounder},o.a.createElement("div",{className:e.ModuleViewBounder},o.a.createElement(Rt,null)),o.a.createElement(ta,null),o.a.createElement(oa,null),r.isOpen?o.a.createElement(Z,{pointerLayerData:r,resetPointerLayerData:function(){c(J(!1))}}):null,o.a.createElement(ko,null),o.a.createElement(Po,null),o.a.createElement(Fn,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Fo=t(23),Lo=t(46),zo=Object(Fo.createStore)(So,Object(Lo.composeWithDevTools)());c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(re.a,{store:zo},o.a.createElement(Bo,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[47,1,2]]]);
//# sourceMappingURL=main.0e34819a.chunk.js.map