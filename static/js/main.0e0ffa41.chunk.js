(this["webpackJsonpspace-machine"]=this["webpackJsonpspace-machine"]||[]).push([[0],{24:function(e,t,n){e.exports=n.p+"static/media/settings.04e848f8.svg"},42:function(e,t,n){e.exports=n.p+"static/media/trash.9d2c8d42.svg"},44:function(e,t,n){e.exports=n(88)},49:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(23),c=n.n(r),i=(n(49),n(3)),l=n(6),u=Object(l.a)({Bounder:{backgroundImage:"url(https://media.wired.com/photos/5a593a7ff11e325008172bc2/master/pass/pulsar-831502910.jpg)",width:"100vw",height:"100vh",display:"flex",fontSize:"calc(20px + 2vmin)",color:"white",position:"absolute",top:"0px",left:"0px",userSelect:"none",zIndex:"-1",overflow:"hidden"},ModuleViewBounder:{minWidth:"60vw",height:"100vh",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",zIndex:0,overflow:"scroll","&::-webkit-scrollbar":{width:"0px"}}}),s="#282c34",d="#0000009e",m="#00347d",f="#001b40",p="black",v="#c0c0c038",b="#37538a",w="white",O="#007ab3",g="white",h="black",I="#cc00006e",D="#cc0000",j="red",C="#0000009e",E="white",y="#cc00006e",N="white",x="white",T="#85adad",M="#028174",S="#7D1551",k="#4C4141",R="#CA5F3C",A="#00347D",P="#00802da6",F="#cc00006e",_="black",L="#08101deb",z={width:"400px",toggleWidth:"2vmin",item:"9vmin"},B={iconGrid:"12vmin",gutterGrid:"6vmin",icon:"10vmin",bigIconWidth:"25vmin",bigIconHeight:"35vmin"},U={large:"calc(25px + 2.8vmin)",medium:"calc(20px + 2.4vmin)",small:"calc(12px + 1.2vmin)",xsmall:"calc(8px + 1vmin)",xxsmall:"calc(7px + .8vmin)"},H={size:"2.5vmin",borderRadius:"1.5vmin"},W={size:7,markerWidth:.5,markerHeight:1.3,rotRange:[-150,150],sensitivity:1,borderWidth:8},G={diameter:3},K=Object(l.a)({DrawerBounder:{width:"0px",height:"100vh",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",color:"white",position:"absolute",top:"0px",right:"0px",userSelect:"none",zIndex:10},Drawer:{backgroundColor:d,height:"100vh",width:z.width,display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"flex-start",position:"absolute",top:"0px",right:"0px"},DrawerHeader:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"inherit",overflowX:"scroll",overflowY:"hidden","&::-webkit-scrollbar":{height:"3px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},DrawerHeaderItem:{fontSize:U.medium,padding:"1vmin 1.5vmin",color:w,textDecoration:"none",whiteSpace:"nowrap","&:hover":{cursor:"pointer"}},ItemRouter:{width:z.width,height:"calc(100% - 60px)",display:"flex",flexFlow:"row wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",overflowY:"scroll","&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},DrawerItem:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-evenly",borderRadius:"10px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",margin:"3vmin"},DrawerIcon:{backgroundColor:s,borderColor:s,borderStyle:"solid",width:z.item,height:z.item,borderRadius:"1.5vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",marginBottom:"1.5vmin","&:hover":{cursor:"pointer",borderColor:"white"}},DrawerItemText:{fontSize:U.small},Toggle:{backgroundColor:m,width:z.toggleWidth,zIndex:10,height:"100%",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{cursor:"pointer"},position:"absolute",top:"0px",right:z.width},ToggleLine:{backgroundColor:f,borderRadius:"4px",width:"0.75vmin",height:"80px"}}),V=n(9);var q=function(e){var t=e.className,n=e.text,a=e.onClick,r={color:e.selectedRoute===n?O:w};return o.a.createElement("div",{className:t,onClick:a,style:r},n)},Y="CONTAINER",Q="VALUE",X="BUTTON",J=[["gain","gain","GAIN"],["filter","filter","AUTOFILTER"],["kompressor","komp","KOMPRESSOR"],["signal delay","delay","SIGNAL_DELAY"],["stereo panner","pan","STEREO_PANNER"],["distortion","dist","DISTORTION"]],Z=[["file","file","MEDIA_ELEMENT"],["stream","stream","LINE_IN"],["oscillator","osc","OSCILLATOR"],["constant","const","CONSTANT"],["enveloped pad","env","ENVELOPED_TRIGGER"]],$=[["container","cntnr",Y],["output","out","OUTPUT"],["analyzer","analyzer","ANALYZER"]];function ee(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function te(e,t,n){return ee(e,n)&&ee(t,n)}function ne(e,t){for(var n=[],a=e;a<t;a++)n.push(a);return n}function ae(e,t){return Math.min(t[1],Math.max(t[0],e))}function oe(e,t){return e>=t[0]&&e<=t[1]}function re(e,t,n){var a=(e-t[0])/(t[1]-t[0]),o=n[1]-n[0];return n[0]+a*o}var ce=function(e){switch(e){case"LINE_IN":case"OSCILLATOR":case"MEDIA_ELEMENT":case"CONSTANT":case"ENVELOPED_TRIGGER":return M;case"GAIN":case"AUTOFILTER":case"KOMPRESSOR":case"SIGNAL_DELAY":case"STEREO_PANNER":case"DISTORTION":return S;case Y:return k;case"OUTPUT":return R;case"ANALYZER":return A}};var ie=function(e,t){return"".concat(t).concat(e).concat(Math.floor(20480*Math.random()))};var le=function(e){var t=e.fullName,n=e.shortName,a=e.moduleType,r=e.totNumModules,c=K();return o.a.createElement("div",{className:c.DrawerItem},o.a.createElement("div",{className:c.DrawerIcon,style:{backgroundColor:ce(a)},draggable:!0,onDragStart:function(e){e.dataTransfer.setData("type","ADD_MODULE"),e.dataTransfer.setData("id",ie(0,r)),e.dataTransfer.setData("moduleType",a),e.dataTransfer.setData("name",n),window.setFillIsExpanded(!0)},onDragEnd:function(){window.setFillIsExpanded(!1)}}),o.a.createElement("div",{className:c.DrawerItemText},t))};var ue=function(e){var t=e.moduleData,n=e.totNumModules;return o.a.createElement(a.Fragment,null,t.map((function(e,t){return o.a.createElement(le,{fullName:e[0],shortName:e[1],moduleType:e[2],totNumModules:n,key:t})})))},se=n(5),de=function(e,t,n,a,o,r,c,i,l){return{type:"ADD_MODULE",moduleType:n,id:e,name:t,controlData:a,row:r,col:c,parentID:o,connectionInputs:i,connectionOutputs:l}},me=function(e,t,n){return{type:"MOVE_MODULE",id:e,newRow:t,newCol:n}},fe=function(e,t,n,a){return{type:"MARK_CONTAINER_CONTROL",modID:e,controlID:t,actualModID:n,name:a}},pe=function(e,t,n){return{type:"UNMARK_CONTAINER_CONTROL",modID:e,controlID:t,actualModID:n}},ve=function(e,t,n){return{type:"UPDATE_CONTROL_DATA",modID:e,controlID:t,newValue:n}},be=function(e,t,n){return{type:"UPDATE_CONTROL_RANGE",modID:e,controlID:t,newRange:n}},we=function(e,t,n,a,o,r,c){return{type:"ADD_CONNECTION",fromID:e,toID:t,param:n,outputIndex:a,inputIndex:o,containerOutputChildID:r,containerInputChildID:c}},Oe=function(e){return{type:"REMOVE_CONNECTION",connectionID:e}},ge=function(e,t,n,a,o,r){return{type:"MERGE_CONTAINER",containerID:e,newModules:t,newConnections:n,parentID:a,row:o,col:r}};function he(e){return{type:"RESTORE_FROM_STATE",state:e}}var Ie=n(2),De=n(1),je=new(0,window.AudioContext);var Ce=function(e){var t=je.createConstantSource();t.offset.value=e?e.value.value:0;var n={value:function(e){t.offset.value=Number(e)},kill:function(){t.stop()}};return t.start(),{audioNode:t,connectingParamIDs:["offset"],controlSetFuncs:n}},Ee=["lowpass","lowshelf","highpass","highshelf","allpass","bandpass","notch","peaking"],ye=["frequency","detune","Q","gain"];var Ne=function(e){var t=je.createBiquadFilter();e&&(t.type=e["set type"].value,t.frequency.value=e.frequency.value,t.detune.value=e.detune.value,t.Q.value=e.Q.value,t.gain.value=e.gain.value);var n={"set type":function(e){t.type=e},frequency:function(e){t.frequency.value=Number(e)},detune:function(e){t.detune.value=Number(e)},Q:function(e){t.Q.value=Number(e)},gain:function(e){t.gain.value=Number(e)}};return{audioNode:t,typeTypes:Ee,connectingParamIDs:ye,controlSetFuncs:n}};var xe=function(e){je.resume();var t=je.createGain();t.connect(je.destination),t.gain.value=e?e["master gain"].value:1;var n={"master gain":function(e){t.gain.value=Number(e)},resume:function(e){je.resume()},suspend:function(e){je.suspend()}};return{audioNode:t,connectingParamIDs:[],controlSetFuncs:n}};var Te=function(e){var t=je.createStereoPanner();e&&(t.pan.value=e.pan.value);var n={pan:function(e){t.pan.value=Number(e)}};return{audioNode:t,connectingParamIDs:["pan"],controlSetFuncs:n}};var Me=function(e){var t=je.createDelay(60);e&&(t.delayTime.value=e["delay time"].value);var n={"delay time":function(e){t.delayTime.value=Number(e)}};return{audioNode:t,connectingParamIDs:["delayTime"],controlSetFuncs:n}};var Se=function(e){var t=je.createDynamicsCompressor();e&&(t.threshold.value=e.threshold.value,t.knee.value=e.knee.value,t.ratio.value=e.ratio.value,t.attack.value=e.attack.value,t.release.value=e.release.value);var n={threshold:function(e){t.threshold.value=Number(e)},knee:function(e){t.knee.value=Number(e)},ratio:function(e){t.ratio.value=Number(e)},attack:function(e){t.attack.value=Number(e)},release:function(e){t.release.value=Number(e)}};return{audioNode:t,connectingParamIDs:["threshold","knee","ratio","attack","release"],controlSetFuncs:n}};var ke=function(e){var t=je.createGain();t.gain.value=e?e.gain.value:0;var n={gain:function(e){t.gain.value=Number(e)}};return{audioNode:t,connectingParamIDs:["gain"],controlSetFuncs:n}};var Re=["sine","square","triangle","sawtooth"];var Ae=function(e){var t=je.createOscillator();e&&(t.type=e["set type"].value,t.frequency.value=e.frequency.value,t.detune.value=e.detune.value);var n={"set type":function(e){t.type=e},frequency:function(e){t.frequency.value=Number(e)},detune:function(e){t.detune.value=Number(e)},kill:function(){t.stop()}};return t.start(),{audioNode:t,typeTypes:Re,connectingParamIDs:["frequency","detune"],controlSetFuncs:n}};var Pe=function(e){navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1,latency:0}}).then((function(t){var n=je.createMediaStreamSource(t),a=je.createChannelSplitter(2);n.connect(a);var o={audioNode:a,connectingParamIDs:[],controlSetFuncs:{mute:function(e){t.getAudioTracks()[0].enabled="true"===e}}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,o))}))};var Fe=function(e){return{connectingParamIDs:[],controlSetFuncs:{open:function(){window.fillContainerID=e,window.reRenderFillContainer()}}}};function _e(e){for(var t,n="number"===typeof e?e:50,a=new Float32Array(44100),o=Math.PI/180,r=0;r<44100;++r)t=2*r/44100-1,a[r]=(3+n)*t*20*o/(Math.PI+n*Math.abs(t));return a}var Le=function(e){var t=je.createWaveShaper();t.curve=_e(e?e.amount.value:0);var n={amount:function(e){t.curve=_e(Number(e))},oversample:function(e){var n=Math.floor(Number(e));t.oversample=n<2?"none":n<4?"2x":"4x"}};return{audioNode:t,connectingParamIDs:[],controlSetFuncs:n}};var ze=function(e){var t=je.createAnalyser();t.fftSize=1024;var n=t.frequencyBinCount;return{audioNode:t,controlSetFuncs:{"time graph":function(){}},connectingParamIDs:[],timeArray:new Float32Array(n),bufferLength:n}};var Be=function(e){var t=je.createConstantSource();t.offset.value=0;var n=.1,a=.2,o=1,r=.1;e&&(n=e.attack.value,a=e.decay.value,o=e.sustain.value,r=e.release.value);var c={trigger:function(e){var c=je.currentTime;"on"===e?(t.offset.linearRampToValueAtTime(1,c+n),t.offset.setTargetAtTime(o,c+n,a)):(t.offset.cancelAndHoldAtTime(c),t.offset.setTargetAtTime(0,c,r))},attack:function(e){n=Number(e)},decay:function(e){a=Number(e)},sustain:function(e){o=Number(e)},release:function(e){r=Number(e)}};return t.start(),{audioNode:t,connectingParamIDs:[],controlSetFuncs:c}};var Ue=function(e,t,n){switch(t){case"OSCILLATOR":var a=Ae(n);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,a));break;case"GAIN":var o=ke(n);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,o));break;case"OUTPUT":var r=xe(n);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,r));break;case"AUTOFILTER":var c=Ne(n);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,c));break;case"KOMPRESSOR":var i=Se(n);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,i));break;case"STEREO_PANNER":var l=Te(n);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,l));break;case"SIGNAL_DELAY":var u=Me(n);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,u));break;case"CONSTANT":var s=Ce(n);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,s));break;case"MEDIA_ELEMENT":window.addAudioTag(e),window.reRenderAudioTags();break;case"LINE_IN":Pe(e);break;case Y:var d=Fe(e);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,d));break;case"DISTORTION":var m=Le(n);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,m));break;case"ANALYZER":var f=ze(n);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,f));break;case"ENVELOPED_TRIGGER":var p=Be(n);window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,p))}};function He(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;0===n.length?e.audioNode.connect(t.audioNode,a,o):t.audioNode[n]?e.audioNode.connect(t.audioNode[n],a):alert("param does not exist")}function We(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0;0===n.length?"number"===typeof a?e.audioNode.disconnect(t.audioNode,a):e.audioNode.disconnect(t.audioNode):t.audioNode[n]?"number"===typeof a?e.audioNode.disconnect(t.audioNode[n],a):e.audioNode.disconnect(t.audioNode[n]):alert("param does not exist")}var Ge=function(e,t){var n=t.modules,a=t.connections;Object.keys(e).forEach((function(t){var n=e[t],a=n.fromID,o=n.toID,r=n.param,c=n.outputIndex,i=n.actualOutputID,l=n.actualInputID;window.audioModules[i||a]&&window.audioModules[l||o]&&We(window.audioModules[i||a],window.audioModules[l||o],r,c)})),window.numberRestores++,window.audioModules={},window.audioTags={},Object.keys(n).forEach((function(e){var t=n[e],a=t.moduleType,o=t.controlData;Ue(e,a,o)})),a&&Object.keys(a).forEach((function(e){var t=a[e],o=t.fromID,r=t.toID,c=t.param,i=t.outputIndex,l=t.inputIndex,u=t.actualOutputID,s=t.actualInputID,d=n[s||r].moduleType,m=n[u||o].moduleType;"MEDIA_ELEMENT"===d||"MEDIA_ELEMENT"===m||"LINE_IN"===d||"LINE_IN"===m?function e(t,n,a,o,r,c,i,l){t>10?alert("restore failed"):window.setTimeout((function(){window.audioModules[i||n]&&window.audioModules[l||a]?He(window.audioModules[i||n],window.audioModules[l||a],o,r,c):e(t+1,n,a,o,r,c,i,l)}),500)}(0,o,r,c,i,l,u,s):He(window.audioModules[u||o],window.audioModules[s||r],c,i,l)}))},Ke={backgroundColor:"transparent"};var Ve,qe=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(se.b)(),l=Object(se.c)((function(e){return e.connections}));return Object(a.useEffect)((function(){window.projectSaveService.find().then((function(e){r(e)}))}),[]),o.a.createElement("div",null,o.a.createElement(Ut,{style:Ke,onClick:function(){window.openSpaceDBProjectSaveMenu(n,(function(){window.setTimeout((function(){window.projectSaveService.find().then((function(e){r(e)}))}),1e3)}))}},"save"),o.a.createElement("div",null,n.map((function(e){return o.a.createElement("div",{style:{display:"flex",flexDirection:"row"},key:e},o.a.createElement(Ut,{style:Ke,onClick:function(){window.projectSaveService.get(e).then((function(e){Ge(l,e),c(he(e))}))}},e),o.a.createElement(Ut,{style:{backgroundColor:I},onClick:function(){window.openConfirmDeleteMenu(e,(function(){window.setTimeout((function(){window.projectSaveService.find().then((function(e){r(e)}))}),1e3)}))}},"delete"))}))))};window.usingElectron&&(Ve=window.require("fs"));var Ye=function(){var e=Object(se.c)((function(e){return e})),t=Object(a.useRef)(null),n=Object(se.b)();return Object(a.useEffect)((function(){window.setTimeout((function(){t.current&&(t.current.webkitdirectory=!0)}),50)}),[]),o.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"}},o.a.createElement("label",{htmlFor:"chooseFile"},o.a.createElement(Ut,null,"open file")),o.a.createElement("input",{style:{width:0,height:0,opacity:0},id:"chooseFile",type:"file",onChange:function(t){var a=t.target.files[0];if(a){var o=a.path;Ve.readFile(o,(function(t,a){if(t)throw t;var o=JSON.parse(a);Ge(e.connections,o),n(he(o))}))}}}),o.a.createElement(Ut,{onClick:function(){window.openFileSaveMenu()}},"save"))};var Qe=function(e){var t=e.name,n=e.totNumModules,a=K();return o.a.createElement("div",{className:a.DrawerItem},o.a.createElement("div",{className:a.DrawerIcon,style:{backgroundColor:ce(Y)},draggable:!0,onDragStart:function(e){e.dataTransfer.setData("type","CONTAINER_RESTORE"),e.dataTransfer.setData("name",t),e.dataTransfer.setData("id",ie(0,n)),window.setFillIsExpanded(!0)},onDragEnd:function(){window.setFillIsExpanded(!1)}}),o.a.createElement("div",{className:a.DrawerItemText},t))};var Xe=function(e){var t=e.totNumModules,n=Object(a.useState)([]),r=Object(i.a)(n,2),c=r[0],l=r[1];Object(a.useEffect)((function(){window.containerSaveService.find().then((function(e){l(e)}))}),[]);var u=Object(se.c)((function(e){return e})),s=K();return o.a.createElement("div",{className:s.ItemRouter,style:{width:"100%"},onDragOver:function(e){return e.preventDefault()},onDrop:function(e){var t=e.dataTransfer.getData("id");t&&u.modules[t]&&(u.modules[t].moduleType===Y&&window.openSpaceDBContainerSaveMenu(c,t,(function(){window.setTimeout((function(){window.containerSaveService.find().then((function(e){l(e)}))}),500)})))}},c.map((function(e,n){return o.a.createElement(Qe,{name:e,totNumModules:t,key:e+n})})))},Je=z.width;var Ze=function(){var e=K(),t=Object(a.useState)(!0),n=Object(i.a)(t,2),r=n[0],c=n[1],l=Object(a.useState)(Je),u=Object(i.a)(l,2),s=u[0],d=u[1],m=Object(V.b)({transform:r?"translate(0px, 0px)":"translate(".concat(s,"px, 0px)"),config:{tension:220,clamp:!0}}),f=Object(a.useState)("sources"),p=Object(i.a)(f,2),v=p[0],b=p[1],w=Object(a.useRef)(null),O=Object(a.useRef)(null),g=Object(a.useRef)(null),h=Object(a.useRef)(null),I=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),D=!1,j=Object(a.useState)({}),C=Object(i.a)(j,2)[1],E=Object(se.c)((function(e){return Object.keys(e.modules).length}));return Object(a.useEffect)((function(){window.addEventListener("resize",(function(){window.setTimeout((function(){C({})}),500)}))}),[]),o.a.createElement(V.a.div,{className:e.DrawerBounder,style:m,onPointerDown:function(e){return e.stopPropagation()}},o.a.createElement("div",{className:e.Toggle,ref:O,onPointerDown:function(e){var t;r&&e.shiftKey?(D=!0,null===(t=O.current)||void 0===t||t.setPointerCapture(e.pointerId)):c(!r)},onPointerMove:function(e){D&&(Je="".concat(ae(I-e.clientX,[150,700]),"px"),w.current&&(w.current.style.width=Je),g.current&&(g.current.style.width=Je),h.current&&(h.current.style.width=Je),O.current&&(O.current.style.right=Je))},onPointerUp:function(e){var t;D&&(D=!1,d(Je),null===(t=O.current)||void 0===t||t.releasePointerCapture(e.pointerId))}},o.a.createElement("div",{className:e.ToggleLine,onClick:function(){c(!r)}})),o.a.createElement("div",{className:e.Drawer,ref:w},o.a.createElement("div",{className:e.DrawerHeader,ref:g,onWheel:function(e){g&&g.current&&(g.current.scrollLeft+=e.deltaY)}},o.a.createElement(q,{className:e.DrawerHeaderItem,text:"sources",onClick:function(){b("sources")},selectedRoute:v}),o.a.createElement(q,{className:e.DrawerHeaderItem,text:"effects",onClick:function(){b("effects")},selectedRoute:v}),o.a.createElement(q,{className:e.DrawerHeaderItem,text:"utility",onClick:function(){b("utility")},selectedRoute:v}),o.a.createElement(q,{className:e.DrawerHeaderItem,text:"spaceDB modules",onClick:function(){b("spaceDB modules")},selectedRoute:v}),o.a.createElement(q,{className:e.DrawerHeaderItem,text:"spaceDB projects",onClick:function(){b("spaceDB projects")},selectedRoute:v}),window.usingElectron?o.a.createElement(q,{className:e.DrawerHeaderItem,text:"file",onClick:function(){b("file")},selectedRoute:v}):null),o.a.createElement("div",{className:e.ItemRouter,ref:h},"sources"===v?o.a.createElement(ue,{moduleData:Z,totNumModules:E}):"effects"===v?o.a.createElement(ue,{moduleData:J,totNumModules:E}):"utility"===v?o.a.createElement(ue,{moduleData:$,totNumModules:E}):"spaceDB modules"===v?o.a.createElement(Xe,{totNumModules:E}):"spaceDB projects"===v?o.a.createElement(qe,null):"file"===v?o.a.createElement(Ye,null):null)))},$e=Object(l.a)({FillBounder:{backgroundColor:v,display:"flex",flexDirection:"column",margin:"5vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderRadius:"2vmin"},FillHeaderBounder:{display:"flex",justifyContent:"space-between"},FillHeader:{borderColor:"white",borderStyle:"none none none none",padding:"1vmin",marginLeft:"2vmin","&:hover":{cursor:"pointer"}},Fill:{display:"grid",minWidth:B.iconGrid,minHeight:B.iconGrid,padding:"4vmin",zIndex:1,rowGap:B.gutterGrid,columnGap:B.gutterGrid},ArcherContainer:{width:"100%",height:"100%",zIndex:0,display:"grid"},Icon:{backgroundColor:b,borderRadius:"1.5vmin",borderStyle:"none",borderColor:"white",whiteSpace:"wrap",fontSize:U.medium,padding:"1vmin",display:"flex",flexFlow:"column nowrap",alignItems:"flex-end",justifyContent:"space-between",overflow:"hidden",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)","&:hover":{cursor:"pointer",borderStyle:"solid"},zIndex:2},IconControlContainer:{width:B.bigIconWidth,maxHeight:B.bigIconHeight,justifySelf:"flex-end",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",overflowY:"scroll",overflowX:"hidden","&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},ArcherElement:{zIndex:1,display:"grid",backgroundColor:"transparent",gridTemplateRows:"10px auto 10px",gridTemplateColumns:"10px auto 10px",padding:"1vmin"},IconName:{fontSize:U.small,"&:hover":{cursor:"pointer"}},IconConnector:{backgroundColor:j,width:H.size,height:H.size,borderRadius:H.borderRadius,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderStyle:"solid",borderColor:"transparent","&:hover":{cursor:"pointer",borderColor:"white"},justifySelf:"flex-start",alignSelf:"flex-end",flexShrink:0}}),et=n(19),tt=Object(l.a)({MenuHeader:{fontSize:U.medium,borderStyle:"none none solid none",margin:"1vmin",width:"90%"},ControlBounder:{display:"flex",flexFlow:"row wrap",alignItems:"center",fontSize:U.small,justifyContent:"center",margin:"0vmin 1vmin"},ControlMenu:{display:"flex",flexFlow:"row wrap",width:"100%",alignItems:"center",justifyContent:"center"}}),nt=Object(l.a)({ControlTypeSelect:{minWidth:"9vmin",maxWidth:"5em",margin:"1vmin",fontSize:U.small,backgroundColor:C,color:E,textAlign:"center"},ControlInput:{minWidth:"9vmin",maxWidth:"5em",margin:"1vmin",fontSize:U.small},ControlMenu:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center"},Pad:{width:"20vmin",height:"15vmin",borderRadius:"2vmin",backgroundColor:"black"}});var at=function(e){var t=e.actualModID,n=e.controlID,a=e.setFunc,r=e.reRenderIcon,c=e.modName,i=e.label,l=nt();return o.a.createElement("div",{className:l.ControlMenu},o.a.createElement("label",{style:{minWidth:"50%"},htmlFor:t+n},o.a.createElement(Ut,{style:{borderColor:I}},i||(c?"".concat(c," - ").concat(n):n))),o.a.createElement("input",{style:{width:0,height:0,opacity:0},type:"file",id:t+n,onChange:function(e){var n=e.target.files[0];a(URL.createObjectURL(n)),window.audioTags[t].srcName=n.name,window.reRenderAudioTags(),r()}}),o.a.createElement("p",{style:{fontSize:U.xsmall,textAlign:"center",whiteSpace:"normal",justifyContent:"center",width:"100%",overflowWrap:"break-word",wordWrap:"break-word",hyphens:"auto"}},window.audioTags[t].srcName))};var ot=function(e){var t=e.setFunc,n=e.controlID,a=e.actualModID,r=e.modName,c=e.label,i=nt(),l=window.audioModules[a],u=l.audioNode,s=Object(se.b)(),d=Object(se.c)((function(e){return e.modules[a].controlData[n].value}));return o.a.createElement(Ln,{style:{justifyContent:"center",margin:"1vmin 0vmin"}},o.a.createElement("label",{htmlFor:"type"},c?"set type - ".concat(c):r?"set type - ".concat(r):"set type"),o.a.createElement("select",{className:i.ControlTypeSelect,name:"type",id:"type",onChange:function(e){t(e.target.value),s(ve(a,n,e.target.value))},value:d||u.type},l.typeTypes.map((function(e){return o.a.createElement("option",{value:e,key:a+e},e)}))))};function rt(e,t){return(e-t[0])/(t[1]-t[0])*(W.rotRange[1]-W.rotRange[0])+W.rotRange[0]}function ct(e){var t=(Math.floor(10*e)/10).toString();return"."===t.slice(t.length-2,t.length-1)?t:t+".0"}var it=function(e){var t=e.controlID,n=e.setFunc,r=e.actualModID,c=e.displayModName,l=e.label,u=Object(se.c)((function(e){return[e.modules[r].controlData[t].value,e.modules[r].controlData[t].range]})),s=Object(i.a)(u,2),d=s[0],m=s[1],f=Object(a.useState)(ct(d)),p=Object(i.a)(f,2),v=p[0],b=p[1],w=Object(se.b)();return o.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},o.a.createElement(an,{initValue:d,range:m,inputVal:v,setInputVal:b,onEveryChange:function(e){n(e.toString())},onChange:function(e){n(e.toString()),w(ve(r,t,e))},onSettingsClick:function(){window.openKnobRangeSetMenu(r,t,(function(e){n(ae(d,e).toString()),b(ct(ae(d,e))),w(be(r,t,e))}))}}),o.a.createElement("div",null,l||(c?"".concat(c," - ").concat(t):t)))};var lt=function(e){var t=e.setFunc,n=e.controlID,a=e.modName,r=e.label;return o.a.createElement(Ut,{style:{borderColor:I,width:"50%"},onClick:function(){t("")}},r||(a?"".concat(a," - ").concat(n):n))};var ut=function(e){var t=e.controlID,n=e.setFunc,a=e.actualModID,r=e.modName,c=e.label,i=Object(se.c)((function(e){return e.modules[a].controlData[t].value}));return o.a.createElement(Zt,{text:c||(r?"".concat(r," - ").concat(t):t),initState:i,onSwitch:function(e){n(e?"true":"false")}})},st=n(39),dt=n.n(st);var mt=function(e){var t=e.modID,n=window.audioModules[t],r=Object(se.c)((function(e){return e.modules[t].controlData["time graph"].range})),c=200-re(0,r,[0,200]),l=Object(a.useState)(0),u=Object(i.a)(l,2),s=u[0],d=u[1],m=Object(se.b)();return o.a.createElement(zn,{style:{justifyContent:"center"}},o.a.createElement(dt.a,{style:{width:B.bigIconWidth,margin:".5vmin 0vmin"},setup:function(e,t){e.createCanvas(t.clientWidth,200).parent(t),e.textAlign(e.CENTER,e.CENTER),e.fill(100),d(t.clientWidth)},draw:function(e){n.audioNode.getFloatTimeDomainData(n.timeArray);var t=s/n.bufferLength;e.background(0);var a=0,o=200-re(n.timeArray[0],r,[0,200]);e.stroke(A),e.strokeWeight(6);for(var i=0;i<n.bufferLength-1;i++){var l=(i+1)*t,u=200-re(n.timeArray[i+1],r,[0,200]);e.line(a,o,l,u),a=l,o=u}var d=s/20;e.stroke(100),e.strokeWeight(1),e.line(0,c,d,c),e.text("0",1.5*d,c)}}),o.a.createElement(Ut,{style:{width:"10em"},onClick:function(){window.openAnalyzerRangeSetMenu(r,(function(e){m(be(t,"time graph",e))}))}},"change range"))};var ft=function(e){var t=e.setFunc,n=nt();return o.a.createElement("div",{className:n.Pad,onPointerDown:function(e){e.preventDefault(),t("on")},onPointerCancel:function(e){e.preventDefault(),t("off")},onPointerUp:function(e){e.preventDefault(),t("off")}})};var pt=function(e){var t=e.audioModule,n=e.selectedModule,a=e.reRenderIcon,r=tt();return o.a.createElement("div",{className:r.ControlMenu},Object.keys(n.controlData).map((function(e,c){var i=n.controlData[e].controlType,l=t.controlSetFuncs[e];return o.a.createElement("div",{className:r.ControlBounder,key:n.id+e+c},i===Q?o.a.createElement(it,{controlID:e,setFunc:l,actualModID:n.id}):i===X?o.a.createElement(lt,{setFunc:l,controlID:e}):"TYPE"===i?o.a.createElement(ot,{setFunc:l,controlID:e,actualModID:n.id}):"FILE"===i?o.a.createElement(at,{controlID:e,setFunc:l,reRenderIcon:a,actualModID:n.id}):"SWITCH"===i?o.a.createElement(ut,{controlID:e,setFunc:l,actualModID:n.id}):"GRAPH"===i?o.a.createElement(mt,{modID:n.id}):"PAD"===i?o.a.createElement(ft,{setFunc:l}):null)})))};var vt=function(e){var t=e.selectedModule,n=Object(a.useState)(!1),r=Object(i.a)(n,2),c=r[0],l=r[1],u=Object(se.b)(),s=Object(se.c)((function(e){return e.modules}));return o.a.createElement(a.Fragment,null,o.a.createElement(Ut,{style:{fontSize:U.xsmall,marginTop:"2vmin"},onClick:function(){l(!c)}},"mark container controls"),o.a.createElement(zn,null,c&&t.moduleType===Y?t.containerControls.map((function(e,n){var a,r=e.modID,c=e.controlID,i=e.actualModID,l=e.name,d=e.markedToContainer,m=s[r].name,f=!!d;return f&&(a=s[t.parentID].containerControls.filter((function(e){return e.controlID===c&&e.actualModID===i}))[0]),o.a.createElement(Ln,null,o.a.createElement(Zt,{initState:f,text:l||"".concat(m," - ").concat(c),style:{fontSize:U.xsmall,padding:"1vmin"},key:r+n,onSwitch:function(e){u(e?fe(t.id,c,i):pe(t.id,c,i))}}),f?o.a.createElement(Ut,{style:{fontSize:U.small},onClick:function(){window.openControlRenameMenu(c,t.parentID,a)}},"edit"):null)})):null,c&&t.moduleType!==Y?Object.keys(t.controlData).map((function(e,n){var a,r=!!t.controlData[e].markedToContainer;return r&&(a=s[t.parentID].containerControls.filter((function(n){return n.controlID===e&&n.actualModID===t.id}))[0]),o.a.createElement(Ln,null,o.a.createElement(Zt,{initState:r,text:e,style:{fontSize:U.xsmall,padding:"1vmin"},key:e+n,onSwitch:function(n){u(n?fe(t.id,e,t.id):pe(t.id,e,t.id))}}),r?o.a.createElement(Ut,{style:{fontSize:U.small},onClick:function(){window.openControlRenameMenu(e,t.parentID,a)}},"edit"):null)})):null))},bt={fontSize:U.xsmall,padding:"1vmin"};var wt=function(e){var t=e.baseContainerID,n=e.selectedModule,r=Object(se.b)();return n&&window.fillContainerID!==t?o.a.createElement(a.Fragment,null,0===Object.keys(window.audioModules[n.id]).length?null:o.a.createElement(vt,{selectedModule:n}),0===n.connectionInputs.length?null:o.a.createElement(Zt,{style:bt,key:n.id+"inputSwitch",text:"mark as container input",initState:n.isContainerInput,onSwitch:function(e){r(e?{type:"MARK_CONTAINER_INPUT",id:n.id}:function(e){return{type:"UNMARK_CONTAINER_INPUT",id:e}}(n.id))}}),0===n.connectionOutputs.length?null:o.a.createElement(Zt,{style:bt,key:n.id+"outputSwitch",text:"mark as container output",initState:n.isContainerOutput,onSwitch:function(e){r(e?{type:"MARK_CONTAINER_OUTPUT",id:n.id}:function(e){return{type:"UNMARK_CONTAINER_OUTPUT",id:e}}(n.id))}})):null};var Ot=function(e){var t=e.selectedModule,n=e.reRenderIcon,a=tt(),r=Object(se.c)((function(e){return e.modules}));return o.a.createElement("div",{className:a.ControlMenu},t.containerControls.map((function(e,t){var c=e.modID,i=e.controlID,l=e.actualModID,u=e.name,s=window.audioModules[l],d=r[l].controlData[i].controlType,m=s.controlSetFuncs[i],f=r[c].name;return o.a.createElement("div",{className:a.ControlBounder,key:c+i+t},d===Q?o.a.createElement(it,{controlID:i,setFunc:m,actualModID:l,displayModName:f,label:u}):d===X?o.a.createElement(lt,{setFunc:m,controlID:i,modName:f,label:u}):"TYPE"===d?o.a.createElement(ot,{setFunc:m,controlID:i,actualModID:l,modName:f,label:u}):"FILE"===d?o.a.createElement(at,{controlID:i,setFunc:m,reRenderIcon:n,modName:f,actualModID:l,label:u}):"SWITCH"===d?o.a.createElement(ut,{controlID:i,setFunc:m,actualModID:l,modName:f,label:u}):"GRAPH"===d?o.a.createElement(mt,{modID:l}):"PAD"===d?o.a.createElement(ft,{setFunc:m}):null)})))},gt=Object(l.a)({DropSquare:{width:B.iconGrid,height:B.iconGrid,borderStyle:"solid",borderRadius:"10px",zIndex:1}});function ht(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){return!ee(e[0],t)})))}function It(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){return ee(e[0],t)})))}function Dt(e,t){return e.length===t.length?Object.fromEntries(e.map((function(e,n){return[e,t[n]]}))):{}}var jt=n(7);function Ct(e,t){var n=t[e].childModules,a=[];for(var o in n)t[n[o]].moduleType===Y&&(a=[].concat(Object(jt.a)(a),Object(jt.a)(Ct(n[o],t))));return[].concat(Object(jt.a)(n),Object(jt.a)(a))}function Et(e,t){var n=Object.keys(e),a=[];for(var o in n){var r=e[n[o]],c=r.fromID,i=r.toID,l=r.actualOutputID,u=r.actualInputID;te(l||c,u||i,t)&&(a=[].concat(Object(jt.a)(a),[n[o]]))}return a}function yt(e,t){return It(e,Et(e,t))}function Nt(e,t){var n=[t].concat(Object(jt.a)(Ct(t,e.modules)));return{modules:It(e.modules,n),connections:yt(e.connections,n)}}var xt=function(e,t){Object.keys(e).forEach((function(t){var n=e[t],a=n.moduleType,o=n.controlData;Ue(t,a,o)})),t&&Object.keys(t).forEach((function(n){var a=t[n],o=a.fromID,r=a.toID,c=a.param,i=a.outputIndex,l=a.inputIndex,u=a.actualOutputID,s=a.actualInputID,d=e[s||r].moduleType,m=e[u||o].moduleType;"MEDIA_ELEMENT"===d||"MEDIA_ELEMENT"===m||"LINE_IN"===d||"LINE_IN"===m?window.setTimeout((function(){He(window.audioModules[u||o],window.audioModules[s||r],c,i,l)}),200):He(window.audioModules[u||o],window.audioModules[s||r],c,i,l)}))};function Tt(e,t,n,a){var o=Object.keys(e),r=Object.keys(t),c=Dt(o,o.map((function(e,t){return ie(t,n)}))),i=Dt(r,r.map((function(e,t){return ie(t,a)}))),l=Dt(Object.values(c),o.map((function(t){if(e[t].moduleType===Y){var n=e[t];return Object(De.a)(Object(De.a)({},n),{},{id:c[t],inputs:n.inputs.filter((function(e){return ee(e,r)})).map((function(e){return i[e]})),outputs:n.outputs.filter((function(e){return ee(e,r)})).map((function(e){return i[e]})),containerControls:n.containerControls.map((function(e){return Object(De.a)(Object(De.a)({},e),{},{modID:c[e.modID],actualModID:c[e.actualModID]})})),childModules:n.childModules.map((function(e){return c[e]})),parentID:e[t].parentID?c[e[t].parentID]:null,connectionOutputs:e[t].connectionOutputs.map((function(e){return c[e]})),connectionInputs:e[t].connectionInputs.map((function(e){return c[e]}))})}return Object(De.a)(Object(De.a)({},e[t]),{},{id:c[t],inputs:e[t].inputs.filter((function(e){return ee(e,r)})).map((function(e){return i[e]})),outputs:e[t].outputs.filter((function(e){return ee(e,r)})).map((function(e){return i[e]})),parentID:c[e[t].parentID]})}))),u=Dt(Object.values(i),r.map((function(e){var n=t[e];return Object(De.a)(Object(De.a)({},n),{},{fromID:c[n.fromID],toID:c[n.toID],actualOutputID:n.actualOutputID?c[n.actualOutputID]:void 0,actualInputID:n.actualInputID?c[n.actualInputID]:void 0})})));return{modIDConverter:c,newModules:l,newConnections:u}}function Mt(e,t,n,a,o,r,c,i,l){var u=Tt(t,n,a,o),s=u.modIDConverter,d=u.newModules,m=u.newConnections;xt(d,m),e(ge(s[c],d,m,r,i,l))}var St=function(e,t,n,a,o){var r=ie(0,Object.keys(t.modules).length),c=t.modules[n],i=c.name,l=c.moduleType,u=c.controlData,s=c.parentID,d=c.connectionInputs,m=c.connectionOutputs;Ue(r,l,u),e(de(r,i,l,u,s,a,o,d,m))};function kt(e,t,n,a,o,r){var c=e.dataTransfer.getData("id"),i=n.modules[window.fillContainerID].childModules,l=n.modules[c],u=function(e,t,n,a){for(var o=0;o<n.length;o++){var r=a[n[o]];if(r.row===e&&r.col===t)return r.id}return!1}(a,o,i,n.modules);if(l)if(u){var s=e.dataTransfer.getData("fromRow"),d=e.dataTransfer.getData("fromCol");r(!1),window.setFillIsExpanded(!1),t(me(c,a,o)),t(me(u,Number(s),Number(d))),window.setTimeout(window.refreshArcherContainer,1)}else{var m=e.dataTransfer.getData("type");switch(r(!1),window.setFillIsExpanded(!1),m){case Rt:t(me(c,a,o));break;case At:n.modules[c].moduleType===Y?function(e,t,n,a,o,r){var c=Nt(t,a);Mt(e,c.modules,c.connections,Object.keys(t.modules).length,Object.keys(t.connections).length,n,a,o,r)}(t,n,window.fillContainerID,c,a,o):St(t,n,c,a,o)}window.setTimeout(window.refreshArcherContainer,1)}else if(!u){var f=e.dataTransfer.getData("type"),p=e.dataTransfer.getData("name");switch(f){case"ADD_MODULE":var v=e.dataTransfer.getData("moduleType");window.addModule(c,p,window.fillContainerID,v,t,a,o);break;case"CONTAINER_RESTORE":var b=Object.keys(n.modules).length,w=Object.keys(n.connections).length;window.containerSaveService.get(p).then((function(e){var n=e.containerID,r=e.modules,c=e.connections;Mt(t,r,c,b,w,window.fillContainerID,n,a,o)}))}r(!1),window.setFillIsExpanded(!1)}}var Rt="MOVE",At="COPY";var Pt=function(e){var t=e.row,n=e.col,r=gt(),c=Object(se.b)(),l=Object(se.c)((function(e){return e})),u=Object(a.useState)(!1),s=Object(i.a)(u,2),d=s[0],m=s[1],f={gridColumn:"".concat(n+1," / span 1"),gridRow:"".concat(t+1," / span 1"),borderColor:d?g:"transparent"};return o.a.createElement("div",{className:r.DropSquare,style:f,onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.dataTransfer.types.length>=3&&m(!0)},onDragLeave:function(e){e.dataTransfer.types.length>=3&&m(!1)},onDrop:function(e){kt(e,c,l,t,n,m)}})};var Ft=function(e){var t=e.mod,n=e.gridCol,r=e.gridRow,c=$e(),l=Object(a.useState)(!1),u=Object(i.a)(l,2),s=u[0],d=u[1],m=Object(a.useState)(!1),f=Object(i.a)(m,2),p=f[0],v=f[1],b=function(){v(!p)},w={gridColumn:"".concat(n," / span 1"),gridRow:"".concat(r," / span 1"),borderStyle:s?"solid":"none",backgroundColor:ce(t.moduleType),width:s?B.bigIconWidth:B.icon,height:s?B.bigIconHeight:B.icon},O={gridColumn:"".concat(n," / span 1"),gridRow:"".concat(r," / span 1"),width:s?B.bigIconWidth:B.icon,height:s?B.bigIconHeight:B.icon},g=Object(V.b)({fontSize:s?U.medium:U.small,config:{tension:350,clamp:!0}}),h=Object(se.c)((function(e){return e})),I=h.modules,D=h.baseContainerID,j=h.connections,C=Object(se.b)();return o.a.createElement(a.Fragment,null,o.a.createElement("div",{className:c.Icon,style:w,onPointerDown:function(e){return e.stopPropagation()},onDragOver:function(e){e.preventDefault()},onDrop:function(e){!function(e,t,n,a){e.stopPropagation();var o=e.dataTransfer.getData("id"),r=e.dataTransfer.getData("type");if(o){if(t[o]&&r===Rt){var c=e.dataTransfer.getData("fromRow"),i=e.dataTransfer.getData("fromCol");window.setFillIsExpanded(!1),a(me(o,n.row,n.col)),a(me(n.id,Number(c),Number(i))),window.setTimeout(window.refreshArcherContainer,100)}}else if(0===n.connectionInputs.length&&0===window.audioModules[n.id].connectingParamIDs.length)alert("mod cannot accept input");else{var l=e.dataTransfer.getData("fromID");l&&window.openConnectionMenu(l,n.id)}}(e,I,t,C)},draggable:!s,onDragStart:function(e){!function(e,t){e.shiftKey?e.dataTransfer.setData("type",At):e.dataTransfer.setData("type",Rt),e.dataTransfer.setData("id",t.id),e.dataTransfer.setData("fromRow","".concat(t.row)),e.dataTransfer.setData("fromCol","".concat(t.col)),window.setFillIsExpanded(!0)}(e,t)},onDragEnd:function(){window.setFillIsExpanded(!1)},onClick:function(e){e.stopPropagation(),d(!s),window.setTimeout(window.refreshArcherContainer,0)},onContextMenu:function(e){e.preventDefault(),e.persist(),window.openModuleContextMenu(e,t.id)}},0===t.connectionOutputs.length?null:o.a.createElement("div",{className:c.IconConnector,draggable:!0,onDragStart:function(e){e.stopPropagation(),e.dataTransfer.setData("fromID",t.id)}}),o.a.createElement(V.a.div,{className:c.IconName,style:g,onClick:function(e){s&&(e.stopPropagation(),window.openModuleRenameMenu(t.id))}},t.name),s?o.a.createElement("div",{className:c.IconControlContainer,onClick:function(e){return e.stopPropagation()}},t.moduleType===Y?o.a.createElement(Ot,{selectedModule:t,reRenderIcon:b}):null,o.a.createElement(pt,{audioModule:window.audioModules[t.id],selectedModule:t,reRenderIcon:b}),o.a.createElement(wt,{baseContainerID:D,selectedModule:t})):null),o.a.createElement("div",{className:c.ArcherElement,style:O},o.a.createElement("div",{style:{gridColumn:"".concat(1," / span 1"),gridRow:"".concat(1," / span 1")}},o.a.createElement(et.ArcherElement,{id:t.id+" input"},o.a.createElement("div",{style:{width:"10px",height:"10px"}}))),o.a.createElement("div",{style:{gridColumn:"".concat(1," / span 1"),gridRow:"".concat(3," / span 1")}},o.a.createElement(et.ArcherElement,{id:t.id+" controls"},o.a.createElement("div",{style:{width:"10px",height:"10px"}}))),o.a.createElement("div",{style:{gridColumn:"".concat(3," / span 1"),gridRow:"".concat(1," / span 1")}},o.a.createElement(et.ArcherElement,{id:t.id+" output",relations:t.outputs.filter((function(e){var t=j[e];return te(t.fromID,t.toID,I[window.fillContainerID].childModules)})).map((function(e){var t=j[e],n=t.toID,a=t.param;return{targetId:""===a?n+" input":n+" controls",targetAnchor:"left",sourceAnchor:"right",style:{strokeColor:""===a?"red":"blue"}}}))},o.a.createElement("div",{style:{width:"10px",height:"10px"}})))))};var _t=function(){var e=$e(),t=Object(a.useState)(!1),n=Object(i.a)(t,2),r=n[0],c=n[1];window.setFillIsExpanded=c;var l=Object(a.useState)(!1),u=Object(i.a)(l,2),s=u[0],d=u[1];window.reRenderFillContainer=function(){d(!s)};var m,f=Object(se.c)((function(e){return{modules:e.modules,baseContainerID:e.baseContainerID}})),p=f.modules,v=f.baseContainerID,b=p[window.fillContainerID],w=function(e,t){var n=0,a=0;return e.forEach((function(e){var o=t[e];o.row>n&&(n=o.row),o.col>a&&(a=o.col)})),{maxRow:n,maxCol:a}}(b.childModules,p),O=w.maxRow,g=w.maxCol,h=0===b.childModules.length;m=h?{gridTemplateRows:"repeat(".concat(1,", ","auto",")"),gridTemplateColumns:"repeat(".concat(1,", ","auto",")")}:{gridTemplateRows:"repeat(".concat(r?O+2:O+1,", ","auto",")"),gridTemplateColumns:"repeat(".concat(r?g+2:g+1,", ","auto",")")};var I=Object(a.useRef)(null);return window.refreshArcherContainer=function(){var e;null===(e=I.current)||void 0===e||e.refreshScreen()},o.a.createElement("div",{className:e.FillBounder},o.a.createElement("div",{className:e.FillHeaderBounder},o.a.createElement("div",{className:e.FillHeader,style:{width:"".concat(b.name.length/2,"em")},onClick:function(e){e.stopPropagation(),window.openModuleRenameMenu(window.fillContainerID)},onPointerDown:function(e){return e.stopPropagation()}},b.name),b.id===v?null:o.a.createElement(Ut,{style:{height:".7em"},onPointerDown:function(){window.fillContainerID=b.parentID,window.reRenderFillContainer()}},o.a.createElement("div",null,"back"))),o.a.createElement(et.ArcherContainer,{ref:I,svgContainerStyle:{zIndex:-1},strokeWidth:4,arrowLength:0},o.a.createElement("div",{className:e.Fill,style:m},h?o.a.createElement(Pt,{row:0,col:0}):ne(0,r?O+2:O+1).map((function(e){return ne(0,r?g+2:g+1).map((function(t){return o.a.createElement(Pt,{key:"".concat(e," ").concat(t),row:e,col:t})}))})).flat(),b.childModules.map((function(e){var t=p[e];return o.a.createElement(Ft,{key:t.id,mod:t,gridRow:t.row+1,gridCol:t.col+1})})))))};var Lt=Object(l.a)({CenterMenuBounder:{backgroundColor:"rgba(0,0,0,0.7)",position:"absolute",top:0,left:0,width:"100vw",height:"100vh",zIndex:100},CenterMenu:{backgroundColor:p,position:"absolute",top:"50vh",left:"50vw",transform:"translate(-50%, calc(-50% - 50px))",display:"flex",flexDirection:"column",alignItems:"center",borderRadius:"2vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",minWidth:"15vw",padding:"1vmin 2vmin 2vmin 2vmin",border:"1px solid white",zIndex:101},Header:{padding:"1vmin 2vmin",margin:"0vmin 0vmin 2vmin 0vmin",borderColor:"white",borderStyle:"none none solid none",fontSize:U.large}});var zt=function(e){var t=e.children,n=e.header,a=e.onClose,r=Lt();return o.a.createElement("div",{className:r.CenterMenuBounder,onPointerDown:function(e){e.stopPropagation(),a()}},o.a.createElement("div",{className:r.CenterMenu,onPointerDown:function(e){e.stopPropagation()}},o.a.createElement("div",{className:r.Header},n),t))};Object(l.a)({TestingArea:{backgroundColor:"black",position:"absolute",top:"45vh",left:"25vw",width:"45vw",height:"50vh",display:"flex",flexDirection:"column",zIndex:150},ButtonDiv:{display:"flex",flexFlow:"row wrap"},Button:{margin:"2vmin",padding:"1vmin",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{cursor:"pointer"}}});var Bt=Object(l.a)({Button:{backgroundColor:h,borderColor:"transparent",borderRadius:"1vmin",borderStyle:"solid","&:active":{borderColor:"transparent"},"&:hover":{cursor:"pointer",borderColor:"white"},display:"flex",alignItems:"center",justifyContent:"center",padding:"1vmin",margin:"1vmin",textAlign:"center"}});var Ut=function(e){var t=e.className,n=e.onClick,a=e.children,r=e.style,c=e.onPointerDown,i=e.ref,l=e.onKeyDown,u=Bt();return o.a.createElement("div",{className:t?"".concat(u.Button," ").concat(t):u.Button,onClick:n,onPointerDown:c,style:r,ref:i,onKeyDown:l},a)};var Ht=function(e){if(e.current){var t={"choose file":function(t){e.current.src=t},pause:function(){e.current.pause()},play:function(){e.current.play()}};return{audioNode:je.createMediaElementSource(e.current),ref:e,connectingParamIDs:[],controlSetFuncs:t}}return null};var Wt=function(e){var t=e.id,n=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(!window.audioModules[t]){var e=Ht(n);e&&(window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},t,e)))}})),o.a.createElement("audio",{ref:n,autoPlay:!0})};window.addAudioTag=function(e){window.audioTags[e]={id:e,srcName:""}},window.audioTags={},window.numberRestores=0;var Gt=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1];window.reRenderAudioTags=function(){r(!n)};var c=Object.keys(window.audioTags);return o.a.createElement(a.Fragment,null,c.map((function(e){return o.a.createElement(Wt,{key:e+window.numberRestores,id:e})})))},Kt=Object(l.a)({Bounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderRadius:"15px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",userSelect:"none",margin:"10px","&:hover":{cursor:"pointer"},padding:"1vmin"},SwitchSVG:{marginLeft:"1.5vmin",flexShrink:0}}),Vt=2*G.diameter,qt=G.diameter+1,Yt=1.5*G.diameter,Qt=G.diameter-1,Xt=G.diameter/4,Jt=(G.diameter+1)/2;var Zt=function(e){var t=e.text,n=e.onSwitch,r=e.initState,c=e.style,l=Object(a.useState)(r),u=Object(i.a)(l,2),d=u[0],m=u[1],f=Kt(),p=Object(V.b)({cx:"".concat(d?Vt-G.diameter/2:G.diameter/2,"vmin"),fill:d?"green":"red",config:{tension:250}});return o.a.createElement("div",{className:f.Bounder,style:c},o.a.createElement("div",{onClick:function(){n(!d),m(!d)}},t),o.a.createElement("svg",{className:f.SwitchSVG,width:"".concat(Vt,"vmin"),height:"".concat(qt,"vmin"),onClick:function(){n(!d),m(!d)}},o.a.createElement("rect",{width:"".concat(Yt,"vmin"),height:"".concat(Qt,"vmin"),x:"".concat(Xt,"vmin"),y:"".concat(1,"vmin"),rx:"10",ry:"10",fill:s}),o.a.createElement(V.a.circle,{cx:p.cx,cy:"".concat(Jt,"vmin"),r:"".concat(G.diameter/2,"vmin"),fill:p.fill})))},$t=Object(l.a)({KnobContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"auto",placeItems:"center",margin:"1vmin"},KnobSVG:{gridRow:"1",gridColumn:"1",width:"".concat(W.size+1,"vmin"),height:"".concat(W.size+1,"vmin"),zIndex:9},KnobText:{gridRow:"1",gridColumn:"1",fontSize:U.xxsmall,textAlign:"center",color:E,zIndex:10,width:"4em",borderStyle:"none",backgroundColor:"transparent","&::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"&::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}},InteractionLayer:{gridRow:"1",gridColumn:"1",zIndex:11,width:"".concat(W.size,"vmin"),height:"".concat(W.size,"vmin")},SettingsButton:{width:"".concat(W.size/6,"vmin"),height:"".concat(W.size/6,"vmin"),gridRow:"1",gridColumn:"1",placeSelf:"end",zIndex:12}}),en=n(24),tn=n.n(en),nn=!1;var an=function(e){var t=e.initValue,n=e.range,r=e.onChange,c=e.onEveryChange,i=e.onSettingsClick,l=e.inputVal,u=e.setInputVal,s=$t(),d=Object(a.useRef)(null),m=(n[1]-n[0])*W.sensitivity/200,f=ae(t,n),p=Object(a.useRef)(null),v=function(e){f=ae(f-e.movementY*m,n),d.current&&(d.current.style.transform="rotate(".concat(rt(f,n),"deg)")),p.current&&(p.current.value="".concat(ct(f))),c&&c(f)},b=function(){r&&r(f),u(ct(f))};return o.a.createElement("div",{className:s.KnobContainer},o.a.createElement("svg",{className:s.KnobSVG,width:"".concat(W.size+1,"vmin"),height:"".concat(W.size+1,"vmin"),ref:d,style:{transform:"rotate(".concat(rt(t,n),"deg)")}},o.a.createElement("circle",{cx:"".concat((W.size+1)/2,"vmin"),cy:"".concat((W.size+1)/2,"vmin"),r:"".concat(W.size/2,"vmin"),stroke:y,strokeWidth:W.borderWidth,fill:C}),o.a.createElement("rect",{width:"".concat(W.markerWidth,"vmin"),height:"".concat(W.markerHeight,"vmin"),x:"".concat((W.size+1)/2-W.markerWidth/2,"vmin"),y:".5vmin",fill:N})),o.a.createElement("input",{className:s.KnobText,ref:p,onChange:function(e){u(e.target.value),c&&c(ae(Number(e.target.value),n))},onBlur:function(e){if(0!==e.target.value.length){var t=ae(Number(e.target.value),n);r&&r(t),u(ct(t))}else p.current&&(p.current.value=l)},onKeyDown:function(e){var t;13===e.keyCode&&(null===(t=p.current)||void 0===t||t.blur())},type:"number",value:l}),o.a.createElement("div",{className:s.InteractionLayer,title:"".concat(t),onClick:function(e){return e.stopPropagation()},onDragStart:function(e){return e.stopPropagation()},onPointerDown:function(e){e.stopPropagation(),e.preventDefault(),e.shiftKey||nn?p.current&&(p.current.placeholder=p.current.value,p.current.value="",p.current.focus()):(window.openPointerLayer(e.pointerId,v,b),nn=!0,window.setTimeout((function(){nn=!1}),200))}}),i?o.a.createElement("img",{className:s.SettingsButton,title:"edit knob range",src:tn.a,alt:"settings",onClick:i}):null)};var on=Object(l.a)({PointerLayer:{width:"100vw",height:"100vh",position:"absolute",top:0,left:0,zIndex:300}});var rn=function(e){var t=e.pointerLayerData,n=e.resetPointerLayerData,r=on(),c=t.pointerId,i=t.onPointerMove,l=t.onPointerUp,u=Object(a.useRef)(null);return Object(a.useEffect)((function(){})),o.a.createElement("div",{className:r.PointerLayer,ref:u,onPointerMove:function(e){e.pointerId===c&&i(e)},onPointerUp:function(e){e.pointerId===c&&(l(e),n())}})};function cn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{isOpen:e,fromID:t,toID:n}}function ln(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return{isOpen:e,modID:t,controlID:n,onChangeSubmit:a}}function un(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,range:t,onChangeSubmit:n}}function sn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,saveList:t,onClose:n}}function dn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return{isOpen:e,id:t,saveList:n,onClose:a}}function mn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,saveName:t,onClose:n}}function fn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0;return{isOpen:e,placeholder:t,containerControl:a,parentModID:n}}var pn=Object(l.a)({IORecursionBounder:{display:"flex",alignSelf:"flex-start",marginLeft:"5vmin",flexDirection:"column",alignItems:"flex-start",height:"60vmin",width:"90%",overflowY:"scroll",overflowX:"visible","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white",borderRadius:"2px"}},IORecursionInnerBounder:{display:"flex",alignSelf:"flex-start",marginLeft:"2vmin",flexDirection:"column",alignItems:"flex-start"}});var vn=function e(t){var n=t.id,r=t.isOutput,c=t.setConnection,l=Object(se.c)((function(e){return[e.modules[n].moduleType===Y,e.modules[n].name,r?e.modules[n].connectionOutputs:e.modules[n].connectionInputs]})),u=Object(i.a)(l,3),s=u[0],d=u[1],m=u[2],f=Object(a.useState)(!1),p=Object(i.a)(f,2),v=p[0],b=p[1],w=pn();return s?o.a.createElement(a.Fragment,null,o.a.createElement(Ut,{style:{color:T},onClick:function(){b(!v)}},d),v?o.a.createElement("div",{className:w.IORecursionInnerBounder},m.map((function(t){return o.a.createElement(e,{key:t,id:t,isOutput:r,setConnection:c})}))):null):m.length>1?o.a.createElement(a.Fragment,null,o.a.createElement(Ut,{style:{color:T},onClick:function(){b(!v)}},d),v?o.a.createElement("div",{className:w.IORecursionInnerBounder},m.map((function(e,t){return o.a.createElement(Ut,{style:{color:x},onClick:function(){c(n,t)}},e)}))):null):o.a.createElement(Ut,{onClick:function(){c(n,0)}},d)};function bn(e,t,n){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=0;o<t.outputs.length;o++){var r=e[t.outputs[o]],c=r.actualInputID,i=r.param;if(c===n&&a===i)return!0}return!1}var wn={};var On=function(e){var t=e.fromID,n=e.toID,r=e.onClose,c=pn(),l=window.audioModules,u=Object(se.c)((function(e){return e})),s=u.modules,d=u.connections,m=s[t],f=s[n],p=Object(a.useState)(0),v=Object(i.a)(p,2),b=v[0],w=v[1],O=Object(a.useState)(0),g=Object(i.a)(O,2),h=g[0],I=g[1],D=Object(a.useState)(t),j=Object(i.a)(D,2),C=j[0],E=j[1],y=Object(a.useState)(n),N=Object(i.a)(y,2),x=N[0],T=N[1],M=Object(se.b)(),S=m.moduleType===Y,k=f.moduleType===Y,R=m.connectionOutputs.length>1||S?"CHOOSE_OUTPUT":f.connectionInputs.length>1||k?"CHOOSE_INPUT":"CONNECT_TO",A=Object(a.useState)(R),P=Object(i.a)(A,2),F=P[0],_=P[1];return o.a.createElement(a.Fragment,null,"CHOOSE_OUTPUT"===F?o.a.createElement(zt,{header:"choose output",onClose:r},o.a.createElement("div",{className:c.IORecursionBounder},m.connectionOutputs.map((function(e,n){return S?o.a.createElement(vn,{key:e+"output",id:S?e:t,isOutput:!0,setConnection:function(e,t){E(e),w(t),f.connectionInputs.length>1||f.moduleType===Y?_("CHOOSE_INPUT"):_("CONNECT_TO")}}):o.a.createElement(Ut,{onClick:function(){w(n),f.connectionInputs.length>1||f.moduleType===Y?_("CHOOSE_INPUT"):_("CONNECT_TO")}},m.connectionOutputs[n])})))):"CHOOSE_INPUT"===F?o.a.createElement(zt,{header:"choose input",onClose:r},o.a.createElement("div",{className:c.IORecursionBounder},f.connectionInputs.map((function(e,t){return k?o.a.createElement(vn,{key:e+"input",id:k?e:n,isOutput:!1,setConnection:function(e,t){T(e),I(t),_("CONNECT_TO")}}):o.a.createElement(Ut,{onClick:function(){I(t),_("CONNECT_TO")}},f.connectionInputs[t])})))):"CONNECT_TO"===F?o.a.createElement(zt,{header:"connect ".concat(S?m.name+" - "+s[C].name:m.name," to ").concat(k?f.name+" - "+s[x].name:f.name),onClose:r},(k?0===s[f.connectionInputs[h]].connectionInputs.length:0===f.connectionInputs.length)?null:o.a.createElement(Ut,{style:wn,onClick:function(){bn(d,m,x)?alert("modules already connected"):(He(l[C],l[x],"",b,h),M(we(t,n,"",b,h,S?C:void 0,k?x:void 0))),r()}},"module"),0===l[x].connectingParamIDs.length?null:o.a.createElement(Ut,{style:wn,onClick:function(e){e.stopPropagation(),_("CHOOSE_PARAM")}},"params")):"CHOOSE_PARAM"===F?o.a.createElement(zt,{header:"props",onClose:r},l[x].connectingParamIDs.map((function(e,a){return o.a.createElement(Ut,{style:wn,key:t+n+a,onClick:function(){bn(d,m,x,e)?alert("modules already connected"):(He(l[C],l[x],e,b,h),M(we(t,n,e,b,h,S?C:void 0,k?x:void 0))),r()}},e)}))):null)},gn=Object(l.a)({CMInputBounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},CenterMenuInput:{backgroundColor:s,color:"white",height:"2vmin",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:U.small,width:"15vmin","&:hover":{cursor:"text"}}});var hn=function(e){var t=e.onClose,n=e.modID,r=e.controlID,c=e.onChangeSubmit,l=Object(se.c)((function(e){return e.modules[n].controlData[r]})),u=l.maxRange,s=l.range,d=Object(a.useState)(s[0]),m=Object(i.a)(d,2),f=m[0],p=m[1],v=Object(a.useState)(s[1]),b=Object(i.a)(v,2),w=b[0],O=b[1],g=gn();return o.a.createElement(zt,{header:"set ".concat(r," range"),onClose:t},o.a.createElement("div",{style:{fontSize:U.small}},u?"max range from ".concat(u[0]," to ").concat(u[1]):null),o.a.createElement("div",{className:g.CMInputBounder,onKeyDown:function(e){27===e.keyCode?t():13===e.keyCode&&(c([f,w]),t())}},o.a.createElement("input",{className:g.CenterMenuInput,onChange:function(e){p(Number(e.target.value))},value:f,type:"number"}),o.a.createElement("input",{className:g.CenterMenuInput,onChange:function(e){O(Number(e.target.value))},value:w,type:"number"})),o.a.createElement(Ut,{style:{fontSize:U.small,backgroundColor:P},onClick:function(){u?oe(f,u)&&oe(w,u)?w>f?(c([f,w]),t()):alert("min must be less than max"):alert("a value is not within maximum range bounds"):w>f?(c([f,w]),t()):alert("min must be less than max")}},"confirm"))},In=Object(l.a)({CenterMenuInput:{backgroundColor:s,color:"white",height:"1em",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:U.medium,textAlign:"center","&:hover":{cursor:"text"}}});var Dn=function(e){var t=e.saveList,n=e.onClose,r=Object(se.c)((function(e){return e})),c=r.baseContainerID,l=r.modules,u=Object(a.useState)(l[c].name),s=Object(i.a)(u,2),d=s[0],m=s[1],f=Object(a.useState)({isOpen:!1,message:""}),p=Object(i.a)(f,2),v=p[0],b=p[1],w=Object(a.useRef)(null),O=In();return o.a.createElement(zt,{header:"save project",onClose:n},o.a.createElement(Ln,{style:{alignItems:"center"}},o.a.createElement("input",{className:O.CenterMenuInput,value:d,placeholder:l[c].name,onChange:function(e){m(e.target.value)},onKeyDown:function(e){switch(e.keyCode){case 13:ee(d,t)?b({isOpen:!0,message:"would you like to overwrite this save?"}):(window.projectSaveService.create({saveName:d,state:r}).then((function(e){e&&window.flashNotification("green","project saved")})),n());break;case 27:n()}},ref:w,autoFocus:!0}),o.a.createElement(Ut,{onPointerDown:function(e){return e.preventDefault()},onClick:function(e){e.preventDefault(),ee(d,t)?b({isOpen:!0,message:"save already exists. do you want to replace it?"}):(window.projectSaveService.create({saveName:d,state:r}).then((function(e){e&&window.flashNotification("green","project saved")})),n())}},"save to spaceDB")),v.isOpen?o.a.createElement(zn,null,o.a.createElement("div",{style:{fontSize:U.small}},v.message),o.a.createElement(Ln,{style:{justifyContent:"center"}},o.a.createElement(Ut,{style:{backgroundColor:F,marginRight:"3vmin"},onClick:function(){var e;null===(e=w.current)||void 0===e||e.focus(),b({isOpen:!1,message:""})}},"no"),o.a.createElement(Ut,{style:{backgroundColor:P},onClick:function(){window.projectSaveService.update(d,r).then((function(e){e&&window.flashNotification("green","project updated")})),n()}},"yes"))):null)};var jn,Cn=function(e){var t=e.saveName,n=e.onClose;return o.a.createElement(zt,{header:"are you sure you want to delete ".concat(t,"?"),onClose:n},o.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"}},o.a.createElement(Ut,{style:{backgroundColor:F,marginRight:"3vmin"},onClick:function(){n()}},"no"),o.a.createElement(Ut,{style:{backgroundColor:P},onClick:function(){window.projectSaveService.remove(t),n()}},"yes")))};function En(e,t,n,a,o,r){if(ee(n,a))e({isOpen:!0,message:"module with this name already exists. would you like to update it?"});else{var c=Nt(o,t),i=c.modules,l=c.connections;window.containerSaveService.create({saveName:n,containerID:t,modules:i,connections:l}).then((function(e){e&&window.flashNotification("green","module saved to spaceDB")})),r()}}window.usingElectron&&(jn=window.require("fs")),window.currentSaveDirectory="";var yn=function(e){var t=e.onClose,n=Object(a.useRef)(null),r=Object(se.c)((function(e){return e})),c=r.modules[r.baseContainerID].name,l=Object(a.useState)(c),u=Object(i.a)(l,2),s=u[0],d=u[1],m=Object(a.useState)(window.currentSaveDirectory),f=Object(i.a)(m,2),p=f[0],v=f[1],b=In();return Object(a.useEffect)((function(){window.setTimeout((function(){n.current&&(n.current.webkitdirectory=!0)}),50)}),[]),o.a.createElement(zt,{header:"save project as file",onClose:t},o.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},0===window.currentSaveDirectory.length?o.a.createElement("label",{htmlFor:"chooseDirectory",style:{marginBottom:"1vmin",fontSize:U.small}},o.a.createElement(Ut,{onClick:function(){}},"choose save directory")):o.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",marginBottom:"2vmin"}},o.a.createElement("div",{style:{fontSize:U.small}},p),o.a.createElement("label",{style:{backgroundColor:"blue",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:"2vmin",borderRadius:"1vmin"},htmlFor:"chooseDirectory"},o.a.createElement("img",{style:{width:".7em",padding:".2vmin"},title:"edit directory",src:tn.a,alt:"edit directory"}))),o.a.createElement("input",{style:{width:0,height:0,opacity:0},id:"chooseDirectory",type:"file",ref:n,onChange:function(e){if(e.target.files[0]){var t=function(e){for(var t=e.length;t>0;t--)if("/"===e[t])return e.slice(0,t+1);return e}(e.target.files[0].path);window.currentSaveDirectory=t,v(t)}}}),o.a.createElement("input",{className:b.CenterMenuInput,value:s,onChange:function(e){d(e.target.value)},onKeyDown:function(e){switch(e.keyCode){case 13:""!==s?(jn.writeFile(p+s+".sm",JSON.stringify(r),(function(e){if(e)throw e;window.flashNotification("green","file saved")})),t()):alert("please enter a save name");break;case 27:t()}}}),o.a.createElement(Ut,{onClick:function(){""!==s&&""!==p?(jn.writeFile(p+s+".sm",JSON.stringify(r),(function(e){if(e)throw e;window.flashNotification("green","file saved")})),t()):window.flashNotification("red","please enter save name or set directory")}},"save")))};var Nn=function(e){var t=e.id,n=e.saveList,r=e.onClose,c=Object(se.c)((function(e){return e})),l=c.modules[t].name,u=Object(a.useState)(l),s=Object(i.a)(u,2),d=s[0],m=s[1],f=Object(a.useState)({isOpen:!1,message:""}),p=Object(i.a)(f,2),v=p[0],b=p[1],w=Object(a.useRef)(null),O=In();return o.a.createElement(zt,{header:"save container module",onClose:r},o.a.createElement("input",{className:O.CenterMenuInput,value:d,placeholder:l,ref:w,onChange:function(e){m(e.target.value)},onKeyDown:function(e){switch(e.keyCode){case 13:En(b,t,d,n,c,r);break;case 27:r()}},autoFocus:!0}),o.a.createElement(Ut,{onClick:function(){En(b,t,d,n,c,r)}},"confirm"),v.isOpen?o.a.createElement(a.Fragment,null,o.a.createElement("div",{style:{fontSize:U.small}},v.message),o.a.createElement("div",{style:{display:"flex"}},o.a.createElement(Ut,{style:{backgroundColor:F},onClick:function(){w.current&&(w.current.value="",w.current.focus()),b({isOpen:!1,message:""})}},"no"),o.a.createElement(Ut,{style:{backgroundColor:P},onClick:function(){var e=Nt(c,t),n=e.modules,a=e.connections;window.containerSaveService.update(d,{saveName:d,containerID:t,modules:n,connections:a}).then((function(e){e&&window.flashNotification("green","module updated")})),r()}},"yes"))):null)};var xn=function(e){var t=e.range,n=e.onChangeSubmit,r=e.onClose,c=gn(),l=Object(a.useState)(t[0]),u=Object(i.a)(l,2),s=u[0],d=u[1],m=Object(a.useState)(t[1]),f=Object(i.a)(m,2),p=f[0],v=f[1];return o.a.createElement(zt,{header:"set analyzer range",onClose:r},o.a.createElement("div",{className:c.CMInputBounder,onKeyDown:function(e){27===e.keyCode?r():13===e.keyCode&&(n([s,p]),r())}},o.a.createElement("input",{className:c.CenterMenuInput,onChange:function(e){d(Number(e.target.value))},value:s,type:"number"}),o.a.createElement("input",{className:c.CenterMenuInput,onChange:function(e){v(Number(e.target.value))},value:p,type:"number"})),o.a.createElement(Ut,{style:{fontSize:U.small,backgroundColor:P},onClick:function(){n([s,p]),r()}},"confirm"))},Tn=Object(l.a)({CMInputBounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},CenterMenuInput:{backgroundColor:s,color:"white",height:"2vmin",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:U.small,width:"23vmin","&:hover":{cursor:"text"}},InputSubmit:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:s,height:"2vmin",padding:"1vmin",margin:"1.5vmin 1.5vmin 1.5vmin 0.75vmin",borderRadius:"1vmin","&:hover":{cursor:"pointer"},fontSize:U.small},Error:{backgroundColor:D,width:"90%",color:"white",fontSize:U.small,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"1vmin",padding:"1vmin 0vmin",marginBottom:"1vmin"}});var Mn=function(e){var t=e.header,n=e.onSubmit,r=e.placeholder,c=e.initName,l=e.onClose,u=Tn(),s=Object(a.useState)(c),d=Object(i.a)(s,2),m=d[0],f=d[1],p=Object(a.useState)(!1),v=Object(i.a)(p,2),b=v[0],w=v[1];function O(){m.length>0?(n(m),l()):w(!0)}return o.a.createElement(zt,{header:t,onClose:l},o.a.createElement("div",{className:u.CMInputBounder},o.a.createElement("input",{className:u.CenterMenuInput,placeholder:r,value:m,onChange:function(e){f(e.target.value)},onKeyDown:function(e){switch(e.keyCode){case 13:O();break;case 27:l()}},autoFocus:!0}),o.a.createElement(Ut,{onClick:function(){O()}},"confirm"),b?o.a.createElement("div",{className:u.Error},"please enter a name"):null))};var Sn=function(e){var t,n=e.toRenameID,a=e.onClose,r=Object(se.c)((function(e){return e.modules})),c=Object(se.b)();return o.a.createElement(Mn,{header:"rename module",onSubmit:function(e){c(function(e,t){return{type:"RENAME_MODULE",id:e,newName:t}}(n,e))},placeholder:null===(t=r[n])||void 0===t?void 0:t.name,initName:"",onClose:a})};var kn=function(e){var t=e.placeholder,n=e.containerControl,a=e.parentModID,r=e.onClose,c=Object(se.b)(),i=n.modID,l=n.controlID,u=n.actualModID;return o.a.createElement(Mn,{header:"rename control",onSubmit:function(e){c(function(e,t,n,a,o){return{type:"RENAME_CONTAINER_CONTROL",name:e,parentModID:t,modID:n,controlID:a,actualModID:o}}(e,a,i,l,u)),window.flashNotification("green","control passthrough renamed")},placeholder:t,initName:"",onClose:r})};var Rn=function(){var e=Object(a.useState)(cn(!1)),t=Object(i.a)(e,2),n=t[0],r=t[1];window.openConnectionMenu=function(e,t){r(cn(!0,e,t))};var c=Object(a.useState)({isOpen:!1,toRenameID:""}),l=Object(i.a)(c,2),u=l[0],s=l[1];window.openModuleRenameMenu=function(e){s({isOpen:!0,toRenameID:e})};var d=Object(a.useState)(fn(!1)),m=Object(i.a)(d,2),f=m[0],p=m[1];window.openControlRenameMenu=function(e,t,n){p(fn(!0,e,t,n))};var v=Object(a.useState)(ln(!1)),b=Object(i.a)(v,2),w=b[0],O=b[1];window.openKnobRangeSetMenu=function(e,t,n){O(ln(!0,e,t,n))};var g=Object(a.useState)(un(!1)),h=Object(i.a)(g,2),I=h[0],D=h[1];window.openAnalyzerRangeSetMenu=function(e,t){D(un(!0,e,t))};var j=Object(a.useState)(sn(!1)),C=Object(i.a)(j,2),E=C[0],y=C[1];window.openSpaceDBProjectSaveMenu=function(e,t){y(sn(!0,e,t))};var N=Object(a.useState)(dn(!1)),x=Object(i.a)(N,2),T=x[0],M=x[1];window.openSpaceDBContainerSaveMenu=function(e,t,n){M(dn(!0,t,e,n))};var S=Object(a.useState)(mn(!1)),k=Object(i.a)(S,2),R=k[0],A=k[1];window.openConfirmDeleteMenu=function(e,t){A(mn(!0,e,t))};var P=Object(a.useState)({isOpen:!1}),F=Object(i.a)(P,2),_=F[0],L=F[1];return window.openFileSaveMenu=function(){L({isOpen:!0})},o.a.createElement(a.Fragment,null,n.isOpen?o.a.createElement(On,{fromID:n.fromID,toID:n.toID,onClose:function(){r(cn(!1))}}):null,u.isOpen?o.a.createElement(Sn,{toRenameID:u.toRenameID,onClose:function(){s({isOpen:!1,toRenameID:""})}}):null,f.isOpen?o.a.createElement(kn,{placeholder:f.placeholder,containerControl:f.containerControl,parentModID:f.parentModID,onClose:function(){p(fn(!1))}}):null,w.isOpen?o.a.createElement(hn,{modID:w.modID,controlID:w.controlID,onClose:function(){O(ln(!1))},onChangeSubmit:function(e){w.onChangeSubmit(e)}}):null,I.isOpen?o.a.createElement(xn,{range:I.range,onClose:function(){D(un(!1))},onChangeSubmit:function(e){I.onChangeSubmit(e)}}):null,E.isOpen?o.a.createElement(Dn,{saveList:E.saveList,onClose:function(){E.onClose(),y(sn(!1))}}):null,T.isOpen?o.a.createElement(Nn,{id:T.id,saveList:T.saveList,onClose:function(){T.onClose(),M(dn(!1))}}):null,R.isOpen?o.a.createElement(Cn,{saveName:R.saveName,onClose:function(){R.onClose(),A(mn(!1))}}):null,_.isOpen?o.a.createElement(yn,{onClose:function(){L({isOpen:!1})}}):null)};function An(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{isOpen:e,color:t,text:n}}var Pn=Object(l.a)({Notification:{position:"absolute",top:"10vh",left:"50vw",transform:"translate(-50%, 0%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"2vmin",borderRadius:"4vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",zIndex:1e3,fontSize:U.small}});var Fn=function(){var e=Object(a.useState)(An(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.color,l=n.text,u=t[1],s=Object(a.useState)(!1),d=Object(i.a)(s,2),m=d[0],f=d[1],p=Pn();window.flashNotification=function(e,t){u(An(!0,e,t)),f(!0),window.setTimeout((function(){f(!1)}),2500),window.setTimeout((function(){u(An(!1))}),3200)};var v=Object(V.b)({opacity:m?1:0});return o.a.createElement(a.Fragment,null,r?o.a.createElement(V.a.div,{className:p.Notification,style:Object.assign({backgroundColor:c},v)},l):null)},_n=Object(l.a)({FlexRow:{display:"flex",flexDirection:"row"},FlexCol:{display:"flex",flexDirection:"column"}});var Ln=function(e){var t=e.children,n=e.style,a=e.ref,r=_n();return o.a.createElement("div",{className:r.FlexRow,style:n,ref:a},t)};var zn=function(e){var t=e.children,n=e.style,a=e.ref,r=_n();return o.a.createElement("div",{className:r.FlexCol,style:n,ref:a},t)};var Bn=function(){window.addModule=function(e,t,n,a,o,r,c){switch(a){case"OSCILLATOR":var i=Ae(),l={"set type":{controlType:"TYPE",paramID:"type",value:(A=i.audioNode).type},frequency:{controlType:Q,paramID:"frequency",value:A.frequency.value,range:[0,440]},detune:{controlType:Q,paramID:"detune",value:A.detune.value,range:[-50,50]}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,i)),o(de(e,t,a,l,n,r,c,[],["0"]));break;case"GAIN":var u=ke(),s={gain:{controlType:Q,paramID:"gain",value:0,range:[0,1]}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,u)),o(de(e,t,a,s,n,r,c,["0"],["0"]));break;case"OUTPUT":var d=xe(),m={"master gain":{controlType:Q,paramID:"gain",value:1,range:[0,1],maxRange:[0,20]},resume:{controlType:X,paramID:"n/a"},suspend:{controlType:X,paramID:"n/a"}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,d)),o(de(e,t,a,m,n,r,c,["0"],[]));break;case"AUTOFILTER":var f=Ne(),p={"set type":{controlType:"TYPE",paramID:"type",value:(R=f.audioNode).type},frequency:{controlType:Q,paramID:"frequency",value:R.frequency.value,range:[0,je.sampleRate/2],maxRange:[0,je.sampleRate/2]},detune:{controlType:Q,paramID:"detune",value:R.detune.value,range:[-50,50],maxRange:[-153600,153600]},Q:{controlType:Q,paramID:"Q",value:R.Q.value,range:[1e-4,1e3],maxRange:[1e-4,1e3]},gain:{controlType:Q,paramID:"gain",value:R.gain.value,range:[-40,40],maxRange:[-40,40]}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,f)),o(de(e,t,a,p,n,r,c,["0"],["0"]));break;case"KOMPRESSOR":var v=Se(),b=(k=v.audioNode,{threshold:{controlType:Q,paramID:"threshold",value:k.threshold.value,range:[-100,0],maxRange:[-100,0]},knee:{controlType:Q,paramID:"knee",value:k.knee.value,range:[0,40],maxRange:[0,40]},ratio:{controlType:Q,paramID:"ratio",value:k.ratio.value,range:[1,20],maxRange:[1,20]},attack:{controlType:Q,paramID:"attack",value:k.attack.value,range:[0,1],maxRange:[0,1]},release:{controlType:Q,paramID:"release",value:k.release.value,range:[0,1],maxRange:[0,1]}});window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,v)),o(de(e,t,a,b,n,r,c,["0"],["0"]));break;case"STEREO_PANNER":var w=Te(),O={pan:{controlType:Q,paramID:"pan",value:0,range:[-1,1],maxRange:[-1,1]}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,w)),o(de(e,t,a,O,n,r,c,["0"],["0"]));break;case"SIGNAL_DELAY":var g=Me(),h={"delay time":{controlType:Q,paramID:"delayTime",value:0,range:[0,2],maxRange:[0,60]}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,g)),o(de(e,t,a,h,n,r,c,["0"],["0"]));break;case"CONSTANT":var I=Ce(),D={value:{controlType:Q,paramID:"offset",value:0,range:[-100,100]},kill:{controlType:X,paramID:"n/a"}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,I)),o(de(e,t,a,D,n,r,c,[],["0"]));break;case"MEDIA_ELEMENT":var j={"choose file":{controlType:"FILE"},play:{controlType:X},pause:{controlType:X}};window.addAudioTag(e),window.reRenderAudioTags(),o(de(e,t,a,j,n,r,c,[],["0"]));break;case"LINE_IN":Pe(e),o(de(e,t,a,{mute:{controlType:"SWITCH",paramID:"n/a",value:!1}},n,r,c,[],["0 (L)","1 (R)"]));break;case Y:var C=Fe(e),E={open:{controlType:X}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,C)),o(de(e,t,a,E,n,r,c,[],[]));break;case"DISTORTION":var y=Le(),N={amount:{controlType:Q,value:0,range:[0,1e3]},oversample:{controlType:Q,value:0,range:[0,4],maxRange:[0,4]}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,y)),o(de(e,t,a,N,n,r,c,["0"],["0"]));break;case"ANALYZER":var x=ze(),T={"time graph":{controlType:"GRAPH",range:[-1.5,1.5]}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,x)),o(de(e,t,a,T,n,r,c,["0"],["0"]));break;case"ENVELOPED_TRIGGER":var M=Be(),S={trigger:{controlType:"PAD"},attack:{controlType:Q,value:.1,range:[.001,1],maxRange:[.001,100]},decay:{controlType:Q,value:.2,range:[.001,1],maxRange:[.001,100]},sustain:{controlType:Q,value:1,range:[0,1],maxRange:[0,100]},release:{controlType:Q,value:.1,range:[.001,1],maxRange:[.001,100]}};window.audioModules=Object(De.a)(Object(De.a)({},window.audioModules),{},Object(Ie.a)({},e,M)),o(de(e,t,a,S,n,r,c,[],["0"]))}var k,R,A}};function Un(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return{isOpen:e,pointerId:t,onPointerMove:n,onPointerUp:a}}var Hn=n(40),Wn=n.n(Hn),Gn=n(41),Kn=n.n(Gn);var Vn=function(){var e=Wn()(),t=Kn()("http://192.168.1.68:30300");e.configure(t.fetch(window.fetch)),window.projectSaveService=e.service("project-save-service"),window.containerSaveService=e.service("container-save-service")};var qn=function(){navigator.userAgent.toLowerCase().indexOf(" electron/")>-1?window.usingElectron=!0:window.usingElectron=!1};function Yn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{isOpen:e,event:t,modID:n}}function Qn(e,t){return t.current?{top:window.innerHeight-e.pageY>=t.current.offsetHeight?e.pageY:window.innerHeight-t.current.offsetHeight,left:window.innerWidth-e.pageX>=t.current.offsetWidth?e.pageX:window.innerWidth-t.current.offsetWidth}:{top:-1e3,left:-1e3}}var Xn=Object(l.a)({Bounder:{width:"100vw",height:"100vh",backgroundColor:"transparent",position:"absolute",overflow:"hidden",top:0,left:0,zIndex:1e3},ContextMenu:{maxHeight:"12em",backgroundColor:L,padding:".2em",borderRadius:".2em",display:"flex",flexDirection:"column",position:"absolute",overflowY:"scroll","&::-webkit-scrollbar":{width:"0em"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},MenuItem:{maxWidth:"8em",borderStyle:"solid",borderColor:"transparent","&:hover":{borderColor:_}}});var Jn=function(e){var t=e.e,n=e.children,r=e.onClose,c=Xn(),l=Object(a.useRef)(null),u=Object(a.useState)(Qn(t,l)),s=Object(i.a)(u,2),d=s[0],m=s[1];return Object(a.useEffect)((function(){m(Qn(t,l))}),[t]),o.a.createElement("div",{className:c.Bounder,onPointerDown:r},o.a.createElement("div",{className:c.ContextMenu,style:{top:d.top,left:d.left},ref:l},n))},Zn=n(42),$n=n.n(Zn),ea=Object(l.a)({DeleteButtonBounder:{backgroundColor:I,fontSize:U.small,padding:".2em .4em","&:hover":{borderColor:I}},DeleteButtonSVG:{width:"1.5em",height:"1.5em"},Connection:{fontSize:U.xsmall,backgroundColor:v,margin:".5vmin 3vmin",borderRadius:"1vmin",borderColor:"transparent",borderStyle:"solid",minWidth:"30%",padding:"1vmin",display:"flex",justifyContent:"center",alignItems:"center","&:hover":{cursor:"pointer",borderColor:I},boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},MenuHeader:{fontSize:U.small,borderStyle:"none none solid none",margin:"1vmin",width:"90%"}});var ta=function(e){var t=e.modID,n=e.onClose,a=window.audioModules,r=Object(se.b)(),c=Object(se.c)((function(e){return e.connections})),i=Object(se.c)((function(e){return e.modules[t]})),l=ea();return o.a.createElement(Ut,{className:l.DeleteButtonBounder,onPointerDown:function(e){e.stopPropagation()},onClick:function(){i.inputs.forEach((function(e){var t=c[e],n=t.fromID,o=t.toID,r=t.param,i=t.outputIndex,l=t.actualOutputID,u=t.actualInputID;We(a[l||n],a[u||o],r,i)})),i.outputs.forEach((function(e){var t=c[e],n=t.fromID,o=t.toID,r=t.param,i=t.outputIndex,l=t.actualOutputID,u=t.actualInputID;We(a[l||n],a[u||o],r,i)})),r({type:"REMOVE_MODULE",id:i.id}),n()}},o.a.createElement("img",{className:l.DeleteButtonSVG,src:$n.a,alt:"delete"}))};var na=function(e){var t=e.modID,n=e.modules,r=ea(),c=Object(se.b)(),i=window.audioModules,l=Object(se.c)((function(e){return e.connections})),u=Object(se.c)((function(e){return e.modules[t]}));return o.a.createElement(a.Fragment,null,0===u.inputs.length?null:o.a.createElement("div",{className:r.MenuHeader},"inputs"),u.inputs.map((function(e,t){var a=l[e],s=a.fromID,d=a.param,m=a.outputIndex,f=a.actualOutputID,p=a.actualInputID,v=n[s].name;return o.a.createElement("div",{className:r.Connection,key:s+d+"inp"+t,onClick:function(t){t.stopPropagation(),c(Oe(e)),We(i[f||s],i[p||u.id],d,m)},onPointerDown:function(e){e.stopPropagation()}},"".concat(v).concat(f?" - ".concat(n[f].name):"").concat(0!==d.length?" - ".concat(d):""))})),0===u.outputs.length?null:o.a.createElement("div",{className:r.MenuHeader},"outputs"),u.outputs.map((function(e,t){var a=l[e],s=a.toID,d=a.param,m=a.outputIndex,f=a.actualOutputID,p=a.actualInputID,v=n[s].name;return o.a.createElement("div",{className:r.Connection,key:s+d+"out"+t,onClick:function(t){t.stopPropagation(),c(Oe(e)),We(i[f||u.id],i[p||s],d,m)},onPointerDown:function(e){e.stopPropagation()}},"".concat(v).concat(p?" - ".concat(n[p].name):"").concat(0!==d.length?" - ".concat(d):""))})))};var aa=function(e){var t=e.event,n=e.onClose,a=e.modID,r=Object(se.c)((function(e){return e.modules}));return o.a.createElement(Jn,{e:t,onClose:n},o.a.createElement(na,{modID:a,modules:r}),o.a.createElement(ta,{modID:a,onClose:n}))};var oa=function(){var e=Object(a.useState)(Yn(!1)),t=Object(i.a)(e,2),n=t[0],r=t[1];return window.openModuleContextMenu=function(e,t){r(Yn(!0,e,t))},o.a.createElement(a.Fragment,null,n.isOpen?o.a.createElement(aa,{event:n.event,onClose:function(){r(Yn(!1))},modID:n.modID}):null)};window.fillContainerID="project",window.audioModules={},Bn(),Vn(),qn();var ra=function(){var e=u(),t=Object(a.useState)(Un(!1)),n=Object(i.a)(t,2),r=n[0],c=n[1];return window.openPointerLayer=function(e,t,n){c(Un(!0,e,t,n))},o.a.createElement("div",{className:e.Bounder},o.a.createElement("div",{className:e.ModuleViewBounder},o.a.createElement(_t,null)),o.a.createElement(Ze,null),o.a.createElement(Gt,null),r.isOpen?o.a.createElement(rn,{pointerLayerData:r,resetPointerLayerData:function(){c(Un(!1))}}):null,o.a.createElement(Rn,null),o.a.createElement(Fn,null),o.a.createElement(oa,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ca=n(21),ia=n(43),la=function(e,t){var n,a,o=t.id,r=t.name,c=t.moduleType,i=t.controlData,l=t.row,u=t.col,s=t.parentID,d=t.connectionInputs,m=t.connectionOutputs;switch(c){case Y:return Object.assign({},e,(n={},Object(Ie.a)(n,o,{id:o,name:r,row:l,col:u,parentID:s,moduleType:c,controlData:i,connectionInputs:d,connectionOutputs:m,inputs:[],outputs:[],containerControls:[],toContainerControls:[],childModules:[],isBaseContainer:!1,isContainerInput:!1,isContainerOutput:!1}),Object(Ie.a)(n,s,Object(De.a)(Object(De.a)({},e[s]),{},{childModules:[].concat(Object(jt.a)(e[s].childModules),[o])})),n));default:return Object.assign({},e,(a={},Object(Ie.a)(a,o,{id:o,name:r,row:l,col:u,parentID:s,moduleType:c,controlData:i,connectionInputs:d,connectionOutputs:m,toContainerControls:[],isContainerInput:!1,isContainerOutput:!1,inputs:[],outputs:[]}),Object(Ie.a)(a,s,Object(De.a)(Object(De.a)({},e[s]),{},{childModules:[].concat(Object(jt.a)(e[s].childModules),[o])})),a))}},ua=function(e,t){var n=t.id,a=t.newRow,o=t.newCol;return Object.assign({},e,Object(Ie.a)({},n,Object(De.a)(Object(De.a)({},e[n]),{},{row:a,col:o})))},sa=function(e,t){var n=t.id,a=t.newName;return Object.assign({},e,Object(Ie.a)({},n,Object(De.a)(Object(De.a)({},e[n]),{},{name:a})))},da=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(Ie.a)(n,a,Object(De.a)(Object(De.a)({},e[a]),{},{isContainerInput:!0})),Object(Ie.a)(n,o,Object(De.a)(Object(De.a)({},e[o]),{},{connectionInputs:[].concat(Object(jt.a)(e[o].connectionInputs),[a])})),n))},ma=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(Ie.a)(n,a,Object(De.a)(Object(De.a)({},e[a]),{},{isContainerInput:!1})),Object(Ie.a)(n,o,Object(De.a)(Object(De.a)({},e[o]),{},{connectionInputs:e[o].connectionInputs.filter((function(e){return e!==a}))})),n))},fa=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(Ie.a)(n,a,Object(De.a)(Object(De.a)({},e[a]),{},{isContainerOutput:!0})),Object(Ie.a)(n,o,Object(De.a)(Object(De.a)({},e[o]),{},{connectionOutputs:[].concat(Object(jt.a)(e[o].connectionOutputs),[a])})),n))},pa=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(Ie.a)(n,a,Object(De.a)(Object(De.a)({},e[a]),{},{isContainerInput:!1})),Object(Ie.a)(n,o,Object(De.a)(Object(De.a)({},e[o]),{},{connectionOutputs:e[o].connectionOutputs.filter((function(e){return e!==a}))})),n))},va=function(e,t){var n,a,o=t.modID,r=t.controlID,c=t.actualModID,i=t.name,l=e[o].parentID;return e[o].moduleType===Y?Object.assign({},e,(n={},Object(Ie.a)(n,o,Object(De.a)(Object(De.a)({},e[o]),{},{containerControls:e[o].containerControls.map((function(e){return e.controlID!==r||e.actualModID!==c?e:Object(De.a)(Object(De.a)({},e),{},{markedToContainer:!0})}))})),Object(Ie.a)(n,l,Object(De.a)(Object(De.a)({},e[l]),{},{containerControls:[].concat(Object(jt.a)(e[l].containerControls),[{modID:o,controlID:r,actualModID:c,name:i,markedToContainer:!1}])})),n)):Object.assign({},e,(a={},Object(Ie.a)(a,c,Object(De.a)(Object(De.a)({},e[c]),{},{controlData:Object(De.a)(Object(De.a)({},e[c].controlData),{},Object(Ie.a)({},r,Object(De.a)(Object(De.a)({},e[c].controlData[r]),{},{markedToContainer:!0})))})),Object(Ie.a)(a,l,Object(De.a)(Object(De.a)({},e[l]),{},{containerControls:[].concat(Object(jt.a)(e[l].containerControls),[{modID:o,controlID:r,actualModID:c,name:i,markedToContainer:!1}])})),a))},ba=function(e,t){var n,a,o=t.modID,r=t.controlID,c=t.actualModID,i=e[o].parentID;return e[o].moduleType===Y?Object.assign({},e,(n={},Object(Ie.a)(n,o,Object(De.a)(Object(De.a)({},e[o]),{},{containerControls:e[o].containerControls.map((function(e){return e.controlID!==r||e.actualModID!==c?e:Object(De.a)(Object(De.a)({},e),{},{markedToContainer:!1})}))})),Object(Ie.a)(n,i,Object(De.a)(Object(De.a)({},e[i]),{},{containerControls:e[i].containerControls.filter((function(e){return e.modID!==o||e.controlID!==r||e.actualModID!==c}))})),n)):Object.assign({},e,(a={},Object(Ie.a)(a,c,Object(De.a)(Object(De.a)({},e[c]),{},{controlData:Object(De.a)(Object(De.a)({},e[c].controlData),{},Object(Ie.a)({},r,Object(De.a)(Object(De.a)({},e[c].controlData[r]),{},{markedToContainer:!1})))})),Object(Ie.a)(a,i,Object(De.a)(Object(De.a)({},e[i]),{},{containerControls:e[i].containerControls.filter((function(e){return e.modID!==o||e.controlID!==r||e.actualModID!==c}))})),a))},wa=function(e,t){var n=t.name,a=t.parentModID,o=(t.modID,t.controlID),r=t.actualModID,c=e[a];return Object.assign({},e,Object(Ie.a)({},a,Object(De.a)(Object(De.a)({},c),{},{containerControls:c.containerControls.map((function(e){return e.controlID!==o||e.actualModID!==r?e:Object(De.a)(Object(De.a)({},e),{},{name:n})}))})))},Oa=function(e,t){var n=t.modID,a=t.controlID,o=t.newValue;return Object.assign({},e,Object(Ie.a)({},n,Object(De.a)(Object(De.a)({},e[n]),{},{controlData:Object(De.a)(Object(De.a)({},e[n].controlData),{},Object(Ie.a)({},a,Object(De.a)(Object(De.a)({},e[n].controlData[a]),{},{value:o})))})))},ga=function(e,t){var n=t.modID,a=t.controlID,o=t.newRange;return Object.assign({},e,Object(Ie.a)({},n,Object(De.a)(Object(De.a)({},e[n]),{},{controlData:Object(De.a)(Object(De.a)({},e[n].controlData),{},Object(Ie.a)({},a,Object(De.a)(Object(De.a)({},e[n].controlData[a]),{},{range:o,value:ae(e[n].controlData[a].value,o)})))})))},ha={project:{id:"project",name:"project",row:0,col:0,moduleType:Y,controlData:{open:{controlType:X,paramID:"n/a"}},connectionInputs:[],connectionOutputs:[],inputs:[],outputs:[],parentID:null,childModules:[],isBaseContainer:!0,isContainerInput:!1,isContainerOutput:!1,containerControls:[]}},Ia=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ha,t=arguments.length>1?arguments[1]:void 0;if(!t)return e;switch(t.type){case"ADD_MODULE":return la(e,t);case"MOVE_MODULE":return ua(e,t);case"RENAME_MODULE":return sa(e,t);case"MARK_CONTAINER_INPUT":return da(e,t);case"UNMARK_CONTAINER_INPUT":return ma(e,t);case"MARK_CONTAINER_OUTPUT":return fa(e,t);case"UNMARK_CONTAINER_OUTPUT":return pa(e,t);case"MARK_CONTAINER_CONTROL":return va(e,t);case"UNMARK_CONTAINER_CONTROL":return ba(e,t);case"UPDATE_CONTROL_DATA":return Oa(e,t);case"UPDATE_CONTROL_RANGE":return ga(e,t);case"RENAME_CONTAINER_CONTROL":return wa(e,t);default:return e}},Da=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"project",t=arguments.length>1?arguments[1]:void 0;if(!t)return e;switch(t.type){case"DOWN_1_BASE":case"CHANGE_BASE":return t.newID;default:return e}},ja=function(e,t,n){var a,o=n.fromID,r=n.toID,c=n.param,i=n.outputIndex,l=n.inputIndex,u=n.containerOutputChildID,s=n.containerInputChildID,d=ie(0,Object.keys(t).length);return{newModules:Object.assign({},e,(a={},Object(Ie.a)(a,o,Object(De.a)(Object(De.a)({},e[o]),{},{outputs:[].concat(Object(jt.a)(e[o].outputs),[d])})),Object(Ie.a)(a,r,Object(De.a)(Object(De.a)({},e[r]),{},{inputs:[].concat(Object(jt.a)(e[r].inputs),[d])})),a)),newConnections:Object(De.a)(Object(De.a)({},t),{},Object(Ie.a)({},d,{connectionID:d,fromID:o,toID:r,param:c,outputIndex:i,inputIndex:l,actualOutputID:u,actualInputID:s}))}},Ca=function(e,t,n){var a,o=n.connectionID,r=t[o],c=r.fromID,i=r.toID,l=r.actualOutputID,u=r.actualInputID;return{newModules:Object.assign({},e,(a={},Object(Ie.a)(a,c,Object(De.a)(Object(De.a)({},e[c]),{},{outputs:e[c].outputs.filter((function(e){return e!==o}))})),Object(Ie.a)(a,i,Object(De.a)(Object(De.a)({},e[i]),{},{inputs:e[i].inputs.filter((function(e){return e!==o}))})),a),l?Object(Ie.a)({},l,Object(De.a)(Object(De.a)({},e[l]),{},{outputs:e[l].outputs.filter((function(e){return e!==o}))})):{},u?Object(Ie.a)({},u,Object(De.a)(Object(De.a)({},e[u]),{},{inputs:e[c].outputs.filter((function(e){return e!==o}))})):{}),newConnections:ht(t,[o])}},Ea=function(e,t,n){var a=n.id,o=e[a].parentID,r=e[a].moduleType===Y?function(e,t){return[e].concat(Object(jt.a)(Ct(e,t)))}(a,e):[a],c=e[a].moduleType===Y?[].concat(Object(jt.a)(e[a].inputs),Object(jt.a)(e[a].outputs),Object(jt.a)(Et(t,r))):[].concat(Object(jt.a)(e[a].inputs),Object(jt.a)(e[a].outputs)),i=ht(e,r);return{newModules:Object.assign({},Object.fromEntries(Object.entries(i).map((function(t){return[t[0],Object(De.a)(Object(De.a)({},t[1]),{},{inputs:t[1].inputs.filter((function(t){return!ee(t,[].concat(Object(jt.a)(e[a].inputs),Object(jt.a)(e[a].outputs)))})),outputs:t[1].outputs.filter((function(t){return!ee(t,[].concat(Object(jt.a)(e[a].inputs),Object(jt.a)(e[a].outputs)))}))})]}))),Object(Ie.a)({},o,Object(De.a)(Object(De.a)({},e[o]),{},{childModules:e[o].childModules.filter((function(e){return e!==a})),connectionInputs:e[o].connectionInputs.filter((function(e){return e!==a})),connectionOutputs:e[o].connectionOutputs.filter((function(e){return e!==a})),containerControls:e[o].containerControls.filter((function(e){return e.modID!==a}))}))),newConnections:ht(t,c)}},ya=function(e,t,n){var a,o=n.containerID,r=n.newModules,c=n.newConnections,i=n.row,l=n.col,u=n.parentID;return{newModules:Object.assign({},e,r,(a={},Object(Ie.a)(a,u,Object(De.a)(Object(De.a)({},e[u]),{},{childModules:[].concat(Object(jt.a)(e[u].childModules),[o])})),Object(Ie.a)(a,o,Object(De.a)(Object(De.a)({},r[o]),{},{parentID:u,row:i,col:l,isBaseContainer:!1})),a)),newConnections:Object.assign({},t,c)}},Na=function(e,t,n){switch(n.type){case"ADD_CONNECTION":return ja(e,t,n);case"REMOVE_CONNECTION":return Ca(e,t,n);case"REMOVE_MODULE":return Ea(e,t,n);case"MERGE_CONTAINER":return ya(e,t,n);default:return{newModules:e,newConnections:t}}},xa={modules:Ia(),connections:{},baseContainerID:Da()};function Ta(e,t){return"ADD_CONNECTION"===t.type||"REMOVE_CONNECTION"===t.type||"REMOVE_MODULE"===t.type||"MERGE_CONTAINER"===t.type?Na(e.modules,e.connections,t):{newModules:Ia(e.modules,t),newConnections:e.connections}}var Ma=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xa,t=arguments.length>1?arguments[1]:void 0;if("RESTORE_FROM_STATE"===t.type){var n=t.state;return Object.assign(n,n.connections?{}:{connections:{}})}var a=Ta(e,t),o=a.newModules,r=a.newConnections;return{modules:o,connections:r,baseContainerID:Da(e.baseContainerID,t)}},Sa=Object(ca.createStore)(Ma,Object(ia.composeWithDevTools)());c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(se.a,{store:Sa},o.a.createElement(ra,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[44,1,2]]]);
//# sourceMappingURL=main.0e0ffa41.chunk.js.map