(this["webpackJsonpspace-machine"]=this["webpackJsonpspace-machine"]||[]).push([[0],{131:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(51),c=n.n(r),i=(n(90),n(9)),u=n(16),l=-1,s=100,d=50,m=0,f=Object(u.a)({Bounder:{backgroundImage:"url(https://i.imgur.com/mSjoh6M.jpg)",backgroundPosition:"center",width:"100vw",height:"100vh",display:"flex",fontSize:"calc(20px + 2vmin)",color:"white",position:"absolute",top:"0px",left:"0px",userSelect:"none",zIndex:l,overflow:"hidden"},ModuleViewBounder:{minWidth:"60vw",height:"100vh",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",zIndex:m,overflow:"scroll","&::-webkit-scrollbar":{width:"0px"}}}),p=n(8),v=n(6),b="CONTAINER",w="VALUE",g=function(e,t,n,a,o,r,c,i,u){return{type:"ADD_MODULE",moduleType:n,id:e,name:t,controlData:a,row:r,col:c,parentID:o,connectionInputs:i,connectionOutputs:u}},O=function(e,t,n){return{type:"MOVE_MODULE",id:e,newRow:t,newCol:n}},h=function(e,t,n,a){return{type:"MARK_CONTAINER_CONTROL",modID:e,controlID:t,actualModID:n,name:a}},I=function(e,t,n){return{type:"UNMARK_CONTAINER_CONTROL",modID:e,controlID:t,actualModID:n}},C=function(e,t,n){return{type:"UPDATE_CONTROL_DATA",modID:e,controlID:t,newValue:n}},D=function(e,t,n){return{type:"UPDATE_CONTROL_RANGE",modID:e,controlID:t,newRange:n}},j=function(e,t,n,a,o,r,c){return{type:"ADD_CONNECTION",fromID:e,toID:t,param:n,outputIndex:a,inputIndex:o,containerOutputChildID:r,containerInputChildID:c}},E=function(e){return{type:"REMOVE_CONNECTION",connectionID:e}},y=function(e,t,n,a,o,r){return{type:"MERGE_CONTAINER",containerID:e,newModules:t,newConnections:n,parentID:a,row:o,col:r}};function N(e){return{type:"RESTORE_FROM_STATE",state:e}}var x=new(window.AudioContext||window.webkitAudioContext);var S=function(e){var t=x.createConstantSource();t.offset.value=e?e.value.value:0;var n={value:function(e){t.offset.value=Number(e)},kill:function(){t.stop()}};return t.start(),{audioNode:t,connectingParamIDs:["offset"],controlSetFuncs:n}},M=["lowpass","lowshelf","highpass","highshelf","allpass","bandpass","notch","peaking"],T=["frequency","detune","Q","gain"];var k=function(e){var t=x.createBiquadFilter();e&&(t.type=e["set type"].value,t.frequency.value=e.frequency.value,t.detune.value=e.detune.value,t.Q.value=e.Q.value,t.gain.value=e.gain.value);var n={"set type":function(e){t.type=e},frequency:function(e){t.frequency.value=Number(e)},detune:function(e){t.detune.value=Number(e)},Q:function(e){t.Q.value=Number(e)},gain:function(e){t.gain.value=Number(e)}};return{audioNode:t,typeTypes:M,connectingParamIDs:T,controlSetFuncs:n}};var R=function(e){x.resume();var t=x.createGain();t.connect(x.destination),t.gain.value=e?e["master gain"].value:1;var n={"master gain":function(e){t.gain.value=Number(e)},resume:function(e){x.resume()},suspend:function(e){x.suspend()}};return{audioNode:t,connectingParamIDs:[],controlSetFuncs:n}};var A=function(e){var t=x.createStereoPanner();e&&(t.pan.value=e.pan.value);var n={pan:function(e){t.pan.value=Number(e)}};return{audioNode:t,connectingParamIDs:["pan"],controlSetFuncs:n}};var F=function(e){var t=x.createDelay(60);e&&(t.delayTime.value=e["delay time"].value);var n={"delay time":function(e){t.delayTime.value=Number(e)}};return{audioNode:t,connectingParamIDs:["delayTime"],controlSetFuncs:n}};var P=function(e){var t=x.createDynamicsCompressor();e&&(t.threshold.value=e.threshold.value,t.knee.value=e.knee.value,t.ratio.value=e.ratio.value,t.attack.value=e.attack.value,t.release.value=e.release.value);var n={threshold:function(e){t.threshold.value=Number(e)},knee:function(e){t.knee.value=Number(e)},ratio:function(e){t.ratio.value=Number(e)},attack:function(e){t.attack.value=Number(e)},release:function(e){t.release.value=Number(e)}};return{audioNode:t,connectingParamIDs:["threshold","knee","ratio","attack","release"],controlSetFuncs:n}};var B=function(e){var t=x.createGain();t.gain.value=e?e.gain.value:0;var n={gain:function(e){t.gain.value=Number(e)}};return{audioNode:t,connectingParamIDs:["gain"],controlSetFuncs:n}};var L=["sine","square","triangle","sawtooth"];var z=function(e){var t=x.createOscillator();e&&(t.type=e["set type"].value,t.frequency.value=e.frequency.value,t.detune.value=e.detune.value);var n={"set type":function(e){t.type=e},frequency:function(e){t.frequency.value=Number(e)},detune:function(e){t.detune.value=Number(e)},kill:function(){t.stop()}};return t.start(),{audioNode:t,typeTypes:L,connectingParamIDs:["frequency","detune"],controlSetFuncs:n}};var _=function(e){navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1,latency:0}}).then((function(t){var n=x.createMediaStreamSource(t),a=x.createChannelSplitter(2);n.connect(a);var o={audioNode:a,connectingParamIDs:[],controlSetFuncs:{mute:function(e){t.getAudioTracks()[0].enabled="true"===e}}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,o))}))};var U=function(e){return{connectingParamIDs:[],controlSetFuncs:{}}};var G=function(e){if(e.current){var t={"choose file":function(t){e.current.src=t},pause:function(){e.current.pause()},play:function(){e.current.play()}};return{audioNode:x.createMediaElementSource(e.current),ref:e,connectingParamIDs:[],controlSetFuncs:t}}return null};function W(e){for(var t,n="number"===typeof e?e:50,a=new Float32Array(44100),o=Math.PI/180,r=0;r<44100;++r)t=2*r/44100-1,a[r]=(3+n)*t*20*o/(Math.PI+n*Math.abs(t));return a}var H=function(e){var t=x.createWaveShaper();t.curve=W(e?e.amount.value:0);var n={amount:function(e){t.curve=W(Number(e))},oversample:function(e){var n=Math.floor(Number(e));t.oversample=n<2?"none":n<4?"2x":"4x"}};return{audioNode:t,connectingParamIDs:[],controlSetFuncs:n}};var K=function(e){var t=x.createAnalyser();t.fftSize=1024;var n=t.frequencyBinCount;return{audioNode:t,controlSetFuncs:{"time graph":function(){}},connectingParamIDs:[],timeArray:new Float32Array(n),bufferLength:n}};var V=function(e){var t=x.createConstantSource();t.offset.value=0;var n=.1,a=.2,o=1,r=.1;e&&(n=e.attack.value,a=e.decay.value,o=e.sustain.value,r=e.release.value);var c={trigger:function(e){var c=x.currentTime;"on"===e?(t.offset.linearRampToValueAtTime(1,c+n),t.offset.setTargetAtTime(o,c+n,a)):(t.offset.cancelAndHoldAtTime(c),t.offset.setTargetAtTime(0,c,r))},attack:function(e){n=Number(e)},decay:function(e){a=Number(e)},sustain:function(e){o=Number(e)},release:function(e){r=Number(e)}};return t.start(),{audioNode:t,connectingParamIDs:[],controlSetFuncs:c}};var q=10*x.sampleRate;var Y=function(e){for(var t=x.createBuffer(1,q,x.sampleRate),n=t.getChannelData(0),a=0;a<q;a++)n[a]=2*Math.random()-1;var o=x.createBufferSource();return o.buffer=t,o.loop=!0,o.start(),{audioNode:o,connectingParamIDs:[],controlSetFuncs:{}}},Z=n(17),Q=n(133);function J(e,t,n){var a=!1;return e.map((function(o,r){return a?0:n*r<t?e[n*r]:(a=!0,0)}))}function X(e,t){return e*x.sampleRate/(2*t)}var $=function(e){var t=x.createAnalyser();t.fftSize=Math.pow(2,15),t.smoothingTimeConstant=0;var n=t.frequencyBinCount,a=new Float32Array(n),o={tuner:function(){t.getFloatFrequencyData(a);for(var e=0,o=0,r=function(e,t,n){for(var a=Math.min.apply(Math,Object(Z.a)(e)),o=Object(Z.a)(e.map((function(e){return e-a}))),r=Object(Z.a)(o),c=2;c<=n;c++)o=Object(Q.a)(o,J(r,t,c));return o}(a,n,5),c=0;c<n;c++)r[c]>o&&(o=r[c],e=c);return[X(e,n),a[e]]}};return{audioNode:t,controlSetFuncs:o,connectingParamIDs:[],bufferLength:n,freqArray:a}};var ee=function(e){var t=x.createAnalyser();t.fftSize=Math.pow(2,10);var n=t.frequencyBinCount,a=new Float32Array(n),o=new Float32Array(n),r={"visualizer-update":function(){t.getFloatFrequencyData(o)}};return{audioNode:t,controlSetFuncs:r,connectingParamIDs:[],timeArray:a,freqArray:o,bufferLength:n}};var te=function(){window.addModule=function(e,t,n,a,o,r,c){switch(a){case"OSCILLATOR":var i=z(),u={"set type":{controlType:"TYPE",paramID:"type",value:(ue=i.audioNode).type},frequency:{controlType:w,paramID:"frequency",value:ue.frequency.value,range:[0,440]},detune:{controlType:w,paramID:"detune",value:ue.detune.value,range:[-50,50]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,i)),o(g(e,t,a,u,n,r,c,[],["0"]));break;case"GAIN":var l=B(),s={gain:{controlType:w,paramID:"gain",value:0,range:[0,1]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,l)),o(g(e,t,a,s,n,r,c,["0"],["0"]));break;case"OUTPUT":var d=R(),m={"master gain":{controlType:w,paramID:"gain",value:1,range:[0,1],maxRange:[0,20]},resume:{controlType:"BUTTON",paramID:"n/a"},suspend:{controlType:"BUTTON",paramID:"n/a"}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,d)),o(g(e,t,a,m,n,r,c,["0"],[]));break;case"AUTOFILTER":var f=k(),O={"set type":{controlType:"TYPE",paramID:"type",value:(ie=f.audioNode).type},frequency:{controlType:w,paramID:"frequency",value:ie.frequency.value,range:[0,x.sampleRate/2],maxRange:[0,x.sampleRate/2]},detune:{controlType:w,paramID:"detune",value:ie.detune.value,range:[-50,50],maxRange:[-153600,153600]},Q:{controlType:w,paramID:"Q",value:ie.Q.value,range:[1e-4,1e3],maxRange:[1e-4,1e3]},gain:{controlType:w,paramID:"gain",value:ie.gain.value,range:[-40,40],maxRange:[-40,40]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,f)),o(g(e,t,a,O,n,r,c,["0"],["0"]));break;case"KOMPRESSOR":var h=P(),I=(ce=h.audioNode,{threshold:{controlType:w,paramID:"threshold",value:ce.threshold.value,range:[-100,0],maxRange:[-100,0]},knee:{controlType:w,paramID:"knee",value:ce.knee.value,range:[0,40],maxRange:[0,40]},ratio:{controlType:w,paramID:"ratio",value:ce.ratio.value,range:[1,20],maxRange:[1,20]},attack:{controlType:w,paramID:"attack",value:ce.attack.value,range:[0,1],maxRange:[0,1]},release:{controlType:w,paramID:"release",value:ce.release.value,range:[0,1],maxRange:[0,1]}});window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,h)),o(g(e,t,a,I,n,r,c,["0"],["0"]));break;case"STEREO_PANNER":var C=A(),D={pan:{controlType:w,paramID:"pan",value:0,range:[-1,1],maxRange:[-1,1]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,C)),o(g(e,t,a,D,n,r,c,["0"],["0"]));break;case"SIGNAL_DELAY":var j=F(),E={"delay time":{controlType:w,paramID:"delayTime",value:0,range:[0,2],maxRange:[0,60]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,j)),o(g(e,t,a,E,n,r,c,["0"],["0"]));break;case"CONSTANT":var y=S(),N={value:{controlType:w,paramID:"offset",value:0,range:[-100,100]},kill:{controlType:"BUTTON",paramID:"n/a"}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,y)),o(g(e,t,a,N,n,r,c,[],["0"]));break;case"MEDIA_ELEMENT":var M={"choose file":{controlType:"FILE"},play:{controlType:"BUTTON"},pause:{controlType:"BUTTON"}};window.addAudioTag(e),window.reRenderAudioTags(),o(g(e,t,a,M,n,r,c,[],["0"]));break;case"LINE_IN":_(e),o(g(e,t,a,{mute:{controlType:"SWITCH",paramID:"n/a",value:!1}},n,r,c,[],["0 (L)","1 (R)"]));break;case b:var T=U(e),L={};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,T)),o(g(e,t,a,L,n,r,c,[],[]));break;case"DISTORTION":var G=H(),W={amount:{controlType:w,value:0,range:[0,1e3]},oversample:{controlType:w,value:0,range:[0,4],maxRange:[0,4]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,G)),o(g(e,t,a,W,n,r,c,["0"],["0"]));break;case"ANALYZER":var q=K(),Z={"time graph":{controlType:"GRAPH",range:[-1.5,1.5]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,q)),o(g(e,t,a,Z,n,r,c,["0"],["0"]));break;case"ENVELOPED_TRIGGER":var Q=V(),J={trigger:{controlType:"PAD"},attack:{controlType:w,value:.1,range:[.001,1],maxRange:[.001,100]},decay:{controlType:w,value:.2,range:[.001,1],maxRange:[.001,100]},sustain:{controlType:w,value:1,range:[0,1],maxRange:[0,100]},release:{controlType:w,value:.1,range:[.001,1],maxRange:[.001,100]}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,Q)),o(g(e,t,a,J,n,r,c,[],["0"]));break;case"WHITE_NOISE":var X=Y(),te={};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,X)),o(g(e,t,a,te,n,r,c,[],["0"]));break;case"TUNER":var ne=$(),ae={tuner:{controlType:"TUNER_CONTROL"}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,ne)),o(g(e,t,a,ae,n,r,c,["0"],["0"]));break;case"VISUALIZER":var oe=ee(),re={"visualizer-update":{controlType:"VISUALIZER_CONTROL"}};window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,oe)),o(g(e,t,a,re,n,r,c,["0"],["0"]))}var ce,ie,ue}};function ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return{isOpen:e,pointerId:t,onPointerMove:n,onPointerUp:a}}var ae=Object(u.a)({PointerLayer:{width:"100vw",height:"100vh",position:"absolute",top:0,left:0,zIndex:300}});var oe=function(e){var t=e.pointerLayerData,n=e.resetPointerLayerData,r=ae(),c=t.pointerId,i=t.onPointerMove,u=t.onPointerUp,l=Object(a.useRef)(null);return Object(a.useEffect)((function(){})),o.a.createElement("div",{className:r.PointerLayer,ref:l,onPointerMove:function(e){e.pointerId===c&&i(e)},onPointerUp:function(e){e.pointerId===c&&(u(e),n())}})},re=n(77),ce=n.n(re),ie=n(78),ue=n.n(ie);var le=function(){var e=ce()(),t=ue()("http://192.168.1.64:30300");e.configure(t.fetch(window.fetch)),window.projectSaveService=e.service("project-save-service"),window.containerSaveService=e.service("container-save-service")};var se=function(){navigator.userAgent.toLowerCase().indexOf(" electron/")>-1?window.usingElectron=!0:window.usingElectron=!1},de=n(11),me="#282c34",fe="#0000009e",pe="#00347d",ve="#001b40",be="#000000c4",we="#000000b3",ge="#282c34",Oe="#c0c0c038",he="#37538a",Ie="white",Ce="#007ab3",De="#ffffff61",je="#ffffff60",Ee="black",ye="#cc00006e",Ne="#cc0000",xe="red",Se="#0000009e",Me="white",Te="#cc00006e",ke="white",Re="#da1212",Ae="blue",Fe="#028174",Pe="#7D1551",Be="#4C4141",Le="#CA5F3C",ze="#00347D",_e="#00802da6",Ue="#cc00006e",Ge="black",We="#08101deb",He="#282c349c",Ke="transparent",Ve="#1d1d2b",qe="white",Ye="#00802d",Ze="#543737c7",Qe={width:"400",toggleWidth:"2vmin",item:"9vmin"},Je={iconGrid:"12vmin",gutterGrid:"6vmin",icon:"10vmin",bigIconWidth:"25vmin",bigIconHeight:"35vmin"},Xe={large:"calc(25px + 2.8vmin)",medium:"calc(20px + 2.4vmin)",small:"calc(12px + 1.2vmin)",xsmall:"calc(8px + 1vmin)",xxsmall:"calc(7px + .8vmin)"},$e={size:"2.5vmin",borderRadius:"2.5vmin",smallSize:"1.5vmin",smallBorderRadius:"1.5vmin"},et={size:7,markerWidth:.5,markerHeight:1.3,rotRange:[-150,150],sensitivity:1,borderWidth:8},tt={diameter:3},nt={leftBarWidth:"20vmin",iconRouterWidth:"60vmin",height:"60vmin"},at=Object(u.a)({ContextMenuBounder:{width:"100vw",height:"100vh",backgroundColor:"transparent",position:"fixed",overflow:"hidden",top:0,left:0,zIndex:d,opacity:1,visibility:function(e){return e.isOpen?"visible":"hidden"}},ContextMenu:{maxHeight:"12em",backgroundColor:We,padding:".2em",borderRadius:".2em",display:"flex",flexDirection:"column",position:"fixed",top:-1e3,left:-1e3,overflowY:"scroll","&::-webkit-scrollbar":{width:"0em"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},MenuItem:{borderStyle:"solid",borderColor:"transparent","&:hover":{borderColor:Ge}}});var ot=function(e){var t=e.children,n=e.showIf;return o.a.createElement(a.Fragment,null,n?t:null)};var rt=function(e){var t=e.children,n=e.onClose,r=e.bounderStyle,c=e.style,i=e.event,u=e.isOpen,l=at({isOpen:u}),s=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(s.current)if(i){var e=(a=i,(o=s).current?{top:window.innerHeight-a.pageY>=o.current.offsetHeight?a.pageY:window.innerHeight-o.current.offsetHeight,left:window.innerWidth-a.pageX>=o.current.offsetWidth?a.pageX:window.innerWidth-o.current.offsetWidth}:{top:-1e3,left:-1e3}),t=e.top,n=e.left;s.current.style.top="".concat(t,"px"),s.current.style.left="".concat(n,"px")}else s.current.style.top="-1000px",s.current.style.left="-1000px";var a,o}),[i]),o.a.createElement("div",{className:l.ContextMenuBounder,onPointerDown:function(){s.current&&(s.current.style.top="-1000px",s.current.style.left="-1000px"),n()},style:r},o.a.createElement("div",{className:l.ContextMenu,style:c,ref:s,onPointerDown:function(e){e.stopPropagation()}},o.a.createElement(ot,{showIf:u},t)))},ct=Object(u.a)({FlexRow:{display:"flex",flexDirection:"row",justifyContent:function(e){return e.justifyContent},alignItems:function(e){return e.alignItems},flexWrap:function(e){return e.flexWrap}},FlexCol:{display:"flex",flexDirection:"column",justifyContent:function(e){return e.justifyContent},alignItems:function(e){return e.alignItems}}});var it=function(e){var t=e.className,n=e.children,a=e.style,r=e.ref,c=e.justifyContent,i=e.alignItems,u=e.flexWrap,l=ct({justifyContent:c,alignItems:i,flexWrap:u});return o.a.createElement("div",{className:t?"".concat(l.FlexRow," ").concat(t):l.FlexRow,style:a,ref:r},n)};var ut=function(e){switch(e){case"LINE_IN":case"OSCILLATOR":case"MEDIA_ELEMENT":case"CONSTANT":case"ENVELOPED_TRIGGER":case"WHITE_NOISE":return Fe;case"GAIN":case"AUTOFILTER":case"KOMPRESSOR":case"SIGNAL_DELAY":case"STEREO_PANNER":case"DISTORTION":return Pe;case b:return Be;case"OUTPUT":return Le;case"ANALYZER":case"TUNER":case"VISUALIZER":return ze}},lt=Object(u.a)({AutoPlacingGrid:{display:"grid",gridTemplateRows:function(e){var t=e.numRows;return"repeat(".concat(t,", auto)")},gridTemplateColumns:function(e){var t=e.numCols;return"repeat(".concat(t,", auto)")},gridAutoFlow:function(e){return e.direction},gridAutoRows:function(e){return e.numRows?null:"auto"},gridAutoColumns:function(e){return e.numCols?null:"auto"},gap:function(e){return e.gap},justifyItems:"center"}});var st=function(e){var t=e.children,n=e.className,a=e.style,r=e.numRows,c=e.numCols,i=e.direction,u=e.gap,l=lt({numRows:r,numCols:c,direction:i,gap:u});return o.a.createElement("div",{className:n?"".concat(l.AutoPlacingGrid," ").concat(n):l.AutoPlacingGrid,style:a},t)};var dt=function(e){var t=e.className,n=e.children,a=e.style,r=e.ref,c=e.onDrop,i=e.onDragOver,u=e.justifyContent,l=e.alignItems,s=ct({justifyContent:u,alignItems:l});return o.a.createElement("div",{className:t?"".concat(s.FlexCol," ").concat(t):s.FlexCol,style:a,ref:r,onDrop:c,onDragOver:i},n)};function mt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;0===n.length?e.audioNode.connect(t.audioNode,a,o):t.audioNode[n]?e.audioNode.connect(t.audioNode[n],a):alert("param does not exist")}function ft(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0;0===n.length?"number"===typeof a?e.audioNode.disconnect(t.audioNode,a):e.audioNode.disconnect(t.audioNode):t.audioNode[n]?"number"===typeof a?e.audioNode.disconnect(t.audioNode[n],a):e.audioNode.disconnect(t.audioNode[n]):alert("param does not exist")}function pt(e,t,n,a,o){for(var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",c=0;c<t.outputs.length;c++){var i=e[t.outputs[c]],u=i.toID,l=i.actualInputID,s=i.param,d=i.outputIndex,m=i.inputIndex,f=l||u;if(f===n&&r===s&&a===d&&o===m)return!0}return!1}function vt(e,t,n,a,o,r,c,i,u,l){var s=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",d=o[e],m=window.audioModules,f=d.moduleType===b,p=o[n].moduleType===b;pt(r,d,a,i,u,s)?alert("modules already connected"):(mt(m[t],m[a],s,i,u),c(j(e,n,s,i,u,f?t:void 0,p?a:void 0)),window.flashNotification(Ye,"connection created"),l&&l())}var bt=Object(u.a)({Module:{borderRadius:"1.5vmin",display:"flex",flexDirection:"column",alignItems:"center",flexGrow:1,flexShrink:1,"&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"},padding:".2em .5em",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},IconConnector:{backgroundColor:xe,width:$e.size,height:$e.size,borderRadius:$e.borderRadius,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderStyle:"solid",borderColor:"transparent","&:hover":{cursor:"pointer",borderColor:"white"}},ConnectorBounder:{alignItems:"center"},Name:{whiteSpace:"noWrap",fontSize:Xe.medium,marginBottom:".2em","&:hover":{cursor:"pointer"}},ConnectorName:{whiteSpace:"noWrap",fontSize:Xe.small},ParamName:{whiteSpace:"noWrap",fontSize:Xe.small},ConnectionReciever:{backgroundColor:"black",width:$e.size,height:$e.size,borderRadius:$e.borderRadius,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderStyle:"solid",borderColor:Re,borderWidth:".25em"},SmallConnectionReciever:{backgroundColor:"black",width:$e.smallSize,height:$e.smallSize,borderRadius:$e.smallBorderRadius,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderStyle:"solid",borderColor:Ae,borderWidth:".2em"}});var wt=function(e){var t=e.modID,n=e.startsBig,r=e.fromID,c=e.toID,u=e.onClose,l=bt(),s=Object(de.c)((function(e){return e.modules[t]})),d=Object(de.c)((function(e){return e})),m=d.modules,f=d.connections,p=window.audioModules[t],v=Object(a.useState)(n),b=Object(i.a)(v,2),w=b[0],g=b[1],O=Object(de.b)();return o.a.createElement("div",{className:l.Module,style:{backgroundColor:ut(s.moduleType)}},o.a.createElement("div",{className:l.Name,style:{marginBottom:".2em"},onClick:function(){g(!w)}},s.name),o.a.createElement(it,{style:{justifyContent:"center"}},o.a.createElement(dt,{style:{marginRight:0!==p.connectingParamIDs.length?".4em":"0em"}},w?s.connectionInputs.map((function(e,n){return o.a.createElement(dt,{key:n},o.a.createElement("div",{className:l.ConnectionReciever,onDragOver:function(e){e.preventDefault()},onDrop:function(e){e.preventDefault();var a=e.dataTransfer.getData("actualFromID"),o=Number(e.dataTransfer.getData("outputIndex"));vt(r,a,c,t,m,f,O,o,n,u)}}),1!==s.connectionInputs.length?e:null)})):null),0===p.connectingParamIDs.length?null:o.a.createElement(st,{direction:"row",numCols:"2",gap:".2em"},w?p.connectingParamIDs.map((function(e,n){return o.a.createElement(dt,{style:{alignItems:"center"},key:n,onDragOver:function(e){e.preventDefault()},onDrop:function(a){a.preventDefault();var o=a.dataTransfer.getData("actualFromID"),i=Number(a.dataTransfer.getData("outputIndex"));vt(r,o,c,t,m,f,O,i,n,u,e)}},o.a.createElement("div",{className:l.SmallConnectionReciever}),o.a.createElement("div",{className:l.ParamName},e))})):null)))};var gt=function e(t){var n=t.modID,r=t.startsBig,c=t.fromID,u=t.toID,l=t.isFromContainer,s=t.onClose,d=t.isBase,m=bt(),f=Object(de.c)((function(e){return e.modules})),p=f[n],v=p.connectionInputs,w=v.length<=2,g=Object(a.useState)(r),O=Object(i.a)(g,2),h=O[0],I=O[1];return o.a.createElement("div",{className:m.Module,style:{backgroundColor:ut(b),maxHeight:d?"60vmin":"40vmin",overflowY:d?"scroll":"visible"}},o.a.createElement("div",{className:m.Name,onClick:function(){I(!h)}},p.name),o.a.createElement(st,{direction:"row",numCols:2,gap:".2em"},h?v.map((function(t,n){return f[t].moduleType===b?o.a.createElement(e,{key:n,modID:t,fromID:c,toID:u,isFromContainer:l,onClose:s,isBase:!1,startsBig:w}):o.a.createElement(wt,{key:n,modID:t,fromID:c,toID:u,onClose:s,startsBig:w})})):null))};var Ot=function(e){var t=e.modID,n=e.startsBig,r=e.isBase,c=bt(),u=Object(de.c)((function(e){return e.modules[t]})),l=Object(a.useState)(n),s=Object(i.a)(l,2),d=s[0],m=s[1];return o.a.createElement("div",{className:c.Module,style:{backgroundColor:ut(u.moduleType),overflow:"visible",marginRight:r?"1em":"0em"}},o.a.createElement("div",{className:c.Name,onClick:function(){m(!d)}},u.name),d?u.connectionOutputs.length>1?o.a.createElement(st,{direction:"row",numCols:"2",gap:".2em"},u.connectionOutputs.map((function(e,n){return o.a.createElement(dt,{className:c.ConnectorBounder,key:n},o.a.createElement("div",{className:c.IconConnector,draggable:!0,onDragStart:function(e){e.dataTransfer.setData("actualFromID",t),e.dataTransfer.setData("outputIndex",n.toString())}}),1===u.connectionOutputs.length?null:o.a.createElement("div",{className:c.ConnectorName},e))}))):o.a.createElement(dt,{className:c.ConnectorBounder},o.a.createElement("div",{className:c.IconConnector,draggable:!0,onDragStart:function(e){e.dataTransfer.setData("actualFromID",t),e.dataTransfer.setData("outputIndex","0")}})):null)};var ht=function e(t){var n=t.modID,r=t.startsBig,c=t.isBase,u=bt(),l=Object(de.c)((function(e){return e.modules})),s=l[n],d=s.connectionOutputs,m=d.length<=2,f=Object(a.useState)(r),p=Object(i.a)(f,2),v=p[0],w=p[1];return o.a.createElement("div",{className:u.Module,style:{backgroundColor:ut(s.moduleType),marginRight:c?"1em":"0em",maxHeight:c?"60vmin":"40vmin",overflowY:c?"scroll":"visible"}},o.a.createElement("div",{className:u.Name,onClick:function(){w(!v)}},s.name),o.a.createElement(st,{direction:"row",numCols:2,gap:".2em"},v?d.map((function(t,n){return l[t].moduleType===b?o.a.createElement(e,{key:n,modID:t,startsBig:m,isBase:!1}):o.a.createElement(Ot,{key:n,modID:t,startsBig:m,isBase:!1})})):null))};function It(e,t,n,a){return{isOpen:e,event:t,fromMod:n,toMod:a}}var Ct=function(){var e=Object(a.useState)(It(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.event,u=n.fromMod,l=n.toMod,s=t[1],d=Object(de.c)((function(e){return e})).modules;window.openConnectionMenu=function(e,t,n){s(It(!0,e,d[t],d[n]))};var m=function(){s(It(!1))};return o.a.createElement(rt,{event:c,isOpen:r,onClose:m,style:{padding:".7em"},bounderStyle:{backgroundColor:"rgba(0,0,0,.4)"}},o.a.createElement(it,null,(null===u||void 0===u?void 0:u.moduleType)===b?o.a.createElement(ht,{modID:null===u||void 0===u?void 0:u.id,startsBig:!0,isBase:!0}):o.a.createElement(Ot,{modID:null===u||void 0===u?void 0:u.id,startsBig:!0,isBase:!0}),(null===l||void 0===l?void 0:l.moduleType)===b?o.a.createElement(gt,{modID:null===l||void 0===l?void 0:l.id,startsBig:!0,fromID:null===u||void 0===u?void 0:u.id,toID:null===l||void 0===l?void 0:l.id,isFromContainer:(null===u||void 0===u?void 0:u.moduleType)===b,onClose:m,isBase:!0}):o.a.createElement(wt,{modID:null===l||void 0===l?void 0:l.id,startsBig:!0,fromID:null===u||void 0===u?void 0:u.id,toID:null===l||void 0===l?void 0:l.id,onClose:m})))},Dt=Object(u.a)({Button:{backgroundColor:Ee,borderColor:"transparent",borderRadius:"1vmin",borderStyle:"solid","&:active":{borderColor:"transparent"},"&:hover":{cursor:function(e){return e.notClickable?"":"pointer"},borderColor:function(e){return e.notClickable?"transparent":Ze}},display:"flex",alignItems:"center",justifyContent:"center",padding:".4em",margin:".3em",textAlign:"center",fontSize:function(e){return e.fontSize},boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"}});var jt=function(e){var t=e.className,n=e.onClick,a=e.children,r=e.style,c=e.onPointerDown,i=e.buttonRef,u=e.onKeyDown,l=e.onContextMenu,s=e.fontSize,d=e.notClickable,m=e.onPointerEnter,f=e.onPointerLeave,p=Dt({fontSize:s,notClickable:d});return o.a.createElement("div",{className:t?"".concat(p.Button," ").concat(t):p.Button,onClick:n,onPointerDown:c,style:r,ref:i,onKeyDown:u,onContextMenu:l,onPointerEnter:m,onPointerLeave:f},a)},Et=n(79),yt=n.n(Et);var Nt=function(e){var t=e.className,n=e.style,a=e.alt;return o.a.createElement("img",{className:t,style:n,src:yt.a,alt:a})},xt=Object(u.a)({DeleteButtonBounder:{backgroundColor:ye,fontSize:Xe.small,padding:".2em .4em","&:hover":{borderColor:ye}},DeleteButtonSVG:{width:"1.5em",height:"1.5em"}});var St=function(e){var t=e.onClick,n=xt();return o.a.createElement(jt,{className:n.DeleteButtonBounder,onPointerDown:function(e){e.stopPropagation()},onClick:t},o.a.createElement(Nt,{className:n.DeleteButtonSVG,alt:"delete"}))};var Mt=function(e){var t=e.modID,n=e.onClose,a=window.audioModules,r=Object(de.b)(),c=Object(de.c)((function(e){return e.connections})),i=Object(de.c)((function(e){return e.modules[t]}));return o.a.createElement(St,{onClick:function(){i.inputs.forEach((function(e){var t=c[e],n=t.fromID,o=t.toID,r=t.param,i=t.outputIndex,u=t.actualOutputID,l=t.actualInputID;ft(a[u||n],a[l||o],r,i)})),i.outputs.forEach((function(e){var t=c[e],n=t.fromID,o=t.toID,r=t.param,i=t.outputIndex,u=t.actualOutputID,l=t.actualInputID;ft(a[u||n],a[l||o],r,i)})),r({type:"REMOVE_MODULE",id:i.id}),n()}})},Tt=Object(u.a)({Connection:{fontSize:Xe.xsmall,backgroundColor:Oe,margin:".5vmin 3vmin",borderRadius:"1vmin",borderColor:"transparent",borderStyle:"solid",minWidth:"30%",padding:"1vmin",display:"flex",justifyContent:"center",alignItems:"center","&:hover":{cursor:"pointer",borderColor:ye},boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},Name:{fontSize:Xe.medium,margin:"1vmin","&:hover":{cursor:"pointer"}},MenuHeader:{fontSize:Xe.small,borderStyle:"none none solid none",margin:"1vmin",whiteSpace:"noWrap"},OpenButton:{fontSize:Xe.small},SaveButton:{fontSize:Xe.small}});function kt(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function Rt(e,t,n){return kt(e,n)&&kt(t,n)}function At(e,t){for(var n=[],a=e;a<t;a++)n.push(a);return n}function Ft(e,t){return Math.min(t[1],Math.max(t[0],e))}function Pt(e,t){return e>=t[0]&&e<=t[1]}function Bt(e,t,n){var a=(e-t[0])/(t[1]-t[0]),o=n[1]-n[0];return n[0]+a*o}var Lt=Object(u.a)({ExtensionMenu:{maxHeight:"12em",maxWidth:"8em",backgroundColor:We,padding:".2em",borderRadius:".2em",display:"flex",flexDirection:"column",position:"fixed",top:-1e3,left:-1e3,overflowY:"scroll","&::-webkit-scrollbar":{width:"0em"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}}});var zt=function(e){var t=e.text,n=e.children,r=Object(a.useState)(!1),c=Object(i.a)(r,2),u=c[0],l=c[1],s=Object(a.useState)(-1),d=Object(i.a)(s,2),m=d[0],f=d[1],p=Lt(),v=Object(a.useRef)(null),b=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(b.current){var e=function(e,t){if(e.current&&t.current){var n,a,o=e.current.getBoundingClientRect().top,r=null===(n=e.current.parentElement)||void 0===n?void 0:n.getBoundingClientRect().left,c=null===(a=e.current.parentElement)||void 0===a?void 0:a.offsetWidth,i=t.current.offsetHeight,u=t.current.offsetWidth;return{top:window.innerHeight-o>=i?o:window.innerHeight-i,left:window.innerWidth-r-c>=u?r+c:r-u}}return{top:-1e3,left:-1e3}}(v,b),t=e.top,n=e.left;b.current.style.top="".concat(t,"px"),b.current.style.left="".concat(n,"px")}})),o.a.createElement(a.Fragment,null,o.a.createElement(jt,{buttonRef:v,fontSize:Xe.small,onPointerEnter:function(){window.clearTimeout(m),l(!0)},onPointerLeave:function(){var e=window.setTimeout((function(){l(!1)}),200);f(e)}},t),o.a.createElement(ot,{showIf:u},o.a.createElement("div",{className:p.ExtensionMenu,ref:b,onPointerEnter:function(){window.clearTimeout(m)},onPointerLeave:function(){var e=window.setTimeout((function(){l(!1)}),200);f(e)}},n)))};var _t=function(e){var t=e.modID,n=e.modules,a=Tt(),r=Object(de.b)(),c=window.audioModules,i=Object(de.c)((function(e){return e.connections})),u=Object(de.c)((function(e){return e.modules[t]}));return o.a.createElement(ot,{showIf:0!==u.inputs.length||0!==u.outputs.length},o.a.createElement(zt,{text:"inputs / outputs"},0===u.inputs.length?null:o.a.createElement("div",{className:a.MenuHeader},"inputs"),u.inputs.map((function(e,t){var l=i[e],s=l.fromID,d=l.param,m=l.outputIndex,f=l.actualOutputID,p=l.actualInputID,v=n[s].name;return o.a.createElement("div",{className:a.Connection,key:s+d+"inp"+t,onClick:function(t){t.stopPropagation(),r(E(e)),ft(c[f||s],c[p||u.id],d,m)},onPointerDown:function(e){e.stopPropagation()}},"".concat(v).concat(f?" - ".concat(n[f].name):"").concat(0!==d.length?" - ".concat(d):""))})),0===u.outputs.length?null:o.a.createElement("div",{className:a.MenuHeader},"outputs"),u.outputs.map((function(e,t){var l=i[e],s=l.toID,d=l.param,m=l.outputIndex,f=l.actualOutputID,p=l.actualInputID,v=n[s].name;return o.a.createElement("div",{className:a.Connection,key:s+d+"out"+t,onClick:function(t){t.stopPropagation(),r(E(e)),ft(c[f||u.id],c[p||s],d,m)},onPointerDown:function(e){e.stopPropagation()}},"".concat(v).concat(p?" - ".concat(n[p].name):"").concat(0!==d.length?" - ".concat(d):""))}))))};var Ut=function(e){var t=e.modules,n=e.modID,r=e.onClose,c=Tt();return o.a.createElement(a.Fragment,null,t[n].moduleType!==b?null:o.a.createElement(jt,{className:c.OpenButton,onClick:function(){window.fillContainerID=n,window.reRenderFillContainer(),r()},onPointerDown:function(e){e.stopPropagation()}},"open"))};var Gt=function(e){var t=e.modules,n=e.modID,r=e.onClose,c=Tt();return o.a.createElement(a.Fragment,null,window.usingElectron&&t[n].moduleType===b?o.a.createElement(jt,{className:c.SaveButton,onClick:function(){window.containerSaveService.find().then((function(e){window.openSpaceDBContainerSaveMenu(e,n,r)})),r()}},"save to spaceDB"):null)},Wt=Object(u.a)({Bounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderRadius:"15px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",userSelect:"none",margin:"10px","&:hover":{cursor:"pointer"},padding:"1vmin"},SwitchSVG:{marginLeft:"1.5vmin",flexShrink:0},Text:{fontSize:function(e){return e.fontSize}}}),Ht=n(28),Kt=2*tt.diameter,Vt=tt.diameter+1,qt=1.5*tt.diameter,Yt=tt.diameter-1,Zt=tt.diameter/4,Qt=(tt.diameter+1)/2;var Jt=function(e){var t=e.text,n=e.onSwitch,r=e.initState,c=e.style,u=e.fontSize,l=Object(a.useState)(r),s=Object(i.a)(l,2),d=s[0],m=s[1],f=Wt({fontSize:u}),p=Object(Ht.b)({cx:"".concat(d?Kt-tt.diameter/2:tt.diameter/2,"vmin"),fill:d?"green":"red",config:{tension:250}});return o.a.createElement("div",{className:f.Bounder,style:c},o.a.createElement("div",{className:f.Text,onClick:function(){n(!d),m(!d)}},t),o.a.createElement("svg",{className:f.SwitchSVG,width:"".concat(Kt,"vmin"),height:"".concat(Vt,"vmin"),onClick:function(){n(!d),m(!d)}},o.a.createElement("rect",{width:"".concat(qt,"vmin"),height:"".concat(Yt,"vmin"),x:"".concat(Zt,"vmin"),y:"".concat(1,"vmin"),rx:"10",ry:"10",fill:me}),o.a.createElement(Ht.a.circle,{cx:p.cx,cy:"".concat(Qt,"vmin"),r:"".concat(tt.diameter/2,"vmin"),fill:p.fill})))};var Xt=function(e){var t=e.selectedModule,n=Object(de.b)(),a=Object(de.c)((function(e){return e.modules})),r=Tt(),c=t.moduleType===b?0!==t.containerControls.length:0!==Object.keys(t.controlData).length;return o.a.createElement(ot,{showIf:c},o.a.createElement(dt,null,o.a.createElement("div",{className:r.MenuHeader}," mark as container control "),o.a.createElement(it,{justifyContent:"center",style:{flexWrap:"wrap",maxWidth:"40vmin"}},t.moduleType===b?t.containerControls.map((function(e,r){var c,i=e.modID,u=e.controlID,l=e.actualModID,s=e.name,d=e.markedToContainer,m=a[i].name,f=!!d;return f&&(c=a[t.parentID].containerControls.filter((function(e){return e.controlID===u&&e.actualModID===l}))[0]),o.a.createElement(it,null,o.a.createElement(Jt,{initState:f,text:s||"".concat(m," - ").concat(u),style:{fontSize:Xe.small,padding:".2em"},key:i+r,onSwitch:function(e){n(e?h(t.id,u,l):I(t.id,u,l))}}),f?o.a.createElement(jt,{fontSize:Xe.xsmall,onClick:function(){window.openControlRenameMenu(u,t.parentID,c)}},"edit"):null)})):null,t.moduleType===b?null:Object.keys(t.controlData).map((function(e,r){var c,i=!!t.controlData[e].markedToContainer;return i&&(c=a[t.parentID].containerControls.filter((function(n){return n.controlID===e&&n.actualModID===t.id}))[0]),o.a.createElement(it,{key:r},o.a.createElement(Jt,{initState:i,text:e,style:{fontSize:Xe.xsmall,padding:"1vmin"},key:e+r,onSwitch:function(a){n(a?h(t.id,e,t.id):I(t.id,e,t.id))}}),i?o.a.createElement(jt,{style:{fontSize:Xe.small},onClick:function(){window.openControlRenameMenu(e,t.parentID,c)}},"edit"):null)})))))},$t={fontSize:Xe.small,padding:".1em"};var en=function(e){var t=e.modID,n=Object(de.b)(),r=Object(de.c)((function(e){return e.baseContainerID})),c=Object(de.c)((function(e){return e.modules[t]})),i=0!==c.connectionInputs.length,u=0!==c.connectionOutputs.length,l=Tt();return o.a.createElement(a.Fragment,null,o.a.createElement(Xt,{selectedModule:c}),o.a.createElement(ot,{showIf:window.fillContainerID!==r&&(i||u)},o.a.createElement("div",{className:l.MenuHeader},"mark as container io"),o.a.createElement(it,{justifyContent:"center"},o.a.createElement(ot,{showIf:i},o.a.createElement(Jt,{style:$t,fontSize:Xe.xsmall,key:c.id+"inputSwitch",text:"input",initState:c.isContainerInput,onSwitch:function(e){n(e?{type:"MARK_CONTAINER_INPUT",id:c.id}:function(e){return{type:"UNMARK_CONTAINER_INPUT",id:e}}(c.id))}})),o.a.createElement(ot,{showIf:u},o.a.createElement(Jt,{style:$t,fontSize:Xe.xsmall,key:c.id+"outputSwitch",text:"output",initState:c.isContainerOutput,onSwitch:function(e){n(e?{type:"MARK_CONTAINER_OUTPUT",id:c.id}:function(e){return{type:"UNMARK_CONTAINER_OUTPUT",id:e}}(c.id))}})))))};var tn=function(e){var t=e.modID,n=e.modules,a=e.onClose,r=Tt();return o.a.createElement(ot,{showIf:n[t].moduleType===b},o.a.createElement(jt,{className:r.SaveButton,onClick:function(){window.openFileContainerSaveMenu(t),a()}},"save to file"))};function nn(e,t,n){return{isOpen:e,event:t,modID:n}}var an=function(){var e,t=Object(a.useState)(nn(!1)),n=Object(i.a)(t,2),r=n[0],c=r.isOpen,u=r.event,l=r.modID,s=n[1];window.openModuleContextMenu=function(e,t){s(nn(!0,e,t))};var d=function(){s(nn(!1))},m=Tt(),f=Object(de.c)((function(e){return e.modules}));return o.a.createElement(rt,{onClose:d,event:u,isOpen:c},o.a.createElement("div",{className:m.Name,title:"rename module",onClick:function(){window.openModuleRenameMenu(l)}},null===(e=f[l])||void 0===e?void 0:e.name),o.a.createElement(Ut,{modules:f,modID:l,onClose:d}),o.a.createElement(_t,{modID:l,modules:f}),o.a.createElement(Gt,{modules:f,modID:l,onClose:d}),o.a.createElement(tn,{modules:f,modID:l,onClose:d}),o.a.createElement(en,{modID:l}),o.a.createElement(Mt,{modID:l,onClose:d}))};var on=function(e){var t=e.saveName,n=e.onClose;return o.a.createElement(St,{onClick:function(){window.containerSaveService.remove(t).then((function(e){console.log(e),window.refreshSpaceDBModules(),n()}))}})};function rn(e,t,n){return{isOpen:e,event:t,saveName:n}}var cn=function(){var e=Object(a.useState)(rn(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.event,u=n.saveName,l=t[1];return window.openSDBModuleContextMenu=function(e,t){l(rn(!0,e,t))},o.a.createElement(rt,{event:c,onClose:function(){return l(rn(!1))},bounderStyle:{zIndex:s+1},isOpen:r},o.a.createElement(on,{saveName:u,onClose:function(){return l(rn(!1))}}))};var un=function(e){var t=e.saveName,n=e.setSaveList,a=e.onClose;return o.a.createElement(St,{onClick:function(){window.openConfirmDeleteMenu(t,(function(){window.setTimeout((function(){window.projectSaveService.find().then((function(e){n(e)}))}),1e3)})),a()}})};function ln(e,t,n,a){return{isOpen:e,event:t,saveName:n,setSaveList:a}}var sn=function(){var e=Object(a.useState)(ln(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.event,u=n.saveName,l=n.setSaveList,s=t[1];window.openSDBProjectContextMenu=function(e,t,n){s(ln(!0,e,t,n))};var d=function(){s(ln(!1))};return o.a.createElement(rt,{event:c,onClose:d,isOpen:r},o.a.createElement(un,{saveName:u,setSaveList:l,onClose:d}))};var dn=function(){return o.a.createElement(a.Fragment,null,o.a.createElement(an,null),o.a.createElement(sn,null),o.a.createElement(cn,null),o.a.createElement(Ct,null))},mn=Object(u.a)({FillBounder:{backgroundColor:Oe,display:"flex",flexDirection:"column",margin:"5vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderRadius:"2vmin"},FillHeaderBounder:{display:"flex",justifyContent:"space-between"},FillHeader:{borderColor:"white",borderStyle:"none none none none",padding:"1vmin",marginLeft:"2vmin","&:hover":{cursor:"pointer"}},Fill:{display:"grid",minWidth:Je.iconGrid,minHeight:Je.iconGrid,padding:"4vmin",zIndex:1,rowGap:Je.gutterGrid,columnGap:Je.gutterGrid},ArcherContainer:{width:"100%",height:"100%",zIndex:0,display:"grid"},Icon:{backgroundColor:he,borderRadius:"1.5vmin",borderStyle:"none",borderColor:"white",whiteSpace:"wrap",fontSize:Xe.medium,padding:"1vmin",display:"flex",flexFlow:"column nowrap",alignItems:"flex-end",justifyContent:"flex-start",overflow:"hidden",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)","&:hover":{cursor:"pointer",borderStyle:"solid"},zIndex:2},IconControlContainer:{width:Je.bigIconWidth,maxHeight:Je.bigIconHeight,justifySelf:"flex-end",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",overflowY:"scroll",overflowX:"hidden","&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},ArcherElement:{zIndex:1,display:"grid",backgroundColor:"transparent",gridTemplateRows:"10px auto 10px",gridTemplateColumns:"10px auto 10px",padding:"1vmin"},IconName:{fontSize:Xe.small,"&:hover":{cursor:"pointer"}},IconConnector:{backgroundColor:xe,width:$e.size,height:$e.size,borderRadius:$e.borderRadius,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderStyle:"solid",borderColor:"transparent","&:hover":{cursor:"pointer",borderColor:"white"},justifySelf:"flex-start",alignSelf:"flex-end",flexShrink:0},FillControls:{padding:".1em"}}),fn=n(45),pn=Object(u.a)({MenuHeader:{fontSize:Xe.medium,borderStyle:"none none solid none",margin:"1vmin",width:"90%"},ControlBounder:{display:"flex",flexFlow:"row wrap",alignItems:"center",fontSize:Xe.small,justifyContent:"center",margin:".2em"},ControlMenu:{display:"flex",flexFlow:"row wrap",width:"100%",alignItems:"center",justifyContent:"center"}}),vn=Object(u.a)({ControlTypeSelect:{minWidth:"9vmin",maxWidth:"5em",margin:"1vmin",fontSize:Xe.small,backgroundColor:Se,color:Me,textAlign:"center"},ControlInput:{minWidth:"9vmin",maxWidth:"5em",margin:"1vmin",fontSize:Xe.small},ControlMenu:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center"},Pad:{width:"20vmin",height:"15vmin",borderRadius:"2vmin",backgroundColor:"black"},SrcName:{fontSize:Xe.xsmall,textAlign:"center",whiteSpace:"normal",justifyContent:"center",width:"100%",overflowWrap:"break-word",wordWrap:"break-word",hyphens:"auto"}});var bn=function(e){var t=e.setFunc,n=vn();return o.a.createElement("div",{className:n.Pad,onPointerDown:function(e){e.preventDefault(),t("on")},onPointerCancel:function(e){e.preventDefault(),t("off")},onPointerUp:function(e){e.preventDefault(),t("off")}})};function wn(e,t){return(e-t[0])/(t[1]-t[0])*(et.rotRange[1]-et.rotRange[0])+et.rotRange[0]}function gn(e){var t=(Math.floor(10*e)/10).toString();return"."===t.slice(t.length-2,t.length-1)?t:t+".0"}var On=Object(u.a)({KnobContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"auto",placeItems:"center",margin:"1vmin"},KnobSVG:{gridRow:"1",gridColumn:"1",width:"".concat(et.size+1,"vmin"),height:"".concat(et.size+1,"vmin"),zIndex:9},KnobText:{gridRow:"1",gridColumn:"1",fontSize:Xe.xxsmall,textAlign:"center",color:Me,zIndex:10,width:"4em",borderStyle:"none",backgroundColor:"transparent","&::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"&::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}},InteractionLayer:{gridRow:"1",gridColumn:"1",zIndex:11,width:"".concat(et.size,"vmin"),height:"".concat(et.size,"vmin")},SettingsButton:{width:"".concat(et.size/6,"vmin"),height:"".concat(et.size/6,"vmin"),gridRow:"1",gridColumn:"1",placeSelf:"end",zIndex:12}}),hn=n(80),In=n.n(hn),Cn=!1;var Dn=function(e){var t=e.initValue,n=e.range,r=e.onChange,c=e.onEveryChange,i=e.onSettingsClick,u=e.inputVal,l=e.setInputVal,s=On(),d=Object(a.useRef)(null),m=(n[1]-n[0])*et.sensitivity/200,f=Ft(t,n),p=Object(a.useRef)(null),v=function(e){f=Ft(f-e.movementY*m,n),d.current&&(d.current.style.transform="rotate(".concat(wn(f,n),"deg)")),p.current&&(p.current.value="".concat(gn(f))),c&&c(f)},b=function(){r&&r(f),l(gn(f))};return o.a.createElement("div",{className:s.KnobContainer},o.a.createElement("svg",{className:s.KnobSVG,width:"".concat(et.size+1,"vmin"),height:"".concat(et.size+1,"vmin"),ref:d,style:{transform:"rotate(".concat(wn(t,n),"deg)")}},o.a.createElement("circle",{cx:"".concat((et.size+1)/2,"vmin"),cy:"".concat((et.size+1)/2,"vmin"),r:"".concat(et.size/2,"vmin"),stroke:Te,strokeWidth:et.borderWidth,fill:Se}),o.a.createElement("rect",{width:"".concat(et.markerWidth,"vmin"),height:"".concat(et.markerHeight,"vmin"),x:"".concat((et.size+1)/2-et.markerWidth/2,"vmin"),y:".5vmin",fill:ke})),o.a.createElement("input",{className:s.KnobText,ref:p,onChange:function(e){l(e.target.value),c&&c(Ft(Number(e.target.value),n))},onBlur:function(e){if(0!==e.target.value.length){var t=Ft(Number(e.target.value),n);r&&r(t),l(gn(t))}else p.current&&(p.current.value=u)},onKeyDown:function(e){var t;"Enter"===e.key&&(null===(t=p.current)||void 0===t||t.blur())},type:"number",value:u}),o.a.createElement("div",{className:s.InteractionLayer,title:"".concat(t),onClick:function(e){return e.stopPropagation()},onDragStart:function(e){return e.stopPropagation()},onPointerDown:function(e){e.stopPropagation(),e.preventDefault(),e.shiftKey||Cn?p.current&&(p.current.placeholder=p.current.value,p.current.value="",p.current.focus()):(window.openPointerLayer(e.pointerId,v,b),Cn=!0,window.setTimeout((function(){Cn=!1}),200))}}),i?o.a.createElement("img",{className:s.SettingsButton,title:"edit knob range",src:In.a,alt:"settings",onClick:i}):null)};var jn=function(e){var t=e.controlID,n=e.setFunc,r=e.actualModID,c=e.displayModName,u=e.label,l=Object(de.c)((function(e){return{val:e.modules[r].controlData[t].value,currRange:e.modules[r].controlData[t].range}})),s=l.val,d=l.currRange,m=Object(a.useState)(gn(s)),f=Object(i.a)(m,2),p=f[0],v=f[1],b=Object(de.b)();return o.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},o.a.createElement(Dn,{initValue:s,range:d,inputVal:p,setInputVal:v,onEveryChange:function(e){n(e.toString())},onChange:function(e){n(e.toString()),b(C(r,t,e))},onSettingsClick:function(){window.openKnobRangeSetMenu(r,t,(function(e){n(Ft(s,e).toString()),v(gn(Ft(s,e))),b(D(r,t,e))}))}}),o.a.createElement("div",{style:{marginTop:"-.3em"}},u||(c?"".concat(c," - ").concat(t):t)))};var En=function(e){var t=e.setFunc,n=e.controlID,a=e.modName,r=e.label;return o.a.createElement(jt,{fontSize:Xe.small,onClick:function(){t("")}},r||(a?"".concat(a," - ").concat(n):n))};var yn=function(e){var t=e.setFunc,n=e.controlID,a=e.actualModID,r=e.modName,c=e.label,i=vn(),u=window.audioModules[a],l=u.audioNode,s=Object(de.b)(),d=Object(de.c)((function(e){return e.modules[a].controlData[n].value}));return o.a.createElement(it,{style:{justifyContent:"center",margin:"1vmin 0vmin"}},o.a.createElement("label",{htmlFor:"type"},c||(r?"set type - ".concat(r):"set type")),o.a.createElement("select",{className:i.ControlTypeSelect,name:"type",id:"type",onChange:function(e){t(e.target.value),s(C(a,n,e.target.value))},value:d||l.type},u.typeTypes.map((function(e){return o.a.createElement("option",{value:e,key:a+e},e)}))))};var Nn=function(e){var t=e.actualModID,n=e.controlID,a=e.setFunc,r=e.reRenderIcon,c=e.modName,i=e.label,u=vn();return o.a.createElement("div",{className:u.ControlMenu},o.a.createElement("label",{style:{minWidth:"50%"},htmlFor:t+n},o.a.createElement(jt,{fontSize:Xe.small},i||(c?"".concat(c," - ").concat(n):n))),o.a.createElement("input",{style:{width:0,height:0,opacity:0},type:"file",id:t+n,onChange:function(e){var n=e.target.files[0];a(URL.createObjectURL(n)),window.audioTags[t].srcName=n.name,window.reRenderAudioTags(),r()}}),o.a.createElement("div",{className:u.SrcName},window.audioTags[t].srcName))};var xn=function(e){var t=e.controlID,n=e.setFunc,a=e.actualModID,r=e.modName,c=e.label,i=Object(de.c)((function(e){return e.modules[a].controlData[t].value}));return o.a.createElement(Jt,{text:c||(r?"".concat(r," - ").concat(t):t),initState:i,onSwitch:function(e){n(e?"true":"false")}})},Sn=n(81),Mn=n.n(Sn);var Tn=function(e){var t=e.modID,n=window.audioModules[t],r=Object(de.c)((function(e){return e.modules[t].controlData["time graph"].range})),c=200-Bt(0,r,[0,200]),u=Object(a.useState)(0),l=Object(i.a)(u,2),s=l[0],d=l[1],m=Object(de.b)();return o.a.createElement(dt,{justifyContent:"center",alignItems:"center"},o.a.createElement(Mn.a,{style:{width:Je.bigIconWidth},setup:function(e,t){e.createCanvas(t.clientWidth,200).parent(t),e.textAlign(e.CENTER,e.CENTER),e.fill(100),d(t.clientWidth)},draw:function(e){n.audioNode.getFloatTimeDomainData(n.timeArray);var t=s/n.bufferLength;e.background(0);var a=0,o=200-Bt(n.timeArray[0],r,[0,200]);e.stroke(ze),e.strokeWeight(6);for(var i=0;i<n.bufferLength-1;i++){var u=(i+1)*t,l=200-Bt(n.timeArray[i+1],r,[0,200]);e.line(a,o,u,l),a=u,o=l}var d=s/20;e.stroke(100),e.strokeWeight(1),e.line(0,c,d,c),e.text("0",1.5*d,c)}}),o.a.createElement(jt,{onClick:function(){window.openAnalyzerRangeSetMenu(r,(function(e){m(D(t,"time graph",e))}))}},"change range"))},kn=n(19),Rn=n(84),An=Object(u.a)({BabylonCanvas:{width:function(e){return e.width},height:function(e){return e.height}}});var Fn=function(e){var t=e.onRender,n=e.onSceneReady,r=e.antialias,c=e.engineOptions,i=e.adaptToDeviceRatio,u=e.sceneOptions,l=e.width,s=e.height,d=Object(Rn.a)(e,["onRender","onSceneReady","antialias","engineOptions","adaptToDeviceRatio","sceneOptions","width","height"]),m=Object(a.useRef)(null),f=An({width:l,height:s}).BabylonCanvas;return Object(a.useEffect)((function(){if(m.current){var e=new kn.d(m.current,r,c,i),a=new kn.h(e,u);a.isReady()?n&&n(a):a.onReadyObservable.addOnce((function(e){n&&n(e)})),e.runRenderLoop((function(){"function"===typeof t&&t(a),a.render()}));var o=function(){a.getEngine().resize()};return window&&window.addEventListener("resize",o),function(){a.getEngine().dispose(),window&&window.removeEventListener("resize",o)}}}),[i,r,c,t,n,u]),o.a.createElement("canvas",Object.assign({className:f,ref:m},d))},Pn=n(63);function Bn(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){return!kt(e[0],t)})))}function Ln(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){return kt(e[0],t)})))}function zn(e,t){return e.length===t.length?Object.fromEntries(e.map((function(e,n){return[e,t[n]]}))):{}}var _n={C0:16.35,"C#0":17.32,Db0:17.32,D0:18.35,"D#0":19.45,Eb0:19.45,E0:20.6,F0:21.83,"F#0":23.12,Gb0:23.12,G0:24.5,"G#0":25.96,Ab0:25.96,A0:27.5,"A#0":29.14,Bb0:29.14,B0:30.87,C1:32.7,"C#1":34.65,Db1:34.65,D1:36.71,"D#1":38.89,Eb1:38.89,E1:41.2,F1:43.65,"F#1":46.25,Gb1:46.25,G1:49,"G#1":51.91,Ab1:51.91,A1:55,"A#1":58.27,Bb1:58.27,B1:61.74,C2:65.41,"C#2":69.3,Db2:69.3,D2:73.42,"D#2":77.78,Eb2:77.78,E2:82.41,F2:87.31,"F#2":92.5,Gb2:92.5,G2:98,"G#2":103.83,Ab2:103.83,A2:110,"A#2":116.54,Bb2:116.54,B2:123.47,C3:130.81,"C#3":138.59,Db3:138.59,D3:146.83,"D#3":155.56,Eb3:155.56,E3:164.81,F3:174.61,"F#3":185,Gb3:185,G3:196,"G#3":207.65,Ab3:207.65,A3:220,"A#3":233.08,Bb3:233.08,B3:246.94,C4:261.63,"C#4":277.18,Db4:277.18,D4:293.66,"D#4":311.13,Eb4:311.13,E4:329.63,F4:349.23,"F#4":369.99,Gb4:369.99,G4:392,"G#4":415.3,Ab4:415.3,A4:440,"A#4":466.16,Bb4:466.16,B4:493.88,C5:523.25,"C#5":554.37,Db5:554.37,D5:587.33,"D#5":622.25,Eb5:622.25,E5:659.26,F5:698.46,"F#5":739.99,Gb5:739.99,G5:783.99,"G#5":830.61,Ab5:830.61,A5:880,"A#5":932.33,Bb5:932.33,B5:987.77,C6:1046.5,"C#6":1108.73,Db6:1108.73,D6:1174.66,"D#6":1244.51,Eb6:1244.51,E6:1318.51,F6:1396.91,"F#6":1479.98,Gb6:1479.98,G6:1567.98,"G#6":1661.22,Ab6:1661.22,A6:1760,"A#6":1864.66,Bb6:1864.66,B6:1975.53,C7:2093,"C#7":2217.46,Db7:2217.46,D7:2349.32,"D#7":2489.02,Eb7:2489.02,E7:2637.02,F7:2793.83,"F#7":2959.96,Gb7:2959.96,G7:3135.96,"G#7":3322.44,Ab7:3322.44,A7:3520,"A#7":3729.31,Bb7:3729.31,B7:3951.07,C8:4186.01,"C#8":4434.92,Db8:4434.92,D8:4698.64,"D#8":4978.03,Eb8:4978.03},Un=Object.keys(_n).filter((function(e){return e.length<=2||"#"!==e[1]})),Gn=zn(Un,Un.map((function(e){return _n[e]}))),Wn=zn(Un,Un.map((function(e,t){return t}))),Hn=[Math.log(_n.C1),Math.log(_n.C5)],Kn=[0,2*Math.PI*.95];function Vn(e,t,n,a){var o=kn.e.CreatePlane(e,{width:n,height:40,sourcePlane:new kn.f(1,0,0,0)}),r=Pn.AdvancedDynamicTexture.CreateForMesh(o),c=new Pn.TextBlock("".concat(e,"text"),t);return c.fontSize=a,c.width=n,c.height=50,c.color="black",r.addControl(c),o}var qn=function(e){var t=new kn.i("dialMat",e),n=new kn.i("tickMat",e);n.diffuseColor=new kn.b(0,.5,0);var a=kn.e.CreateCylinder("dial",{height:160,diameter:1600,tessellation:Math.pow(2,7)},e);a.material=t,a.cullingStrategy=kn.a.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION,Object.keys(Gn).filter((function(e,t){return t>=Wn.C1&&t<=Wn.C5})).forEach((function(e){var t=Bt(Math.log(_n[e]),Hn,Kn),o=new kn.k("".concat(e,"node")),r=kn.e.CreateBox("".concat(e,"tick"),{height:80,width:2,depth:10});r.material=n,r.position.x=802,r.parent=o,o.rotation.y=-t,o.parent=a;var c=Vn("".concat(e,"textplane"),e,50,450);c.position.y=60,c.parent=r;var i=Vn("".concat(e,"freqplane"),"".concat(_n[e]).slice(0,Math.min("".concat(_n[e]).length,5)),50,400);i.position.y=-60,i.parent=r}))};var Yn=function(e){var t=e.modID,n=-.1,a=0,r=window.audioModules[t];return o.a.createElement(Fn,{onSceneReady:function(e){e.clearColor=kn.c.FromHexString(ut("TUNER")),e.ambientColor=new kn.b(.5,.5,.5);var t=new kn.l(1e3,0,0);new kn.j("tunerCam",t,e).setTarget(new kn.l(0,0,0));var n=new kn.l(1110.5,300,0),a=new kn.g("light",n,e);a.diffuse=new kn.b(1,0,0),a.specular=new kn.b(0,.1,0),qn(e)},onRender:function(e){if(0===a){var t=r.controlSetFuncs.tuner(""),o=Object(i.a)(t,2),c=o[0],u=o[1];n=u>-75?Bt(Ft(Math.log(c),Hn),Hn,Kn):-.15}var l=e.getMeshByName("dial");l.rotation.y+=.1*(n-l.rotation.y),a=(a+1)%30},style:{borderRadius:".8em",marginTop:"1em"},width:Je.bigIconWidth,height:"200px"})};function Zn(e,t,n){var a=kn.e.CreateSphere("sphere",{segments:Math.pow(2,6),diameter:100,updatable:!0},e),o=new kn.i("sphereMat",e);return a.material=o,function(e,t,n){var a=e.getVerticesData(kn.m.PositionKind),o={};if(a)for(var r=0;r<a.length;r+=3){var c=(i=a[r],u=a[r+2],i>0?u>0?-Object(Q.b)(u,i)+Math.PI:u<0?Object(Q.b)(-u,i)+Math.PI:0+Math.PI:i<0?u>0?Object(Q.b)(u,-i):u<0?2*Math.PI-Object(Q.b)(-u,-i):2*Math.PI:u>0?Math.PI/2:u<0?3*Math.PI/2:Math.PI);o[r]=Math.floor(Bt(c%(2*Math.PI/n),[0,2*Math.PI/n],[0,t/16]))}var i,u;return o}(a,t,n)}function Qn(e,t,n,a,o,r){var c=Ft(o*(a[n[t]]+r),[.1,2]);return Object(Q.c)(e,c)}var Jn=function(e){var t=e.modID,n=window.audioModules[t],a=0,r={},c=[],i=[],u=[];return o.a.createElement(Fn,{onSceneReady:function(e){var t;e.clearColor=new kn.c(0,0,0),e.ambientColor=new kn.b(.5,.5,.5);var a=new kn.l(250,0,0);new kn.j("cam",a,e).setTarget(new kn.l(0,0,0));var o=new kn.l(250,300,0),l=new kn.g("light",o,e);l.diffuse=new kn.b(1,0,0),l.specular=new kn.b(0,.1,0),r=Zn(e,n.bufferLength,3),c=null===(t=e.getMeshByName("sphere"))||void 0===t?void 0:t.getVerticesData(kn.m.PositionKind),i=Object(Z.a)(c),u=Object(Z.a)(c)},onRender:function(e){var t=e.getMeshByName("sphere");t.rotation.y+=.01,0===a&&(n.controlSetFuncs["visualizer-update"](""),i=function(e,t,n,a,o){for(var r=[],c=0;c<e.length;c+=3){var i=Qn([e[c],e[c+1],e[c+2]],c,n,t,a,o);r.push.apply(r,Object(Z.a)(i))}return r}(c,n.freqArray,r,.01,200)),u=function(e,t,n,a){var o=t.map((function(e,t){return e+a*(n[t]-e)}));return e.updateVerticesData(kn.m.PositionKind,o),o}(t,u,i,.1),a=(a+1)%15},style:{borderRadius:".8em",marginTop:"1em"},width:Je.bigIconWidth,height:"200px"})};var Xn=function(e){var t=e.audioModule,n=e.selectedModule,a=e.reRenderIcon,r=pn();return o.a.createElement("div",{className:r.ControlMenu},Object.keys(n.controlData).map((function(e,c){var i=n.controlData[e].controlType,u=t.controlSetFuncs[e];return o.a.createElement("div",{className:r.ControlBounder,key:n.id+e+c},i===w?o.a.createElement(jn,{controlID:e,setFunc:u,actualModID:n.id}):"BUTTON"===i&&"open"!==e?o.a.createElement(En,{setFunc:u,controlID:e}):"TYPE"===i?o.a.createElement(yn,{setFunc:u,controlID:e,actualModID:n.id}):"FILE"===i?o.a.createElement(Nn,{controlID:e,setFunc:u,reRenderIcon:a,actualModID:n.id}):"SWITCH"===i?o.a.createElement(xn,{controlID:e,setFunc:u,actualModID:n.id}):"GRAPH"===i?o.a.createElement(Tn,{modID:n.id}):"PAD"===i?o.a.createElement(bn,{setFunc:u}):"TUNER_CONTROL"===i?o.a.createElement(Yn,{modID:n.id}):"VISUALIZER_CONTROL"===i?o.a.createElement(Jn,{modID:n.id}):null)})))};var $n=function(e){var t=e.selectedModule,n=e.reRender,r=Object(de.c)((function(e){return e.modules})),c=pn();return o.a.createElement(a.Fragment,null,t.containerControls.map((function(e,t){var a=e.modID,i=e.controlID,u=e.actualModID,l=e.name,s=window.audioModules[u],d=r[u].controlData[i].controlType,m=s.controlSetFuncs[i],f=r[a].name;return o.a.createElement("div",{className:c.ControlBounder,key:a+i+t},d===w?o.a.createElement(jn,{controlID:i,setFunc:m,actualModID:u,displayModName:f,label:l}):"BUTTON"===d?o.a.createElement(En,{setFunc:m,controlID:i,modName:f,label:l}):"TYPE"===d?o.a.createElement(yn,{setFunc:m,controlID:i,actualModID:u,modName:f,label:l}):"FILE"===d?o.a.createElement(Nn,{controlID:i,setFunc:m,reRenderIcon:n,modName:f,actualModID:u,label:l}):"SWITCH"===d?o.a.createElement(xn,{controlID:i,setFunc:m,actualModID:u,modName:f,label:l}):"GRAPH"===d?o.a.createElement(Tn,{modID:u}):"PAD"===d?o.a.createElement(bn,{setFunc:m}):"TUNER_CONTROL"===d?o.a.createElement(Yn,{modID:u}):"VISUALIZER_CONTROL"===d?o.a.createElement(Jn,{modID:u}):null)})))};var ea=function(e){var t=e.selectedModule,n=e.reRenderIcon,a=pn();return o.a.createElement("div",{className:a.ControlMenu},o.a.createElement($n,{selectedModule:t,reRender:n}))},ta=Object(u.a)({DropSquare:{width:Je.icon,height:Je.icon,padding:".5vmin",borderStyle:"solid",borderRadius:"10px",zIndex:1,"&:hover":{cursor:"pointer"}}});function na(e,t,n){var a=function e(t,n){return n[t].moduleType===b?1===n[t].connectionOutputs.length&&e(n[t].connectionOutputs[0],n):1===n[t].connectionOutputs.length&&t}(e,n),o=function e(t,n){return n[t].moduleType===b?1===n[t].connectionInputs.length&&e(n[t].connectionInputs[0],n):1===n[t].connectionInputs.length&&0===window.audioModules[t].connectingParamIDs.length&&t}(t,n);return{onlyOne:"string"===typeof a&&"string"===typeof o,actualFromID:a,actualToID:o}}function aa(e,t){var n=t[e].childModules,a=[];for(var o in n)t[n[o]].moduleType===b&&(a=[].concat(Object(Z.a)(a),Object(Z.a)(aa(n[o],t))));return[].concat(Object(Z.a)(n),Object(Z.a)(a))}function oa(e,t){var n=Object.keys(e),a=[];for(var o in n){var r=e[n[o]],c=r.fromID,i=r.toID,u=r.actualOutputID,l=r.actualInputID;Rt(u||c,l||i,t)&&(a=[].concat(Object(Z.a)(a),[n[o]]))}return a}function ra(e,t){return Ln(e,oa(e,t))}function ca(e,t){var n=[t].concat(Object(Z.a)(aa(t,e.modules)));return{modules:Ln(e.modules,n),connections:ra(e.connections,n)}}var ia=function(e,t,n){switch(t){case"OSCILLATOR":var a=z(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,a));break;case"GAIN":var o=B(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,o));break;case"OUTPUT":var r=R(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,r));break;case"AUTOFILTER":var c=k(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,c));break;case"KOMPRESSOR":var i=P(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,i));break;case"STEREO_PANNER":var u=A(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,u));break;case"SIGNAL_DELAY":var l=F(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,l));break;case"CONSTANT":var s=S(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,s));break;case"MEDIA_ELEMENT":window.addAudioTag(e),window.reRenderAudioTags&&window.reRenderAudioTags();break;case"LINE_IN":_(e);break;case b:var d=U(e);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,d));break;case"DISTORTION":var m=H(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,m));break;case"ANALYZER":var f=K(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,f));break;case"ENVELOPED_TRIGGER":var w=V(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,w));break;case"WHITE_NOISE":var g=Y(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,g));break;case"TUNER":var O=$(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,O));break;case"VISUALIZER":var h=ee(n);window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},e,h))}};var ua=function(e,t){Object.keys(e).forEach((function(t){var n=e[t],a=n.moduleType,o=n.controlData;ia(t,a,o)})),t&&Object.keys(t).forEach((function(n){var a=t[n],o=a.fromID,r=a.toID,c=a.param,i=a.outputIndex,u=a.inputIndex,l=a.actualOutputID,s=a.actualInputID,d=e[s||r].moduleType,m=e[l||o].moduleType;"MEDIA_ELEMENT"===d||"MEDIA_ELEMENT"===m||"LINE_IN"===d||"LINE_IN"===m?window.setTimeout((function(){mt(window.audioModules[l||o],window.audioModules[s||r],c,i,u)}),200):mt(window.audioModules[l||o],window.audioModules[s||r],c,i,u)}))};var la=function(e,t){return"".concat(t).concat(e).concat(Math.floor(20480*Math.random()))};function sa(e,t,n,a){var o=Object.keys(e),r=Object.keys(t),c=zn(o,o.map((function(e,t){return la(t,n)}))),i=zn(r,r.map((function(e,t){return la(t,a)}))),u=zn(Object.values(c),o.map((function(t){if(e[t].moduleType===b){var n=e[t];return Object(v.a)(Object(v.a)({},n),{},{id:c[t],inputs:n.inputs.filter((function(e){return kt(e,r)})).map((function(e){return i[e]})),outputs:n.outputs.filter((function(e){return kt(e,r)})).map((function(e){return i[e]})),containerControls:n.containerControls.map((function(e){return Object(v.a)(Object(v.a)({},e),{},{modID:c[e.modID],actualModID:c[e.actualModID]})})),childModules:n.childModules.map((function(e){return c[e]})),parentID:e[t].parentID?c[e[t].parentID]:null,connectionOutputs:e[t].connectionOutputs.map((function(e){return c[e]})),connectionInputs:e[t].connectionInputs.map((function(e){return c[e]}))})}return Object(v.a)(Object(v.a)({},e[t]),{},{id:c[t],inputs:e[t].inputs.filter((function(e){return kt(e,r)})).map((function(e){return i[e]})),outputs:e[t].outputs.filter((function(e){return kt(e,r)})).map((function(e){return i[e]})),parentID:c[e[t].parentID]})}))),l=zn(Object.values(i),r.map((function(e){var n=t[e];return Object(v.a)(Object(v.a)({},n),{},{fromID:c[n.fromID],toID:c[n.toID],actualOutputID:n.actualOutputID?c[n.actualOutputID]:void 0,actualInputID:n.actualInputID?c[n.actualInputID]:void 0})})));return{modIDConverter:c,newModules:u,newConnections:l}}function da(e,t,n,a,o,r,c,i,u){var l=sa(t,n,a,o),s=l.modIDConverter,d=l.newModules,m=l.newConnections;ua(d,m),e(y(s[c],d,m,r,i,u))}var ma=function(e,t,n,a,o){var r=la(0,Object.keys(t.modules).length),c=t.modules[n],i=c.name,u=c.moduleType,l=c.controlData,s=c.parentID,d=c.connectionInputs,m=c.connectionOutputs;ia(r,u,l),e(g(r,i,u,l,s,a,o,d,m))};function fa(e,t,n,a,o,r){var c=e.dataTransfer.getData("id"),i=n.modules[window.fillContainerID].childModules,u=n.modules[c],l=function(e,t,n,a){for(var o=0;o<n.length;o++){var r=a[n[o]];if(r.row===e&&r.col===t)return r.id}return!1}(a,o,i,n.modules);if(u)if(l){var s=e.dataTransfer.getData("fromRow"),d=e.dataTransfer.getData("fromCol");r(!1),t(O(c,a,o)),t(O(l,Number(s),Number(d))),window.setTimeout(window.refreshArcherContainer,1)}else{var m=e.dataTransfer.getData("type");switch(r(!1),m){case pa:t(O(c,a,o));break;case va:n.modules[c].moduleType===b?function(e,t,n,a,o,r){var c=ca(t,a);da(e,c.modules,c.connections,Object.keys(t.modules).length,Object.keys(t.connections).length,n,a,o,r)}(t,n,window.fillContainerID,c,a,o):ma(t,n,c,a,o)}window.setTimeout(window.refreshArcherContainer,1)}else if(!l){var f=e.dataTransfer.getData("type"),p=e.dataTransfer.getData("name");switch(f){case"ADD_MODULE":var v=e.dataTransfer.getData("moduleType");window.addModule(c,p,window.fillContainerID,v,t,a,o);break;case"CONTAINER_RESTORE":var w=Object.keys(n.modules).length,g=Object.keys(n.connections).length;window.containerSaveService.get(p).then((function(e){var n=e.containerID,r=e.modules,c=e.connections;da(t,r,c,w,g,window.fillContainerID,n,a,o)}))}r(!1)}}var pa="MOVE",va="COPY";var ba=function(e){var t=e.row,n=e.col,r=ta(),c=Object(de.b)(),u=Object(de.c)((function(e){return e})),l=Object(a.useState)(!1),s=Object(i.a)(l,2),d=s[0],m=s[1],f={gridColumn:"".concat(n+1," / span 1"),gridRow:"".concat(t+1," / span 1"),borderColor:d?je:"transparent"};return o.a.createElement("div",{className:r.DropSquare,style:f,onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.dataTransfer.types.length>=3&&m(!0)},onDragLeave:function(e){m(!1)},onDrop:function(e){fa(e,c,u,t,n,m)},onContextMenu:function(e){e.preventDefault(),window.openAddModuleMenu(t,n)},onPointerEnter:function(e){e.preventDefault(),m(!0)},onPointerLeave:function(e){e.preventDefault(),m(!1)}})};var wa=function(e){var t=e.mod,n=e.gridCol,r=e.gridRow,c=mn(),u=Object(a.useState)(!1),l=Object(i.a)(u,2),s=l[0],d=l[1],m=Object(a.useState)(!1),f=Object(i.a)(m,2),p=f[0],v=f[1],w=function(){v(!p)},g={gridColumn:"".concat(n," / span 1"),gridRow:"".concat(r," / span 1"),width:s?Je.bigIconWidth:Je.icon,height:s?Je.bigIconHeight:Je.icon},h=Object.assign({},g,{borderStyle:s?"solid":"none",backgroundColor:ut(t.moduleType)}),I={fontSize:Xe.small},C=Object(de.c)((function(e){return e})),D=C.modules,j=C.connections,E=Object(de.b)();return o.a.createElement(a.Fragment,null,o.a.createElement("div",{className:c.Icon,style:h,onPointerDown:function(e){return e.stopPropagation()},onDragOver:function(e){e.preventDefault()},onDrop:function(e){!function(e,t,n,a,o){e.stopPropagation();var r=e.dataTransfer.getData("id"),c=e.dataTransfer.getData("type");if(r){if(t[r]&&c===pa){var i=e.dataTransfer.getData("fromRow"),u=e.dataTransfer.getData("fromCol");o(O(r,a.row,a.col)),o(O(a.id,Number(i),Number(u))),window.setTimeout(window.refreshArcherContainer,100)}}else if(0===a.connectionInputs.length&&0===window.audioModules[a.id].connectingParamIDs.length)alert("mod cannot accept input");else{var l=e.dataTransfer.getData("fromID");if(l){var s=na(l,a.id,t),d=s.onlyOne,m=s.actualFromID,f=s.actualToID;d?vt(l,m,a.id,f,t,n,o,0,0):(e.persist(),window.openConnectionMenu(e,l,a.id))}}}(e,D,j,t,E)},draggable:!s,onDragStart:function(e){!function(e,t){e.shiftKey?e.dataTransfer.setData("type",va):e.dataTransfer.setData("type",pa),e.dataTransfer.setData("id",t.id),e.dataTransfer.setData("fromRow","".concat(t.row)),e.dataTransfer.setData("fromCol","".concat(t.col))}(e,t)},onClick:function(e){e.stopPropagation(),d(!s),window.setTimeout(window.refreshArcherContainer,0)},onContextMenu:function(e){e.preventDefault(),e.persist(),window.openModuleContextMenu(e,t.id)}},0===t.connectionOutputs.length?null:o.a.createElement("div",{className:c.IconConnector,draggable:!0,onDragStart:function(e){e.stopPropagation(),e.dataTransfer.setData("fromID",t.id)}}),o.a.createElement("div",{className:c.IconName,style:I,onClick:function(e){s&&(e.stopPropagation(),window.openModuleRenameMenu(t.id))}},t.name),s?o.a.createElement("div",{className:c.IconControlContainer,onClick:function(e){return e.stopPropagation()}},t.moduleType===b?o.a.createElement(ea,{selectedModule:t,reRenderIcon:w}):null,t.moduleType!==b?o.a.createElement(Xn,{audioModule:window.audioModules[t.id],selectedModule:t,reRenderIcon:w}):null):null),o.a.createElement("div",{className:c.ArcherElement,style:g},o.a.createElement("div",{style:{gridColumn:"".concat(1," / span 1"),gridRow:"".concat(1," / span 1")}},o.a.createElement(fn.ArcherElement,{id:t.id+" input"},o.a.createElement("div",{style:{width:"10px",height:"10px"}}))),o.a.createElement("div",{style:{gridColumn:"".concat(1," / span 1"),gridRow:"".concat(3," / span 1")}},o.a.createElement(fn.ArcherElement,{id:t.id+" controls"},o.a.createElement("div",{style:{width:"10px",height:"10px"}}))),o.a.createElement("div",{style:{gridColumn:"".concat(3," / span 1"),gridRow:"".concat(1," / span 1")}},o.a.createElement(fn.ArcherElement,{id:t.id+" output",relations:t.outputs.filter((function(e){var t=j[e];return Rt(t.fromID,t.toID,D[window.fillContainerID].childModules)})).map((function(e){var t=j[e],n=t.toID,a=t.param;return{targetId:""===a?n+" input":n+" controls",targetAnchor:"left",sourceAnchor:"right",style:{strokeColor:""===a?"red":"blue"}}}))},o.a.createElement("div",{style:{width:"10px",height:"10px"}})))))};var ga=function(){var e=Object(de.c)((function(e){return e.modules[window.fillContainerID]})),t=function(){var e=Object(a.useState)({}),t=Object(i.a)(e,2)[1];return function(){t({})}}(),n=mn();return o.a.createElement(dt,{className:n.FillControls,alignItems:"center"},o.a.createElement($n,{selectedModule:e,reRender:t}))};var Oa=function(){var e=mn(),t=Object(a.useState)(!1),n=Object(i.a)(t,2),r=n[0],c=n[1];window.reRenderFillContainer=function(){c(!r)};var u,l=Object(de.c)((function(e){return{modules:e.modules,baseContainerID:e.baseContainerID}})),s=l.modules,d=l.baseContainerID,m=s[window.fillContainerID],f=function(e,t){var n=0,a=0;return e.forEach((function(e){var o=t[e];o.row>n&&(n=o.row),o.col>a&&(a=o.col)})),{maxRow:n,maxCol:a}}(m.childModules,s),p=f.maxRow,v=f.maxCol,b=0===m.childModules.length;u=b?{gridTemplateRows:"repeat(".concat(1,", ","auto",")"),gridTemplateColumns:"repeat(".concat(1,", ","auto",")")}:{gridTemplateRows:"repeat(".concat(p+2,", ","auto",")"),gridTemplateColumns:"repeat(".concat(v+2,", ","auto",")")};var w=Object(a.useRef)(null);return window.refreshArcherContainer=function(){var e;null===(e=w.current)||void 0===e||e.refreshScreen()},o.a.createElement("div",{className:e.FillBounder},o.a.createElement("div",{className:e.FillHeaderBounder},o.a.createElement("div",{className:e.FillHeader,style:{width:"".concat(m.name.length/2,"em")},onClick:function(e){e.stopPropagation(),window.openModuleRenameMenu(window.fillContainerID)},onPointerDown:function(e){return e.stopPropagation()}},m.name),m.id===d?null:o.a.createElement(jt,{style:{height:".7em"},onPointerDown:function(){window.fillContainerID=m.parentID,window.reRenderFillContainer()}},o.a.createElement("div",null,"back"))),o.a.createElement(it,null,o.a.createElement(ot,{showIf:0!==m.containerControls.length},o.a.createElement(ga,null)),o.a.createElement(fn.ArcherContainer,{ref:w,svgContainerStyle:{zIndex:-1},strokeWidth:8,arrowLength:0},o.a.createElement("div",{className:e.Fill,style:u},b?o.a.createElement(ba,{row:0,col:0}):At(0,p+2).map((function(e){return At(0,v+2).map((function(t){return o.a.createElement(ba,{key:"".concat(e," ").concat(t),row:e,col:t})}))})).flat(),m.childModules.map((function(e){var t=s[e];return o.a.createElement(wa,{key:t.id,mod:t,gridRow:t.row+1,gridCol:t.col+1})}))))))},ha=Object(u.a)({DrawerBounder:{width:"0px",height:"100vh",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",color:"white",position:"absolute",top:"0px",right:"0px",userSelect:"none",zIndex:10},Drawer:{backgroundColor:fe,height:"100vh",width:"".concat(Qe.width,"px"),display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"flex-start",position:"absolute",top:"0px",right:"0px"},DrawerHeader:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"inherit",overflowX:"scroll",overflowY:"hidden","&::-webkit-scrollbar":{height:"3px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},DrawerHeaderItem:{fontSize:Xe.medium,padding:"1vmin 1.5vmin",color:Ie,textDecoration:"none",whiteSpace:"nowrap","&:hover":{cursor:"pointer"}},ItemRouter:{width:"".concat(Qe.width,"px"),height:"calc(100% - 60px)",display:"flex",flexFlow:"column wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start","&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},Toggle:{backgroundColor:pe,width:Qe.toggleWidth,zIndex:10,height:"100%",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{cursor:"pointer"},position:"absolute",top:"0px",right:"".concat(Qe.width,"px")},ToggleLine:{backgroundColor:ve,borderRadius:"4px",width:"0.75vmin",height:"80px"},SDBSaveList:{display:"flex",flexDirection:"column",overflow:"scroll",height:"60%","&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}}});var Ia=function(e){var t=e.className,n=e.text,a=e.onClick,r={color:e.selectedRoute===n?Ce:Ie};return o.a.createElement("div",{className:t,onClick:a,style:r},n)};var Ca=function(e,t){var n=t.modules,a=t.connections;Object.keys(e).forEach((function(t){var n=e[t],a=n.fromID,o=n.toID,r=n.param,c=n.outputIndex,i=n.actualOutputID,u=n.actualInputID;window.audioModules[i||a]&&window.audioModules[u||o]&&ft(window.audioModules[i||a],window.audioModules[u||o],r,c)})),window.numberRestores++,window.audioModules={},window.audioTags={},Object.keys(n).forEach((function(e){var t=n[e],a=t.moduleType,o=t.controlData;ia(e,a,o)})),a&&Object.keys(a).forEach((function(e){var t=a[e],o=t.fromID,r=t.toID,c=t.param,i=t.outputIndex,u=t.inputIndex,l=t.actualOutputID,s=t.actualInputID,d=n[s||r].moduleType,m=n[l||o].moduleType;"MEDIA_ELEMENT"===d||"MEDIA_ELEMENT"===m||"LINE_IN"===d||"LINE_IN"===m?function e(t,n,a,o,r,c,i,u){t>10?alert("restore failed"):window.setTimeout((function(){window.audioModules[i||n]&&window.audioModules[u||a]?mt(window.audioModules[i||n],window.audioModules[u||a],o,r,c):e(t+1,n,a,o,r,c,i,u)}),500)}(0,o,r,c,i,u,l,s):mt(window.audioModules[l||o],window.audioModules[s||r],c,i,u)}))},Da={backgroundColor:"transparent"};var ja=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(de.b)(),u=Object(de.c)((function(e){return e.connections}));Object(a.useEffect)((function(){window.projectSaveService.find().then((function(e){r(e)}))}),[]);var l=ha();return o.a.createElement("div",{style:{}},o.a.createElement(jt,{style:{backgroundColor:He},onClick:function(){window.openSpaceDBProjectSaveMenu(n,(function(){window.setTimeout((function(){window.projectSaveService.find().then((function(e){r(e)}))}),1e3)}))}},"save project"),o.a.createElement("div",{className:l.SDBSaveList},n.map((function(e,t){return o.a.createElement(jt,{style:Da,key:t,onClick:function(){window.projectSaveService.get(e).then((function(e){Ca(u,e),c(N(e))}))},onContextMenu:function(t){t.preventDefault(),t.persist(),window.openSDBProjectContextMenu(t,e,r)}},e)}))))};var Ea=function(){var e=Object(de.c)((function(e){return Object.keys(e.modules).length}));return o.a.createElement(a.Fragment,null,e<2?null:o.a.createElement(jt,{onClick:function(){window.openConfirmBlankProjectMenu()}},"blank project"))},ya=n(18),Na=n.n(ya),xa=n(22),Sa=n(82);function Ma(e,t){return Ta.apply(this,arguments)}function Ta(){return(Ta=Object(xa.a)(Na.a.mark((function e(t,n){var a;return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.createWritable();case 2:return a=e.sent,e.next=5,a.write(JSON.stringify(n));case 5:return e.next=7,a.close();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ka(e){return Ra.apply(this,arguments)}function Ra(){return(Ra=Object(xa.a)(Na.a.mark((function e(t){var n,a,o,r,c;return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showOpenFilePicker();case 2:if(n=e.sent,a=Object(i.a)(n,1),!(o=a[0])){e.next=16;break}return t&&t(o),e.next=9,o.getFile();case 9:return r=e.sent,e.next=12,r.text();case 12:return c=e.sent,e.abrupt("return",JSON.parse(c));case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Aa(e,t){return Fa.apply(this,arguments)}function Fa(){return(Fa=Object(xa.a)(Na.a.mark((function e(t,n){return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showSaveFilePicker({types:[{description:"space machine project",accept:{"example/*":[".sm"]}}]});case 2:return window.saveFileHandle=e.sent,e.next=5,Ma(window.saveFileHandle,t);case 5:n&&n();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pa(e){var t=e.name;return t.slice(0,t.length-3)}function Ba(e){return La.apply(this,arguments)}function La(){return(La=Object(xa.a)(Na.a.mark((function e(t){var n,a,o,r,c,i,u,l;return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=!0,o=!1,e.prev=3,c=Object(Sa.a)(t.values());case 5:return e.next=7,c.next();case 7:return i=e.sent,a=i.done,e.next=11,i.value;case 11:if(u=e.sent,a){e.next=18;break}l=u,n.push(l.name);case 15:a=!0,e.next=5;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(3),o=!0,r=e.t0;case 24:if(e.prev=24,e.prev=25,a||null==c.return){e.next=29;break}return e.next=29,c.return();case 29:if(e.prev=29,!o){e.next=32;break}throw r;case 32:return e.finish(29);case 33:return e.finish(24);case 34:return e.abrupt("return",n);case 35:case"end":return e.stop()}}),e,null,[[3,20,24,34],[25,,29,33]])})))).apply(this,arguments)}function za(e){return _a.apply(this,arguments)}function _a(){return(_a=Object(xa.a)(Na.a.mark((function e(t){var n;return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ba(t);case 2:return n=e.sent,e.abrupt("return",n.filter((function(e){return e.length>4&&".smm"===e.slice(e.length-4)})).map((function(e){return e.slice(0,e.length-4)})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ua(e,t,n){return Ga.apply(this,arguments)}function Ga(){return(Ga=Object(xa.a)(Na.a.mark((function e(t,n,a){var o;return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getFileHandle("".concat(n,".smm"),{create:!0});case 2:return o=e.sent,e.next=5,Ma(o,a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wa(e,t){return Ha.apply(this,arguments)}function Ha(){return(Ha=Object(xa.a)(Na.a.mark((function e(t,n){var a,o,r;return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getFileHandle("".concat(n,".smm"));case 2:return a=e.sent,e.next=5,a.getFile();case 5:return o=e.sent,e.next=8,o.text();case 8:return r=e.sent,e.abrupt("return",JSON.parse(r));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ka=function(e){var t=e.reRender,n=e.state,a=Object(de.b)();return o.a.createElement(jt,{fontSize:Xe.medium,onClick:Object(xa.a)(Na.a.mark((function e(){var o;return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ka((function(e){window.saveFileHandle=e}));case 2:(o=e.sent)?(Ca(n.connections,o),a(N(o)),t()):window.flashNotification("rgba(1, 1, 1, .4)","no file selected");case 4:case"end":return e.stop()}}),e)})))},"open")};var Va=function(e){var t=e.state,n=e.reRender;return o.a.createElement(jt,{fontSize:Xe.medium,onClick:Object(xa.a)(Na.a.mark((function e(){return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Aa(t,(function(){n(),window.flashNotification(Ye,"".concat(Pa(window.saveFileHandle)," saved"))}));case 1:case"end":return e.stop()}}),e)})))},"save as")};var qa=function(e){var t=e.state;return o.a.createElement(a.Fragment,null,window.saveFileHandle?o.a.createElement(jt,{fontSize:Xe.medium,onClick:Object(xa.a)(Na.a.mark((function e(){return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ma(window.saveFileHandle,t);case 2:window.flashNotification(Ye,"".concat(Pa(window.saveFileHandle)," saved"));case 3:case"end":return e.stop()}}),e)})))},"save ".concat(Pa(window.saveFileHandle))):o.a.createElement(jt,{fontSize:Xe.medium,notClickable:!0,style:{backgroundColor:"transparent",color:De}}," no file open "))};var Ya=function(){var e=Object(de.c)((function(e){return e})),t=Object(a.useState)({}),n=Object(i.a)(t,2)[1];return window.reRenderFileMenu=function(){n({})},o.a.createElement(it,{alignItems:"center",flexWrap:"wrap",style:{width:"100%"}},o.a.createElement(Ka,{state:e,reRender:window.reRenderFileMenu}),o.a.createElement(Va,{state:e,reRender:window.reRenderFileMenu}),o.a.createElement(qa,{state:e}),o.a.createElement(Ea,null))},Za="".concat(Qe.width),Qa=function(e){return"".concat(e,"px")};var Ja=function(){var e=ha(),t=Object(a.useState)(!0),n=Object(i.a)(t,2),r=n[0],c=n[1],u=Object(a.useState)(Za),l=Object(i.a)(u,2),s=l[0],d=l[1],m=Object(Ht.b)({transform:r?"translate(0px, 0px)":"translate(".concat(s,"px, 0px)"),config:{tension:220,clamp:!0}}),f=Object(a.useState)(window.usingElectron?"spaceDB projects":"file"),p=Object(i.a)(f,2),v=p[0],b=p[1],w=Object(a.useRef)(null),g=Object(a.useRef)(null),O=Object(a.useRef)(null),h=Object(a.useRef)(null),I=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),C=!1,D=Object(a.useState)({}),j=Object(i.a)(D,2)[1];return Object(a.useEffect)((function(){window.addEventListener("resize",(function(){window.setTimeout((function(){j({})}),500)}))}),[]),o.a.createElement(Ht.a.div,{className:e.DrawerBounder,style:m,onPointerDown:function(e){return e.stopPropagation()}},o.a.createElement("div",{className:e.Toggle,ref:g,onPointerDown:function(e){var t;r&&e.shiftKey?(C=!0,null===(t=g.current)||void 0===t||t.setPointerCapture(e.pointerId)):c(!r)},onPointerMove:function(e){C&&(Za="".concat(Ft(I-e.clientX,[150,700])),w.current&&(w.current.style.width=Qa(Za)),O.current&&(O.current.style.width=Qa(Za)),h.current&&(h.current.style.width=Qa(Za)),g.current&&(g.current.style.right=Qa(Za)))},onPointerUp:function(e){var t;C&&(C=!1,d(Za),null===(t=g.current)||void 0===t||t.releasePointerCapture(e.pointerId))}},o.a.createElement("div",{className:e.ToggleLine,onClick:function(){c(!r)}})),o.a.createElement("div",{className:e.Drawer,ref:w},o.a.createElement("div",{className:e.DrawerHeader,ref:O,onWheel:function(e){O&&O.current&&(O.current.scrollLeft+=e.deltaY)}},window.usingElectron?o.a.createElement(Ia,{className:e.DrawerHeaderItem,text:"spaceDB projects",onClick:function(){b("spaceDB projects")},selectedRoute:v}):null,o.a.createElement(Ia,{className:e.DrawerHeaderItem,text:"file",onClick:function(){b("file")},selectedRoute:v})),o.a.createElement("div",{className:e.ItemRouter,ref:h},"spaceDB projects"===v?o.a.createElement(ja,null):"file"===v?o.a.createElement(Ya,null):null)))};var Xa=function(e){var t=e.id,n=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(!window.audioModules[t]){var e=G(n);e&&(window.audioModules=Object(v.a)(Object(v.a)({},window.audioModules),{},Object(p.a)({},t,e)))}})),o.a.createElement("audio",{ref:n,autoPlay:!0})};window.addAudioTag=function(e){window.audioTags[e]={id:e,srcName:""}},window.audioTags={},window.numberRestores=0;var $a=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1];window.reRenderAudioTags=function(){r(!n)};var c=Object.keys(window.audioTags);return o.a.createElement(a.Fragment,null,c.map((function(e){return o.a.createElement(Xa,{key:e+window.numberRestores,id:e})})))},eo=Object(u.a)({CMInputBounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},CenterMenuInput:{backgroundColor:me,color:"white",height:"2vmin",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:Xe.small,width:"15vmin","&:hover":{cursor:"text"}}}),to=Object(u.a)({CenterMenuBounder:{backgroundColor:we,backdropFilter:"blur(5px)",position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:s},CenterMenu:{backgroundColor:be,position:"fixed",top:"50vh",left:"50vw",transform:"translate(-50%, calc(-50% - 50px))",display:"flex",flexDirection:"column",alignItems:"center",borderRadius:"1.2vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",minWidth:"15vw",padding:"1vmin 2vmin 2vmin 2vmin",border:".1em solid ".concat(ge)},Header:{padding:"1vmin 2vmin",margin:"0vmin 0vmin 2vmin 0vmin",borderColor:"white",borderStyle:"none none solid none",fontSize:Xe.large}});var no=function(e){var t=e.isClosed,n=e.className,r=e.style,c=e.headerClassName,i=e.headerStyle,u=e.children,l=e.header,s=e.onClose,d=e.bounderStyle,m=to();return o.a.createElement(a.Fragment,null,t?null:o.a.createElement(Ht.a.div,{className:m.CenterMenuBounder,onPointerDown:function(e){e.stopPropagation(),s()},style:d},o.a.createElement("div",{className:n?"".concat(m.CenterMenu," ").concat(n):m.CenterMenu,onPointerDown:function(e){e.stopPropagation()},style:r},l?o.a.createElement("div",{className:c?"".concat(m.Header," ").concat(c):m.Header,style:i},l):null,u)))};function ao(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,controlID:t,onChangeSubmit:n}}var oo=function(){var e=Object(a.useState)(ao(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.controlID,u=n.onChangeSubmit,l=t[1],s=Object(de.c)((function(e){return e.modules})),d=Object(a.useState)(0),m=Object(i.a)(d,2),f=m[0],p=m[1],v=Object(a.useState)(0),b=Object(i.a)(v,2),w=b[0],g=b[1],O=Object(a.useState)(void 0),h=Object(i.a)(O,2),I=h[0],C=h[1];window.openKnobRangeSetMenu=function(e,t,n){var a=s[e].controlData[t],o=a.range,r=a.maxRange;l(ao(!0,t,n)),p(o[0]),g(o[1]),C(r)};var D=function(){l(ao(!1))},j=eo();return o.a.createElement(no,{isClosed:!r,header:"set ".concat(c," range"),onClose:D},o.a.createElement("div",{style:{fontSize:Xe.small}},I?"max range from ".concat(I[0]," to ").concat(I[1]):null),o.a.createElement("div",{className:j.CMInputBounder,onKeyDown:function(e){"Escape"===e.key?D():"Enter"===e.key&&(u([f,w]),D())}},o.a.createElement("input",{className:j.CenterMenuInput,onChange:function(e){p(Number(e.target.value))},value:f,type:"number"}),o.a.createElement("input",{className:j.CenterMenuInput,onChange:function(e){g(Number(e.target.value))},value:w,type:"number"})),o.a.createElement(jt,{style:{fontSize:Xe.small,backgroundColor:_e},onClick:function(){I?Pt(f,I)&&Pt(w,I)?w>f?(u([f,w]),D()):alert("min must be less than max"):alert("a value is not within maximum range bounds"):w>f?(u([f,w]),D()):alert("min must be less than max")}},"confirm"))},ro=Object(u.a)({CenterMenuInput:{backgroundColor:me,color:"white",height:"1em",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:Xe.medium,textAlign:"center","&:hover":{cursor:"text"}}});function co(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,saveList:t,preOnClose:n}}var io=function(){var e=Object(a.useState)(co(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.saveList,u=n.preOnClose,l=t[1],s=Object(de.c)((function(e){return e})),d=s.baseContainerID,m=s.modules,f=Object(a.useState)(""),p=Object(i.a)(f,2),v=p[0],b=p[1],w=Object(a.useState)({isOpen:!1,message:""}),g=Object(i.a)(w,2),O=g[0],h=g[1];window.openSpaceDBProjectSaveMenu=function(e,t){b(m[d].name),h({isOpen:!1,message:""}),l(co(!0,e,t))};var I=function(){u(),l(co(!1))},C=Object(a.useRef)(null),D=ro();return o.a.createElement(no,{header:"save project",isClosed:!r,onClose:I},o.a.createElement(it,{style:{alignItems:"center"}},o.a.createElement("input",{className:D.CenterMenuInput,value:v,placeholder:m[d].name,onChange:function(e){b(e.target.value)},onKeyDown:function(e){switch(e.key){case"Enter":kt(v,c)?h({isOpen:!0,message:"would you like to overwrite this save?"}):(window.projectSaveService.create({saveName:v,state:s}).then((function(e){e&&window.flashNotification("green","project saved")})),I());break;case"Escape":I()}},ref:C,autoFocus:!0}),o.a.createElement(jt,{onPointerDown:function(e){return e.preventDefault()},onClick:function(e){e.preventDefault(),kt(v,c)?h({isOpen:!0,message:"save already exists. do you want to replace it?"}):(window.projectSaveService.create({saveName:v,state:s}).then((function(e){e&&window.flashNotification("green","project saved")})),I())}},"save to spaceDB")),O.isOpen?o.a.createElement(dt,null,o.a.createElement("div",{style:{fontSize:Xe.small}},O.message),o.a.createElement(it,{style:{justifyContent:"center"}},o.a.createElement(jt,{style:{backgroundColor:Ue,marginRight:"3vmin"},onClick:function(){var e;null===(e=C.current)||void 0===e||e.focus(),h({isOpen:!1,message:""})}},"no"),o.a.createElement(jt,{style:{backgroundColor:_e},onClick:function(){window.projectSaveService.update(v,s).then((function(e){e&&window.flashNotification("green","project updated")})),I()}},"yes"))):null)};function uo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return{isOpen:e,saveName:t,preOnClose:n}}var lo=function(){var e=Object(a.useState)(uo(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.saveName,u=n.preOnClose,l=t[1];window.openConfirmDeleteMenu=function(e,t){l(uo(!0,e,t))};var s=function(){u(),l(uo(!1))};return o.a.createElement(no,{header:"are you sure you want to delete ".concat(c,"?"),isClosed:!r,onClose:s},o.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"}},o.a.createElement(jt,{style:{backgroundColor:Ue,marginRight:"3vmin"},onClick:function(){s()}},"no"),o.a.createElement(jt,{style:{backgroundColor:_e},onClick:function(){window.projectSaveService.remove(c),s()}},"yes")))};function so(e,t,n,a,o,r){if(kt(n,a))e({isOpen:!0,message:"module with this name already exists. would you like to update it?"});else{var c=ca(o,t),i=c.modules,u=c.connections;window.containerSaveService.create({saveName:n,containerID:t,modules:i,connections:u}).then((function(e){e&&(window.flashNotification("green","module saved to spaceDB"),window.refreshSpaceDBModules())})),r()}}function mo(e,t,n){return fo.apply(this,arguments)}function fo(){return(fo=Object(xa.a)(Na.a.mark((function e(t,n,a){var o,r,c,i;return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=ca(a,n),r=o.modules,c=o.connections,i={containerID:n,modules:r,connections:c},e.next=4,Ua(window.moduleDirectoryHandle,t,i);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var po="",vo="";var bo=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(""),u=Object(i.a)(c,2),l=u[0],s=u[1],d=Object(a.useState)(!1),m=Object(i.a)(d,2),f=m[0],p=m[1],v=Object(de.c)((function(e){return e}));window.openFileContainerSaveMenu=function(e){vo=e,po=v.modules[e].name,s(po),p(!1),r(!0)};var b=function(){r(!1)};function w(){return g.apply(this,arguments)}function g(){return(g=Object(xa.a)(Na.a.mark((function e(){return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!kt(l,window.fileModuleSaveNames)){e.next=4;break}p(!0),e.next=8;break;case 4:return e.next=6,mo(l,vo,v);case 6:window.flashNotification(Ye,"".concat(l," saved to file")),b();case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=ro(),h=Object(a.useRef)(null);return o.a.createElement(no,{header:"",isClosed:!n,onClose:b},o.a.createElement("input",{className:O.CenterMenuInput,onChange:function(e){s(e.target.value)},value:l,placeholder:po,onKeyDown:function(e){switch(e.key){case"Enter":w();break;case"Esc":b()}},ref:h,autoFocus:!0}),o.a.createElement(jt,{onClick:w},"save"),o.a.createElement(ot,{showIf:f},o.a.createElement(dt,null,o.a.createElement("div",null,"module with this name already exists. would you like to update it?"),o.a.createElement(it,null,o.a.createElement(jt,{onClick:function(){h.current&&(h.current.value="",h.current.focus()),p(!1)}},"no"),o.a.createElement(jt,{onClick:function(){mo(l,vo,v),b()}},"yes")))))};function wo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return{isOpen:e,id:t,saveList:n,preOnClose:a,initName:o}}var go=function(){var e=Object(a.useState)(wo(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.id,u=n.saveList,l=n.preOnClose,s=n.initName,d=t[1],m=Object(de.c)((function(e){return e})),f=Object(a.useState)(""),p=Object(i.a)(f,2),v=p[0],b=p[1];window.openSpaceDBContainerSaveMenu=function(e,t,n){d(wo(!0,t,e,n,m.modules[t].name)),b(m.modules[t].name)};var w=function(){l(),d(wo(!1))},g=Object(a.useState)({isOpen:!1,message:""}),O=Object(i.a)(g,2),h=O[0],I=O[1],C=Object(a.useRef)(null),D=ro();return o.a.createElement(no,{header:"save container module",isClosed:!r,onClose:w},o.a.createElement("input",{className:D.CenterMenuInput,value:v,placeholder:s,ref:C,onChange:function(e){b(e.target.value)},onKeyDown:function(e){switch(e.key){case"Enter":so(I,c,v,u,m,w);break;case"Escape":w()}},autoFocus:!0}),o.a.createElement(jt,{onClick:function(){so(I,c,v,u,m,w)}},"confirm"),h.isOpen?o.a.createElement(a.Fragment,null,o.a.createElement("div",{style:{fontSize:Xe.small}},h.message),o.a.createElement("div",{style:{display:"flex"}},o.a.createElement(jt,{style:{backgroundColor:Ue},onClick:function(){C.current&&(C.current.value="",C.current.focus()),I({isOpen:!1,message:""})}},"no"),o.a.createElement(jt,{style:{backgroundColor:_e},onClick:function(){var e=ca(m,c),t=e.modules,n=e.connections;window.containerSaveService.update(v,{saveName:v,containerID:c,modules:t,connections:n}).then((function(e){e&&(window.flashNotification("green","module updated"),window.refreshSpaceDBModules())})),w()}},"yes"))):null)};function Oo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return{isOpen:e,onChangeSubmit:t}}var ho=function(){var e=Object(a.useState)(Oo(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.onChangeSubmit,u=t[1],l=Object(a.useState)(0),s=Object(i.a)(l,2),d=s[0],m=s[1],f=Object(a.useState)(0),p=Object(i.a)(f,2),v=p[0],b=p[1];window.openAnalyzerRangeSetMenu=function(e,t){m(e[0]),b(e[1]),u(Oo(!0,t))};var w=function(){u(Oo(!1))},g=eo();return o.a.createElement(no,{isClosed:!r,header:"set analyzer range",onClose:w},o.a.createElement("div",{className:g.CMInputBounder,onKeyDown:function(e){"Escape"===e.key?w():"Enter"===e.key&&(c([d,v]),w())}},o.a.createElement("input",{className:g.CenterMenuInput,onChange:function(e){m(Number(e.target.value))},value:d,type:"number"}),o.a.createElement("input",{className:g.CenterMenuInput,onChange:function(e){b(Number(e.target.value))},value:v,type:"number"})),o.a.createElement(jt,{style:{fontSize:Xe.small,backgroundColor:_e},onClick:function(){c([d,v]),w()}},"confirm"))},Io=Object(u.a)({CMInputBounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},CenterMenuInput:{backgroundColor:me,color:"white",height:"2vmin",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:Xe.small,width:"23vmin","&:hover":{cursor:"text"}},InputSubmit:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:me,height:"2vmin",padding:"1vmin",margin:"1.5vmin 1.5vmin 1.5vmin 0.75vmin",borderRadius:"1vmin","&:hover":{cursor:"pointer"},fontSize:Xe.small},Error:{backgroundColor:Ne,width:"90%",color:"white",fontSize:Xe.small,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"1vmin",padding:"1vmin 0vmin",marginBottom:"1vmin"}});var Co=function(e){var t=e.isOpen,n=e.header,r=e.onSubmit,c=e.placeholder,u=e.onClose,l=Io(),s=Object(a.useState)(""),d=Object(i.a)(s,2),m=d[0],f=d[1],p=Object(a.useState)(!1),v=Object(i.a)(p,2),b=v[0],w=v[1];function g(){m.length>0?(r(m),u(),f("")):w(!0)}return o.a.createElement(no,{isClosed:!t,header:n,onClose:function(){u(),f("")}},o.a.createElement("div",{className:l.CMInputBounder},o.a.createElement("input",{className:l.CenterMenuInput,placeholder:c,value:m,onChange:function(e){f(e.target.value)},onKeyDown:function(e){switch(e.key){case"Enter":g();break;case"Escape":u()}},autoFocus:!0}),o.a.createElement(jt,{onClick:function(){g()}},"confirm"),b?o.a.createElement("div",{className:l.Error},"please enter a name"):null))};function Do(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{isOpen:e,toRenameID:t}}var jo=function(){var e,t=Object(a.useState)(Do(!1)),n=Object(i.a)(t,2),r=n[0],c=r.isOpen,u=r.toRenameID,l=n[1];window.openModuleRenameMenu=function(e){l(Do(!0,e))};var s=Object(de.c)((function(e){return e.modules})),d=Object(de.b)();return o.a.createElement(Co,{header:"rename module",isOpen:c,onSubmit:function(e){d(function(e,t){return{type:"RENAME_MODULE",id:e,newName:t}}(u,e))},placeholder:null===(e=s[u])||void 0===e?void 0:e.name,onClose:function(){l(Do(!1))}})};function Eo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0;return{isOpen:e,placeholder:t,containerControl:a,parentModID:n}}var yo=function(){var e=Object(a.useState)(Eo(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.placeholder,u=n.containerControl,l=n.parentModID,s=t[1];window.openControlRenameMenu=function(e,t,n){s(Eo(!0,e,t,n))};var d=Object(de.b)();return o.a.createElement(Co,{header:"rename control",isOpen:r,onSubmit:function(e){var t=u,n=t.modID,a=t.controlID,o=t.actualModID;d(function(e,t,n,a,o){return{type:"RENAME_CONTAINER_CONTROL",name:e,parentModID:t,modID:n,controlID:a,actualModID:o}}(e,l,n,a,o)),window.flashNotification("green","control passthrough renamed")},placeholder:c,onClose:function(){return s(Eo(!1))}})},No=Object(u.a)({LeftBar:{width:nt.leftBarWidth,backgroundColor:Ke},LeftBarButton:{borderRadius:"0em",margin:"0em",backgroundColor:"transparent",borderColor:"transparent",borderWidth:"1px","&:hover":{borderColor:"transparent"}},RouterBounder:{alignItems:"center"},IconRouter:{width:nt.iconRouterWidth,height:nt.height,overflowY:"scroll",display:"grid",gridTemplateColumns:"repeat(3, auto)",gridAutoRows:"20vmin",gridAutoFlow:"row",placeItems:"center","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},SearchBar:{width:"80%",height:"1.5em",marginTop:"1.3em",marginBottom:".4em",fontSize:Xe.small,backgroundColor:Ve,color:qe,textAlign:"center",borderStyle:"none",borderRadius:".2em","&:focus":{outline:"none"}}});var xo=function(e){var t=e.selectedGroup,n=e.setSG,a=No();return o.a.createElement(dt,{className:a.LeftBar},Qo.filter((function(e){return window.usingElectron||e!==qo})).map((function(e,r){var c=e===t;return o.a.createElement(jt,{className:a.LeftBarButton,key:r,style:{color:c?Ce:"white"},onClick:function(){n(e)}},e)})))},So=Object(u.a)({DrawerItem:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-evenly",borderRadius:"10px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},DrawerIcon:{backgroundColor:me,borderColor:me,borderStyle:"solid",width:Qe.item,height:Qe.item,borderRadius:"1.5vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",marginBottom:"1.5vmin","&:hover":{cursor:"pointer",borderColor:"white"}},DrawerItemText:{fontSize:Xe.small}});var Mo=function(e){var t=e.fullName,n=e.shortName,a=e.moduleType,r=e.isFocussed,c=e.totNumModules,i=e.row,u=e.col,l=e.onClose,s=So(),d=Object(de.b)();function m(){window.addModule(la(0,c),n,window.fillContainerID,a,d,i,u),l()}return r&&(window.addSelectedSearchModule=m),o.a.createElement("div",{className:s.DrawerItem},o.a.createElement("div",{className:s.DrawerIcon,style:{backgroundColor:ut(a),borderColor:r?"white":me},onFocus:function(e){e.preventDefault(),console.log("focussing 2")},onClick:m,draggable:!0,onDragStart:function(e){e.persist(),e.dataTransfer.setData("type","ADD_MODULE"),e.dataTransfer.setData("id",la(0,c)),e.dataTransfer.setData("moduleType",a),e.dataTransfer.setData("name",n)},onKeyDown:function(e){switch(e.key){case"Enter":m()}}}),o.a.createElement("div",{className:s.DrawerItemText},t))};var To=function(e){var t=e.totNumModules,n=e.moduleData,r=e.row,c=e.col,u=e.onClose;return o.a.createElement(a.Fragment,null,n.map((function(e,n){var a=Object(i.a)(e,3),l=a[0],s=a[1],d=a[2];return o.a.createElement(Mo,{key:n,fullName:l,shortName:s,moduleType:d,totNumModules:t,row:r,col:c,onClose:u})})))},ko=[["gain","gain","GAIN"],["filter","filter","AUTOFILTER"],["kompressor","komp","KOMPRESSOR"],["signal delay","delay","SIGNAL_DELAY"],["stereo panner","pan","STEREO_PANNER"],["distortion","dist","DISTORTION"]],Ro=[["file","file","MEDIA_ELEMENT"],["stream","stream","LINE_IN"],["oscillator","osc","OSCILLATOR"],["constant","const","CONSTANT"],["enveloped pad","env","ENVELOPED_TRIGGER"],["white noise","noise","WHITE_NOISE"]],Ao=[["container","cntnr",b],["output","out","OUTPUT"],["analyzer","analyzer","ANALYZER"],["tuner","tuner","TUNER"],["visualizer","viz","VISUALIZER"]],Fo=ko.concat(Ro).concat(Ao);var Po=function(e){var t=e.moduleName,n=e.totNumberModules,a=e.totNumberConnections,r=e.onClose,c=e.row,i=e.col,u=e.isFocussed,l=So(),s=Object(de.b)();function d(){window.containerSaveService.get(t).then((function(e){var t=e.containerID,o=e.modules,r=e.connections;da(s,o,r,n,a,window.fillContainerID,t,c,i)})),r()}return u&&(window.addSelectedSearchModule=d),o.a.createElement("div",{className:l.DrawerItem},o.a.createElement("div",{className:l.DrawerIcon,style:{backgroundColor:ut(b),borderColor:u?"white":me},onClick:d,onContextMenu:function(e){e.preventDefault(),e.persist(),window.openSDBModuleContextMenu(e,t)}}),o.a.createElement("div",{className:l.DrawerItemText},t))};var Bo=function(e){var t=e.spaceDBModules,n=e.totNumModules,r=e.totNumConnections,c=e.onClose,i=e.row,u=e.col;return Object(a.useEffect)((function(){window.refreshSpaceDBModules()}),[]),o.a.createElement(a.Fragment,null,t.map((function(e,t){return o.a.createElement(Po,{moduleName:e,key:t,totNumberModules:n,totNumberConnections:r,onClose:c,row:i,col:u})})))};var Lo=function(e){var t=e.name,n=e.totNumModules,a=e.totNumConnections,r=e.row,c=e.col,i=e.onClose,u=e.isFocussed,l=So();function s(){return d.apply(this,arguments)}function d(){return(d=Object(xa.a)(Na.a.mark((function e(){var o,u,l,s;return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wa(window.moduleDirectoryHandle,t);case 2:o=e.sent,u=o.containerID,l=o.modules,s=o.connections,da(m,l,s,n,a,window.fillContainerID,u,r,c),i();case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}u&&(window.addSelectedSearchModule=s);var m=Object(de.b)();return o.a.createElement("div",{className:l.DrawerItem},o.a.createElement("div",{className:l.DrawerIcon,style:{backgroundColor:ut(b),borderColor:u?"white":me},onClick:s}),o.a.createElement("div",{className:l.DrawerItemText},t))};var zo=function(e){var t=e.query,n=e.spaceDBModules,r=e.totNumModules,c=e.totNumConnections,u=e.onClose,l=e.row,s=e.col,d=t.toUpperCase(),m=n.filter((function(e){return e.toUpperCase().slice(0,d.length)===d})),f=Fo.filter((function(e){return Object(i.a)(e,2)[0].toUpperCase().slice(0,d.length)===d})),p=window.fileModuleSaveNames.filter((function(e){return e.toUpperCase().slice(0,d.length)===d}));return o.a.createElement(a.Fragment,null,m.map((function(e,t){return o.a.createElement(Po,{key:e,moduleName:e,totNumberModules:r,totNumberConnections:c,onClose:u,row:l,col:s,isFocussed:0===t})})),p.map((function(e,t){return o.a.createElement(Lo,{key:e,name:e,totNumModules:r,totNumConnections:c,onClose:u,row:l,col:s,isFocussed:0===m.length&&0===t})})),f.map((function(e,t){var n=Object(i.a)(e,3),a=n[0],c=n[1],d=n[2];return o.a.createElement(Mo,{isFocussed:0===m.length&&0===p.length&&0===t,key:t,fullName:a,shortName:c,moduleType:d,totNumModules:r,row:l,col:s,onClose:u})})))};window.fileModuleSaveNames=[];var _o=function(e){var t=e.totNumModules,n=e.totNumConnections,r=e.row,c=e.col,u=e.onClose,l=Object(a.useState)(window.fileModuleSaveNames),s=Object(i.a)(l,2),d=s[0],m=s[1];return o.a.createElement(a.Fragment,null,window.moduleDirectoryHandle?0===d.length?o.a.createElement(a.Fragment,null,o.a.createElement(jt,{fontSize:Xe.small,notClickable:!0},"no modules in this directory. save modules by right clicking a custom container, and selecting save to file."),o.a.createElement(jt,{onClick:Object(xa.a)(Na.a.mark((function e(){return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showDirectoryPicker();case 2:return window.moduleDirectoryHandle=e.sent,e.next=5,za(window.moduleDirectoryHandle);case 5:window.fileModuleSaveNames=e.sent,m(window.fileModuleSaveNames);case 7:case"end":return e.stop()}}),e)})))},"change directory")):d.map((function(e,a){return o.a.createElement(Lo,{key:a,name:e,onClose:u,totNumModules:t,totNumConnections:n,row:r,col:c})})):o.a.createElement(jt,{onClick:Object(xa.a)(Na.a.mark((function e(){return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showDirectoryPicker();case 2:return window.moduleDirectoryHandle=e.sent,e.next=5,za(window.moduleDirectoryHandle);case 5:window.fileModuleSaveNames=e.sent,m(window.fileModuleSaveNames);case 7:case"end":return e.stop()}}),e)})))},"select module directory"))};var Uo,Go=function(e){var t=e.selectedGroup,n=e.row,a=e.col,r=e.onClose,c=e.query,i=e.spaceDBModules,u=Object(de.c)((function(e){return Object.keys(e.modules).length})),l=Object(de.c)((function(e){return Object.keys(e.connections).length})),s=No();return o.a.createElement("div",{className:s.IconRouter},o.a.createElement(To,{totNumModules:u,moduleData:t===Ho?ko:t===Ko?Ro:t===Vo?Ao:[],row:n,col:a,onClose:r}),t!==qo?null:o.a.createElement(Bo,{spaceDBModules:i,totNumModules:u,totNumConnections:l,onClose:r,row:n,col:a}),t!==Yo?null:o.a.createElement(_o,{onClose:r,totNumModules:u,totNumConnections:l,row:n,col:a}),t!==Zo?null:o.a.createElement(zo,{query:c,spaceDBModules:i,totNumModules:u,totNumConnections:l,onClose:r,row:n,col:a}))};var Wo=function(e){var t=e.selectedGroup,n=e.setSG,a=e.setQuery,r=e.searchRef,c=e.onClose,i=No();return t!==Zo&&(Uo=t),o.a.createElement("input",{className:i.SearchBar,ref:r,onChange:function(e){0===e.target.value.length?(n(Uo),window.addSelectedSearchModule=function(){}):(a(e.target.value),n(Zo))},onKeyDown:function(e){switch(e.key){case"Escape":c();break;case"Enter":window.addSelectedSearchModule()}},placeholder:"search"})},Ho="effects",Ko="sources",Vo="utility",qo="spaceDB",Yo="local file",Zo="search",Qo=[Ho,Ko,Vo,qo,Yo];function Jo(e,t,n){return{isOpen:e,row:t,col:n}}var Xo=function(){var e=Object(a.useState)(Jo(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.row,u=n.col,d=t[1],m=Object(a.useRef)(null);window.openAddModuleMenu=function(e,t){I(""),d(Jo(!0,e,t)),m.current&&(m.current.value="",m.current.focus())};var f=function(){d(Jo(!1))},p=Object(a.useState)(Ho),v=Object(i.a)(p,2),b=v[0],w=v[1],g=Object(a.useState)(""),O=Object(i.a)(g,2),h=O[0],I=O[1],C=Object(a.useState)([]),D=Object(i.a)(C,2),j=D[0],E=D[1];window.refreshSpaceDBModules=function(){window.containerSaveService.find().then((function(e){E(e)}))};var y=Object(Ht.b)({opacity:r?1:0,config:{tension:270}});Object(a.useEffect)((function(){window.usingElectron&&window.refreshSpaceDBModules()}),[]);var N=No();return o.a.createElement(no,{header:"add module",onClose:f,bounderStyle:Object.assign({},y,{zIndex:r?s:l-1})},o.a.createElement(it,null,o.a.createElement(dt,{className:N.RouterBounder},o.a.createElement(Wo,{selectedGroup:b,setSG:w,setQuery:I,searchRef:m,onClose:f}),o.a.createElement(xo,{selectedGroup:b,setSG:w})),o.a.createElement(Go,{selectedGroup:b,row:c,col:u,onClose:f,query:h,spaceDBModules:j})))},$o=function(e,t){var n,a,o=t.id,r=t.name,c=t.moduleType,i=t.controlData,u=t.row,l=t.col,s=t.parentID,d=t.connectionInputs,m=t.connectionOutputs;switch(c){case b:return Object.assign({},e,(n={},Object(p.a)(n,o,{id:o,name:r,row:u,col:l,parentID:s,moduleType:c,controlData:i,connectionInputs:d,connectionOutputs:m,inputs:[],outputs:[],containerControls:[],toContainerControls:[],childModules:[],isBaseContainer:!1,isContainerInput:!1,isContainerOutput:!1}),Object(p.a)(n,s,Object(v.a)(Object(v.a)({},e[s]),{},{childModules:[].concat(Object(Z.a)(e[s].childModules),[o])})),n));default:return Object.assign({},e,(a={},Object(p.a)(a,o,{id:o,name:r,row:u,col:l,parentID:s,moduleType:c,controlData:i,connectionInputs:d,connectionOutputs:m,toContainerControls:[],isContainerInput:!1,isContainerOutput:!1,inputs:[],outputs:[]}),Object(p.a)(a,s,Object(v.a)(Object(v.a)({},e[s]),{},{childModules:[].concat(Object(Z.a)(e[s].childModules),[o])})),a))}},er=function(e,t){var n=t.id,a=t.newRow,o=t.newCol;return Object.assign({},e,Object(p.a)({},n,Object(v.a)(Object(v.a)({},e[n]),{},{row:a,col:o})))},tr=function(e,t){var n=t.id,a=t.newName;return Object.assign({},e,Object(p.a)({},n,Object(v.a)(Object(v.a)({},e[n]),{},{name:a})))},nr=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(p.a)(n,a,Object(v.a)(Object(v.a)({},e[a]),{},{isContainerInput:!0})),Object(p.a)(n,o,Object(v.a)(Object(v.a)({},e[o]),{},{connectionInputs:[].concat(Object(Z.a)(e[o].connectionInputs),[a])})),n))},ar=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(p.a)(n,a,Object(v.a)(Object(v.a)({},e[a]),{},{isContainerInput:!1})),Object(p.a)(n,o,Object(v.a)(Object(v.a)({},e[o]),{},{connectionInputs:e[o].connectionInputs.filter((function(e){return e!==a}))})),n))},or=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(p.a)(n,a,Object(v.a)(Object(v.a)({},e[a]),{},{isContainerOutput:!0})),Object(p.a)(n,o,Object(v.a)(Object(v.a)({},e[o]),{},{connectionOutputs:[].concat(Object(Z.a)(e[o].connectionOutputs),[a])})),n))},rr=function(e,t){var n,a=t.id,o=e[a].parentID;return Object.assign({},e,(n={},Object(p.a)(n,a,Object(v.a)(Object(v.a)({},e[a]),{},{isContainerInput:!1})),Object(p.a)(n,o,Object(v.a)(Object(v.a)({},e[o]),{},{connectionOutputs:e[o].connectionOutputs.filter((function(e){return e!==a}))})),n))},cr=function(e,t){var n,a,o=t.modID,r=t.controlID,c=t.actualModID,i=t.name,u=e[o].parentID;return e[o].moduleType===b?Object.assign({},e,(n={},Object(p.a)(n,o,Object(v.a)(Object(v.a)({},e[o]),{},{containerControls:e[o].containerControls.map((function(e){return e.controlID!==r||e.actualModID!==c?e:Object(v.a)(Object(v.a)({},e),{},{markedToContainer:!0})}))})),Object(p.a)(n,u,Object(v.a)(Object(v.a)({},e[u]),{},{containerControls:[].concat(Object(Z.a)(e[u].containerControls),[{modID:o,controlID:r,actualModID:c,name:i,markedToContainer:!1}])})),n)):Object.assign({},e,(a={},Object(p.a)(a,c,Object(v.a)(Object(v.a)({},e[c]),{},{controlData:Object(v.a)(Object(v.a)({},e[c].controlData),{},Object(p.a)({},r,Object(v.a)(Object(v.a)({},e[c].controlData[r]),{},{markedToContainer:!0})))})),Object(p.a)(a,u,Object(v.a)(Object(v.a)({},e[u]),{},{containerControls:[].concat(Object(Z.a)(e[u].containerControls),[{modID:o,controlID:r,actualModID:c,name:i,markedToContainer:!1}])})),a))},ir=function(e,t){var n,a,o=t.modID,r=t.controlID,c=t.actualModID,i=e[o].parentID;return e[o].moduleType===b?Object.assign({},e,(n={},Object(p.a)(n,o,Object(v.a)(Object(v.a)({},e[o]),{},{containerControls:e[o].containerControls.map((function(e){return e.controlID!==r||e.actualModID!==c?e:Object(v.a)(Object(v.a)({},e),{},{markedToContainer:!1})}))})),Object(p.a)(n,i,Object(v.a)(Object(v.a)({},e[i]),{},{containerControls:e[i].containerControls.filter((function(e){return e.modID!==o||e.controlID!==r||e.actualModID!==c}))})),n)):Object.assign({},e,(a={},Object(p.a)(a,c,Object(v.a)(Object(v.a)({},e[c]),{},{controlData:Object(v.a)(Object(v.a)({},e[c].controlData),{},Object(p.a)({},r,Object(v.a)(Object(v.a)({},e[c].controlData[r]),{},{markedToContainer:!1})))})),Object(p.a)(a,i,Object(v.a)(Object(v.a)({},e[i]),{},{containerControls:e[i].containerControls.filter((function(e){return e.modID!==o||e.controlID!==r||e.actualModID!==c}))})),a))},ur=function(e,t){var n=t.name,a=t.parentModID,o=(t.modID,t.controlID),r=t.actualModID,c=e[a];return Object.assign({},e,Object(p.a)({},a,Object(v.a)(Object(v.a)({},c),{},{containerControls:c.containerControls.map((function(e){return e.controlID!==o||e.actualModID!==r?e:Object(v.a)(Object(v.a)({},e),{},{name:n})}))})))},lr=function(e,t){var n=t.modID,a=t.controlID,o=t.newValue;return Object.assign({},e,Object(p.a)({},n,Object(v.a)(Object(v.a)({},e[n]),{},{controlData:Object(v.a)(Object(v.a)({},e[n].controlData),{},Object(p.a)({},a,Object(v.a)(Object(v.a)({},e[n].controlData[a]),{},{value:o})))})))},sr=function(e,t){var n=t.modID,a=t.controlID,o=t.newRange;return Object.assign({},e,Object(p.a)({},n,Object(v.a)(Object(v.a)({},e[n]),{},{controlData:Object(v.a)(Object(v.a)({},e[n].controlData),{},Object(p.a)({},a,Object(v.a)(Object(v.a)({},e[n].controlData[a]),{},{range:o,value:Ft(e[n].controlData[a].value,o)})))})))},dr={project:{id:"project",name:"project",row:0,col:0,moduleType:b,controlData:{open:{controlType:"BUTTON",paramID:"n/a"}},connectionInputs:[],connectionOutputs:[],inputs:[],outputs:[],parentID:null,childModules:[],isBaseContainer:!0,isContainerInput:!1,isContainerOutput:!1,containerControls:[]}},mr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dr,t=arguments.length>1?arguments[1]:void 0;if(!t)return e;switch(t.type){case"ADD_MODULE":return $o(e,t);case"MOVE_MODULE":return er(e,t);case"RENAME_MODULE":return tr(e,t);case"MARK_CONTAINER_INPUT":return nr(e,t);case"UNMARK_CONTAINER_INPUT":return ar(e,t);case"MARK_CONTAINER_OUTPUT":return or(e,t);case"UNMARK_CONTAINER_OUTPUT":return rr(e,t);case"MARK_CONTAINER_CONTROL":return cr(e,t);case"UNMARK_CONTAINER_CONTROL":return ir(e,t);case"UPDATE_CONTROL_DATA":return lr(e,t);case"UPDATE_CONTROL_RANGE":return sr(e,t);case"RENAME_CONTAINER_CONTROL":return ur(e,t);default:return e}},fr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"project",t=arguments.length>1?arguments[1]:void 0;if(!t)return e;switch(t.type){case"DOWN_1_BASE":case"CHANGE_BASE":return t.newID;default:return e}},pr=function(e,t,n){var a,o=n.fromID,r=n.toID,c=n.param,i=n.outputIndex,u=n.inputIndex,l=n.containerOutputChildID,s=n.containerInputChildID,d=la(0,Object.keys(t).length);return{newModules:Object.assign({},e,(a={},Object(p.a)(a,o,Object(v.a)(Object(v.a)({},e[o]),{},{outputs:[].concat(Object(Z.a)(e[o].outputs),[d])})),Object(p.a)(a,r,Object(v.a)(Object(v.a)({},e[r]),{},{inputs:[].concat(Object(Z.a)(e[r].inputs),[d])})),a)),newConnections:Object(v.a)(Object(v.a)({},t),{},Object(p.a)({},d,{connectionID:d,fromID:o,toID:r,param:c,outputIndex:i,inputIndex:u,actualOutputID:l,actualInputID:s}))}},vr=function(e,t,n){var a,o=n.connectionID,r=t[o],c=r.fromID,i=r.toID,u=r.actualOutputID,l=r.actualInputID;return{newModules:Object.assign({},e,(a={},Object(p.a)(a,c,Object(v.a)(Object(v.a)({},e[c]),{},{outputs:e[c].outputs.filter((function(e){return e!==o}))})),Object(p.a)(a,i,Object(v.a)(Object(v.a)({},e[i]),{},{inputs:e[i].inputs.filter((function(e){return e!==o}))})),a),u?Object(p.a)({},u,Object(v.a)(Object(v.a)({},e[u]),{},{outputs:e[u].outputs.filter((function(e){return e!==o}))})):{},l?Object(p.a)({},l,Object(v.a)(Object(v.a)({},e[l]),{},{inputs:e[c].outputs.filter((function(e){return e!==o}))})):{}),newConnections:Bn(t,[o])}},br=function(e,t,n){var a=n.id,o=e[a].parentID,r=e[a].moduleType===b?function(e,t){return[e].concat(Object(Z.a)(aa(e,t)))}(a,e):[a],c=e[a].moduleType===b?[].concat(Object(Z.a)(e[a].inputs),Object(Z.a)(e[a].outputs),Object(Z.a)(oa(t,r))):[].concat(Object(Z.a)(e[a].inputs),Object(Z.a)(e[a].outputs)),i=Bn(e,r);return{newModules:Object.assign({},Object.fromEntries(Object.entries(i).map((function(t){return[t[0],Object(v.a)(Object(v.a)({},t[1]),{},{inputs:t[1].inputs.filter((function(t){return!kt(t,[].concat(Object(Z.a)(e[a].inputs),Object(Z.a)(e[a].outputs)))})),outputs:t[1].outputs.filter((function(t){return!kt(t,[].concat(Object(Z.a)(e[a].inputs),Object(Z.a)(e[a].outputs)))}))})]}))),Object(p.a)({},o,Object(v.a)(Object(v.a)({},e[o]),{},{childModules:e[o].childModules.filter((function(e){return e!==a})),connectionInputs:e[o].connectionInputs.filter((function(e){return e!==a})),connectionOutputs:e[o].connectionOutputs.filter((function(e){return e!==a})),containerControls:e[o].containerControls.filter((function(e){return e.modID!==a}))}))),newConnections:Bn(t,c)}},wr=function(e,t,n){var a,o=n.containerID,r=n.newModules,c=n.newConnections,i=n.row,u=n.col,l=n.parentID;return{newModules:Object.assign({},e,r,(a={},Object(p.a)(a,l,Object(v.a)(Object(v.a)({},e[l]),{},{childModules:[].concat(Object(Z.a)(e[l].childModules),[o])})),Object(p.a)(a,o,Object(v.a)(Object(v.a)({},r[o]),{},{parentID:l,row:i,col:u,isBaseContainer:!1})),a)),newConnections:Object.assign({},t,c)}},gr=function(e,t,n){switch(n.type){case"ADD_CONNECTION":return pr(e,t,n);case"REMOVE_CONNECTION":return vr(e,t,n);case"REMOVE_MODULE":return br(e,t,n);case"MERGE_CONTAINER":return wr(e,t,n);default:return{newModules:e,newConnections:t}}};function Or(e){var t=e?"undefined":window.localStorage.getItem("spaceState");if(t&&"undefined"!==t){var n=JSON.parse(t);return Ca({},n),n}return window.audioModules={},{modules:mr(),connections:{},baseContainerID:fr()}}var hr=Or();function Ir(e,t){return"ADD_CONNECTION"===t.type||"REMOVE_CONNECTION"===t.type||"REMOVE_MODULE"===t.type||"MERGE_CONTAINER"===t.type?gr(e.modules,e.connections,t):{newModules:mr(e.modules,t),newConnections:e.connections}}var Cr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hr,t=arguments.length>1?arguments[1]:void 0;if("RESTORE_FROM_STATE"===t.type){var n=t.state,a=Object.assign(n,n.connections?{}:{connections:{}});return window.localStorage.setItem("spaceState",JSON.stringify(a)),a}var o=Ir(e,t),r=o.newModules,c=o.newConnections,i={modules:r,connections:c,baseContainerID:fr(e.baseContainerID,t)};return window.localStorage.setItem("spaceState",JSON.stringify(i)),i};function Dr(e,t){var n=Or(!0);Ca(t,n),e(N(n)),window.flashNotification(Ye,"created blank project"),window.saveFileHandle=void 0,window.reRenderFileMenu()}var jr=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1];window.openConfirmBlankProjectMenu=function(){r(!0)};var c=function(){r(!1)},u=Object(de.c)((function(e){return e})),l=Object(de.b)();return o.a.createElement(no,{isClosed:!n,onClose:c},o.a.createElement("div",{style:{fontSize:Xe.medium,textAlign:"center"}}," would you like to save the current project before closing? "),o.a.createElement(it,null,o.a.createElement(jt,{onClick:function(){Dr(l,u.connections),c()}},"no"),o.a.createElement(jt,{onClick:Object(xa.a)(Na.a.mark((function e(){return Na.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.saveFileHandle){e.next=5;break}return e.next=3,Ma(window.saveFileHandle,u);case 3:e.next=7;break;case 5:return e.next=7,Aa(u);case 7:Dr(l,u.connections),c();case 9:case"end":return e.stop()}}),e)})))},"yes")))};var Er=function(){return o.a.createElement(a.Fragment,null,o.a.createElement(Xo,null),o.a.createElement(jo,null),o.a.createElement(yo,null),o.a.createElement(oo,null),o.a.createElement(ho,null),o.a.createElement(io,null),o.a.createElement(go,null),o.a.createElement(lo,null),o.a.createElement(bo,null),o.a.createElement(jr,null))};function yr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{isOpen:e,color:t,text:n}}var Nr=Object(u.a)({Notification:{position:"fixed",top:"10vh",left:"50vw",transform:"translate(-50%, 0%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"2vmin",borderRadius:"4vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",zIndex:1e3,fontSize:Xe.small}});var xr=function(){var e=Object(a.useState)(yr(!1)),t=Object(i.a)(e,2),n=t[0],r=n.isOpen,c=n.color,u=n.text,l=t[1],s=Object(a.useState)(!1),d=Object(i.a)(s,2),m=d[0],f=d[1],p=Nr();window.flashNotification=function(e,t){l(yr(!0,e,t)),f(!0),window.setTimeout((function(){f(!1)}),2500)};var v=Object(Ht.b)({opacity:m?1:0,onRest:function(){r||l(yr(!1))}});return o.a.createElement(ot,{showIf:r},o.a.createElement(Ht.a.div,{className:p.Notification,style:Object.assign({backgroundColor:c},v)},u))};window.fillContainerID="project",te(),le(),se();var Sr=function(){var e=f(),t=Object(a.useState)(ne(!1)),n=Object(i.a)(t,2),r=n[0],c=n[1];return window.openPointerLayer=function(e,t,n){c(ne(!0,e,t,n))},o.a.createElement("div",{className:e.Bounder},o.a.createElement("div",{className:e.ModuleViewBounder},o.a.createElement(Oa,null)),o.a.createElement(Ja,null),o.a.createElement($a,null),r.isOpen?o.a.createElement(oe,{pointerLayerData:r,resetPointerLayerData:function(){c(ne(!1))}}):null,o.a.createElement(Er,null),o.a.createElement(dn,null),o.a.createElement(xr,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Mr=n(48),Tr=n(83),kr=Object(Mr.createStore)(Cr,Object(Tr.composeWithDevTools)());c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(de.a,{store:kr},o.a.createElement(Sr,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},79:function(e,t,n){e.exports=n.p+"static/media/trash.9d2c8d42.svg"},80:function(e,t,n){e.exports=n.p+"static/media/settings.04e848f8.svg"},85:function(e,t,n){e.exports=n(131)},90:function(e,t,n){}},[[85,1,2]]]);
//# sourceMappingURL=main.c8b8ca48.chunk.js.map