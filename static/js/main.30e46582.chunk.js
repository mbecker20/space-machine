(this["webpackJsonpspace-machine"]=this["webpackJsonpspace-machine"]||[]).push([[0],{21:function(e,n,t){e.exports=t.p+"static/media/settings.04e848f8.svg"},23:function(e,n,t){e.exports=t(35)},28:function(e,n,t){},35:function(e,n,t){"use strict";t.r(n);var a=t(0),o=t.n(a),r=t(17),i=t.n(r),c=(t(28),t(4)),l=t(5),u=Object(l.a)({Bounder:{backgroundImage:"url(https://media.wired.com/photos/5a593a7ff11e325008172bc2/master/pass/pulsar-831502910.jpg)",width:"100vw",height:"100vh",display:"flex",fontSize:"calc(20px + 2vmin)",color:"white",position:"absolute",top:"0px",left:"0px",userSelect:"none",zIndex:"-1",overflow:"hidden"},ModuleViewBounder:{minWidth:"60vw",height:"100vh",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",zIndex:0,overflowX:"hidden",overflowY:"scroll","&::-webkit-scrollbar":{width:"0px"}}}),d="#282c34",s="#0000009e",m="#00347d",p="#001b40",f="black",g="#c0c0c038",v="#37538a",b="white",h="#007ab3",w="white",O="black",I="#cc00006e",C="#cc0000",D="red",y="#0000009e",j="white",E="#cc00006e",x="white",N="white",T="#85adad",S={width:"400px",toggleWidth:"2vmin",item:"9vmin"},R={iconGrid:"12vmin",gutterGrid:"6vmin",icon:"10vmin",bigIcon:"27vmin",bigIconWidth:"30vmin",bigIconHeight:"50vmin"},M={large:"calc(25px + 2.8vmin)",medium:"calc(20px + 2.4vmin)",small:"calc(12px + 1.2vmin)",xsmall:"calc(8px + 1vmin)",xxsmall:"calc(7px + .8vmin)"},k={size:"2.5vmin",borderRadius:"1.5vmin"},A={size:9,markerWidth:.5,markerHeight:1.3,rotRange:[-150,150],sensitivity:1,borderWidth:8},P=Object(l.a)({DrawerBounder:{width:"0px",height:"100vh",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",color:"white",position:"absolute",top:"0px",right:"0px",userSelect:"none",zIndex:10},Drawer:{backgroundColor:s,height:"100vh",width:S.width,display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"flex-start",position:"absolute",top:"0px",right:"0px"},DrawerHeader:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"inherit",overflowX:"scroll",overflowY:"hidden","&::-webkit-scrollbar":{height:"3px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},DrawerHeaderItem:{fontSize:M.medium,padding:"1vmin 1.5vmin",color:b,textDecoration:"none",whiteSpace:"nowrap","&:hover":{cursor:"pointer"}},ItemRouter:{width:S.width,display:"flex",flexFlow:"row wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",height:"calc(100% - 60px)",overflowY:"scroll","&::-webkit-scrollbar":{width:"0px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white"}},DrawerItem:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-evenly",borderRadius:"10px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",margin:"3vmin"},DrawerIcon:{backgroundColor:d,borderColor:d,borderStyle:"solid",width:S.item,height:S.item,borderRadius:"1.5vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",marginBottom:"1.5vmin","&:hover":{cursor:"pointer",borderColor:"white"}},DrawerItemText:{fontSize:M.small},Toggle:{backgroundColor:m,width:S.toggleWidth,zIndex:10,height:"100%",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{cursor:"pointer"},position:"absolute",top:"0px",right:S.width},ToggleLine:{backgroundColor:p,borderRadius:"4px",width:"0.75vmin",height:"80px"}}),F=t(10);var U=function(e){var n=e.className,t=e.text,a=e.onClick,r={color:e.selectedRoute===t?h:b};return o.a.createElement("div",{className:n,onClick:a,style:r},t)},_="VALUE",z=[["gain","gain","GAIN"],["filter","filter","AUTOFILTER"],["kompressor","komp","KOMPRESSOR"],["signal delay","delay","SIGNAL_DELAY"],["stereo panner","pan","STEREO_PANNER"]],L=[["file","file","MEDIA_ELEMENT"],["stream","stream","LINE_IN"],["oscillator","osc","OSCILLATOR"],["constant","const","CONSTANT"]],B=[["container","cntnr","CONTAINER"],["output","out","OUTPUT"]];function H(e,n){for(var t=0;t<n.length;t++)if(n[t]===e)return!0;return!1}function W(e,n){for(var t=[],a=e;a<n;a++)t.push(a);return t}function K(e,n){return Math.min(n[1],Math.max(n[0],e))}var V=0;var G=function(e){var n=e.fullName,t=e.id,a=e.moduleType,r=P();return o.a.createElement("div",{className:r.DrawerItem},o.a.createElement("div",{className:r.DrawerIcon,draggable:!0,onDragStart:function(e){e.dataTransfer.setData("id","".concat(t," ").concat(V)),e.dataTransfer.setData("moduleType",a),e.dataTransfer.setData("name",t),window.setFillIsExpanded(!0),V+=1},onDragEnd:function(){window.setFillIsExpanded(!1)}}),o.a.createElement("div",{className:r.DrawerItemText},n))};var q=function(e){var n=e.moduleData;return o.a.createElement(a.Fragment,null,n.map((function(e,n){return o.a.createElement(G,{fullName:e[0],id:e[1],moduleType:e[2],key:n})})))},Y=S.width;var Q=function(){var e=P(),n=Object(a.useState)(!0),t=Object(c.a)(n,2),r=t[0],i=t[1],l=Object(a.useState)(Y),u=Object(c.a)(l,2),d=u[0],s=u[1],m=Object(F.b)({transform:r?"translate(0px, 0px)":"translate(".concat(d,"px, 0px)"),config:{tension:220,clamp:!0}}),p=Object(a.useState)("sources"),f=Object(c.a)(p,2),g=f[0],v=f[1],b=Object(a.useRef)(null),h=Object(a.useRef)(null),w=Object(a.useRef)(null),O=Object(a.useRef)(null),I=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),C=!1,D=Object(a.useState)({}),y=Object(c.a)(D,2)[1];return Object(a.useEffect)((function(){window.addEventListener("resize",(function(){window.setTimeout((function(){y({})}),500)}))})),o.a.createElement(F.a.div,{className:e.DrawerBounder,style:m,onPointerDown:function(e){return e.stopPropagation()}},o.a.createElement("div",{className:e.Toggle,ref:h,onPointerDown:function(e){var n;r&&e.shiftKey?(C=!0,null===(n=h.current)||void 0===n||n.setPointerCapture(e.pointerId)):i(!r)},onPointerMove:function(e){C&&(Y="".concat(K(I-e.clientX,[150,700]),"px"),b.current&&(b.current.style.width=Y),w.current&&(w.current.style.width=Y),O.current&&(O.current.style.width=Y),h.current&&(h.current.style.right=Y))},onPointerUp:function(e){var n;C&&(C=!1,s(Y),null===(n=h.current)||void 0===n||n.releasePointerCapture(e.pointerId))}},o.a.createElement("div",{className:e.ToggleLine,onClick:function(){i(!r)}})),o.a.createElement("div",{className:e.Drawer,ref:b},o.a.createElement("div",{className:e.DrawerHeader,ref:w,onWheel:function(e){w&&w.current&&(w.current.scrollLeft+=e.deltaY)}},o.a.createElement(U,{className:e.DrawerHeaderItem,text:"sources",onClick:function(){v("sources")},selectedRoute:g}),o.a.createElement(U,{className:e.DrawerHeaderItem,text:"effects",onClick:function(){v("effects")},selectedRoute:g}),o.a.createElement(U,{className:e.DrawerHeaderItem,text:"utility",onClick:function(){v("utility")},selectedRoute:g})),o.a.createElement("div",{className:e.ItemRouter,ref:O},"sources"===g?o.a.createElement(q,{moduleData:L}):"effects"===g?o.a.createElement(q,{moduleData:z}):"utility"===g?o.a.createElement(q,{moduleData:B}):null)))},X=Object(l.a)({FillBounder:{backgroundColor:g,display:"flex",flexDirection:"column",margin:"5vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderRadius:"2vmin"},FillHeaderBounder:{display:"flex",justifyContent:"space-between"},FillHeader:{borderColor:"white",borderStyle:"none none solid none",padding:"1vmin",marginLeft:"2vmin","&:hover":{cursor:"pointer"}},Fill:{display:"grid",minWidth:R.iconGrid,minHeight:R.iconGrid,padding:"4vmin",zIndex:1,rowGap:R.gutterGrid,columnGap:R.gutterGrid},ArcherContainer:{width:"100%",height:"100%",zIndex:0,display:"grid"},Icon:{backgroundColor:v,borderRadius:"1.5vmin",borderStyle:"none",borderColor:"white",whiteSpace:"wrap",fontSize:M.medium,padding:"1vmin",display:"flex",flexFlow:"column nowrap",alignItems:"flex-end",justifyContent:"space-between",overflow:"hidden",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)","&:hover":{cursor:"pointer",borderStyle:"solid"},zIndex:2},IconControlContainer:{width:R.bigIconWidth,maxHeight:R.bigIconHeight,justifySelf:"flex-end",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",overflowY:"scroll",overflowX:"hidden"},ArcherElement:{zIndex:1,display:"grid",gridTemplateRows:"10px auto 10px",gridTemplateColumns:"10px auto 10px",padding:"1vmin"},IconName:{fontSize:M.small,"&:hover":{cursor:"pointer"}},IconConnector:{backgroundColor:D,width:k.size,height:k.size,borderRadius:k.borderRadius,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",borderStyle:"solid",borderColor:"transparent","&:hover":{cursor:"pointer",borderColor:"white"},justifySelf:"flex-start",alignSelf:"flex-end"}}),J=t(6),$=function(e,n,t,a,o,r,i,c){return{type:"ADD_MODULE",moduleType:t,id:e,name:n,row:o,col:r,parentID:a,connectionInputs:i,connectionOutputs:c}},Z=function(e,n,t){return{type:"MOVE_MODULE",id:e,newRow:n,newCol:t}},ee=function(e,n,t,a,o,r,i){return{type:"ADD_CONNECTION",fromID:e,toID:n,param:t,outputIndex:a,inputIndex:o,containerOutputChildID:r,containerInputChildID:i}},ne=function(e){return{type:"REMOVE_CONNECTION",connectionID:e}},te=t(14),ae=Object(l.a)({MenuHeader:{fontSize:M.medium,borderStyle:"none none solid none",margin:"1vmin",width:"90%"},Connection:{fontSize:M.small,backgroundColor:g,margin:".5vmin 3vmin",borderRadius:"1vmin",borderColor:"transparent",borderStyle:"solid",minWidth:"30%",padding:"1vmin",display:"flex",justifyContent:"center",alignItems:"center","&:hover":{cursor:"pointer",borderColor:I},boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"},ControlBounder:{display:"flex",flexFlow:"row wrap",alignItems:"center",fontSize:M.small,margin:"0vmin 1vmin"},ControlMenu:{display:"flex",flexFlow:"row wrap",width:"100%",alignItems:"center",justifyContent:"center"}}),oe=Object(l.a)({ControlTypeSelect:{minWidth:"9vmin",maxWidth:"5em",margin:"1vmin",fontSize:M.small,backgroundColor:y,color:j,textAlign:"center"},ControlInput:{minWidth:"9vmin",maxWidth:"5em",margin:"1vmin",fontSize:M.small},ControlMenu:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center"}});var re=function(e){var n=e.controlID,t=e.setFunc,a=e.reRenderIcon,r=oe();return o.a.createElement("div",{className:r.ControlMenu},o.a.createElement("label",{style:{minWidth:"50%"},htmlFor:window.highlightedID+n},o.a.createElement(Te,{style:{borderColor:I}},"choose file")),o.a.createElement("input",{style:{width:0,height:0,opacity:0},type:"file",id:window.highlightedID+n,onChange:function(e){var n=e.target.files[0];t(URL.createObjectURL(n)),window.audioTags[window.highlightedID].srcName=n.name,window.reRenderAudioTags(),a()}}),o.a.createElement("p",{style:{fontSize:M.xsmall,textAlign:"center",whiteSpace:"normal",justifyContent:"center",width:"100%",overflowWrap:"break-word",wordWrap:"break-word",hyphens:"auto"}},window.audioTags[window.highlightedID].srcName))};var ie=function(e){var n=e.setFunc,t=e.audioModule,r=e.value,i=e.selectedModule,c=e.reRenderIcon,l=oe(),u=t.audioNode;return o.a.createElement(a.Fragment,null,o.a.createElement("label",{htmlFor:"type"},"choose type"),o.a.createElement("select",{className:l.ControlTypeSelect,name:"type",id:"type",onChange:function(e){n(e.target.value),c()},value:r||u.type},t.typeTypes.map((function(e){return o.a.createElement("option",{value:e,key:i.id+e},e)}))))};function ce(e,n){return(e-n[0])/(n[1]-n[0])*(A.rotRange[1]-A.rotRange[0])+A.rotRange[0]}function le(e){var n=(Math.floor(10*e)/10).toString();return"."===n.slice(n.length-2,n.length-1)?n:n+".0"}var ue=function(e){var n=e.controlID,t=e.value,r=e.range,i=e.setFunc,l=e.actualModID,u=Object(a.useState)(r),d=Object(c.a)(u,2),s=d[0],m=d[1],p=Object(a.useState)(t),f=Object(c.a)(p,2),g=f[0],v=f[1],b=Object(a.useState)(le(g)),h=Object(c.a)(b,2),w=h[0],O=h[1],I=l||window.highlightedID;return o.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},o.a.createElement(Ze,{initValue:g,range:s,inputVal:w,setInputVal:O,onEveryChange:function(e){i(e.toString())},onChange:function(e){i(e.toString()),v(e)},onSettingsClick:function(){window.openRangeSetMenu(I,n,(function(e){m(e),v(K(g,e)),O(le(K(g,e)))}))}}),o.a.createElement("div",null,n))};var de=function(e){var n=e.setFunc,t=e.controlID;return o.a.createElement(Te,{style:{borderColor:I,width:"50%"},onClick:function(){n("")}},t)};var se=function(e){var n=e.controlID,t=e.setFunc;return o.a.createElement(Qe,{text:n,initState:!1,onSwitch:function(e){t(e?"true":"false")}})};var me=function(e){var n=e.audioModule,t=e.selectedModule,a=e.reRenderIcon,r=ae();return o.a.createElement("div",{className:r.ControlMenu},n?Object.keys(n.controlData).map((function(e,i){var c=n.controlData[e],l=c.controlType,u=c.value,d=c.range,s=n.controlSetFuncs[e];return o.a.createElement("div",{className:r.ControlBounder,key:t.id+i},l===_?o.a.createElement(ue,{controlID:e,value:u,range:d,setFunc:s}):"BUTTON"===l?o.a.createElement(de,{setFunc:s,controlID:e}):"TYPE"===l?o.a.createElement(ie,{setFunc:s,audioModule:n,value:u,selectedModule:t,reRenderIcon:a}):"FILE"===l?o.a.createElement(re,{controlID:e,setFunc:s,reRenderIcon:a}):"SWITCH"===l?o.a.createElement(se,{controlID:e,setFunc:s}):null)})):null)};function pe(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;0===t.length?e.audioNode.connect(n.audioNode,a,o):n.audioNode[t]?e.audioNode.connect(n.audioNode[t],a):alert("param does not exist")}function fe(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3?arguments[3]:void 0;0===t.length?"number"===typeof a?e.audioNode.disconnect(n.audioNode,a):e.audioNode.disconnect(n.audioNode):n.audioNode[t]?"number"===typeof a?e.audioNode.disconnect(n.audioNode[t],a):e.audioNode.disconnect(n.audioNode[t]):alert("param does not exist")}var ge=function(e){var n=e.selectedModule,t=e.modules,r=ae(),i=Object(J.b)(),c=window.audioModules,l=Object(J.c)((function(e){return e.connections}));return o.a.createElement(a.Fragment,null,n?0===n.inputs.length?null:o.a.createElement("div",{className:r.MenuHeader},"inputs"):null,n?n.inputs.map((function(e,a){var u=l[e],d=u.fromID,s=u.param,m=u.outputIndex,p=u.containerOutputChildID,f=u.containerInputChildID,g=t[d].name;return o.a.createElement("div",{className:r.Connection,key:d+s+"inp"+a,onClick:function(){i(ne(e)),fe(c[p||d],c[f||n.id],s,m)}},"".concat(g).concat(p?" - ".concat(t[p].name):"").concat(0!==s.length?" - ".concat(s):""))})):null,n?0===n.outputs.length?null:o.a.createElement("div",{className:r.MenuHeader},"outputs"):null,n?n.outputs.map((function(e,a){var u=l[e],d=u.toID,s=u.param,m=u.outputIndex,p=u.containerOutputChildID,f=u.containerInputChildID,g=t[d].name;return o.a.createElement("div",{className:r.Connection,key:d+s+"out"+a,onClick:function(){i(ne(e)),fe(c[p||n.id],c[f||d],s,m)}},"".concat(g).concat(f?" - ".concat(t[f].name):"").concat(0!==s.length?" - ".concat(s):""))})):null)};var ve=function(e){var n=e.selectedModule,t=Object(a.useState)(!1),r=Object(c.a)(t,2),i=r[0],l=r[1],u=window.audioModules[n.id],d=Object(J.b)();return o.a.createElement(a.Fragment,null,o.a.createElement(Te,{style:{fontSize:M.xsmall,marginTop:"2vmin"},onClick:function(){l(!i)}},"mark container controls"),o.a.createElement("div",null,i?Object.keys(u.controlData).map((function(e,t){return o.a.createElement(Qe,{initState:H(e,n.toContainerControls),text:e,style:{fontSize:M.xsmall,padding:"1vmin"},key:e+t,onSwitch:function(t){d(t?function(e,n){return{type:"MARK_CONTAINER_CONTROL",modID:e,controlID:n}}(n.id,e):function(e,n){return{type:"UNMARK_CONTAINER_CONTROL",modID:e,controlID:n}}(n.id,e))}})})):null))},be={fontSize:M.xsmall,padding:"1vmin"};var he=function(e){var n=e.baseContainerID,t=e.selectedModule,r=Object(J.b)();return t&&window.fillContainerID!==n?o.a.createElement(a.Fragment,null,0===Object.keys(window.audioModules[t.id]).length?null:o.a.createElement(ve,{selectedModule:t}),0===t.connectionInputs.length?null:o.a.createElement(Qe,{style:be,key:t.id+"inputSwitch",text:"mark as container input",initState:t.isContainerInput,onSwitch:function(e){r(e?{type:"MARK_CONTAINER_INPUT",id:window.highlightedID}:function(e){return{type:"UNMARK_CONTAINER_INPUT",id:e}}(window.highlightedID))}}),0===t.connectionOutputs.length?null:o.a.createElement(Qe,{style:be,key:t.id+"outputSwitch",text:"mark as container output",initState:t.isContainerOutput,onSwitch:function(e){r(e?{type:"MARK_CONTAINER_OUTPUT",id:window.highlightedID}:function(e){return{type:"UNMARK_CONTAINER_OUTPUT",id:e}}(window.highlightedID))}})):null};var we=function(e){var n=e.selectedModule,t=window.audioModules,a=Object(J.b)(),r=Object(J.c)((function(e){return e.connections}));return o.a.createElement(Te,{style:{backgroundColor:I,width:"50%",fontSize:M.small},onClick:function(){n.inputs.forEach((function(e){var n=r[e],a=n.fromID,o=n.toID,i=n.param,c=n.outputIndex,l=n.containerOutputChildID,u=n.containerInputChildID;fe(t[l||a],t[u||o],i,c)})),n.outputs.forEach((function(e){var n=r[e],a=n.fromID,o=n.toID,i=n.param,c=n.outputIndex,l=n.containerOutputChildID,u=n.containerInputChildID;fe(t[l||a],t[u||o],i,c)})),a({type:"REMOVE_MODULE",id:window.highlightedID}),window.highlightedID=""}},"delete")};var Oe=function(e){var n=e.selectedModule,t=e.reRenderIcon,a=ae();return o.a.createElement("div",{className:a.ControlMenu},n.containerControls.map((function(e,r){var i=e.modID,c=e.controlID,l=window.audioModules[i],u=l.controlData[c],d=u.controlType,s=u.value,m=u.range,p=l.controlSetFuncs[c];return o.a.createElement("div",{className:a.ControlBounder,key:n.id+r},d===_?o.a.createElement(ue,{controlID:c,value:s,range:m,setFunc:p,actualModID:i}):"BUTTON"===d?o.a.createElement(de,{setFunc:p,controlID:c}):"TYPE"===d?o.a.createElement(ie,{setFunc:p,audioModule:l,value:s,selectedModule:n,reRenderIcon:t}):"FILE"===d?o.a.createElement(re,{controlID:c,setFunc:p,reRenderIcon:t}):"SWITCH"===d?o.a.createElement(se,{controlID:c,setFunc:p}):null)})))};window.currUnHighlight=function(){};var Ie=function(e){var n=e.mod,t=e.gridCol,r=e.gridRow,i=X(),l=Object(a.useState)(n.id===window.highlightedID),u=Object(c.a)(l,2),d=u[0],s=u[1],m=Object(a.useState)(!1),p=Object(c.a)(m,2),f=p[0],g=p[1],v=Object(a.useState)(!1),b=Object(c.a)(v,2),h=b[0],w=b[1];function O(){w(!h)}var I={gridColumn:"".concat(t," / span 1"),gridRow:"".concat(r," / span 1"),borderStyle:d?"solid":"none"},C={gridColumn:"".concat(t," / span 1"),gridRow:"".concat(r," / span 1")},D=Object(F.b)({width:d?R.bigIconWidth:R.icon,height:d?R.bigIconHeight:R.icon,config:{tension:350,clamp:!0},onFrame:window.refreshArcherContainer,onRest:function(){g(d)}}),y=Object(F.b)({fontSize:d?M.medium:M.small,config:{tension:350,clamp:!0}}),j=Object(J.c)((function(e){return e})),E=j.modules,x=j.baseContainerID,N=j.connections,T=Object(J.b)();return o.a.createElement(a.Fragment,null,o.a.createElement(F.a.div,{className:i.Icon,style:Object.assign(D,I),onPointerDown:function(e){return e.stopPropagation()},onDragOver:function(e){e.preventDefault()},onDrop:function(e){var t=e.dataTransfer.getData("id");if(t){if(E[t]){var a=e.dataTransfer.getData("fromRow"),o=e.dataTransfer.getData("fromCol");window.setFillIsExpanded(!1),T(Z(t,n.row,n.col)),T(Z(n.id,Number(a),Number(o))),window.setTimeout(window.refreshArcherContainer,100)}}else if(0===n.connectionInputs.length&&0===window.audioModules[n.id].connectingParamIDs.length)alert("mod cannot accept input");else{var r=e.dataTransfer.getData("fromID");r&&window.openConnectionMenu(r,n.id)}s(!1)},draggable:!0,onDragStart:function(e){e.dataTransfer.setData("id",n.id),e.dataTransfer.setData("fromRow","".concat(n.row)),e.dataTransfer.setData("fromCol","".concat(n.col)),window.setFillIsExpanded(!0)},onDragEnd:function(){window.setFillIsExpanded(!1)},onClick:function(e){e.stopPropagation&&e.stopPropagation(),n.id===window.highlightedID?(window.currUnHighlight(),window.currUnHighlight=function(){}):(window.currUnHighlight(),s(!0),window.highlightedID=n.id,window.currUnHighlight=function(){window.highlightedID="",g(!1),s(!1)})}},0===n.connectionOutputs.length?null:o.a.createElement("div",{className:i.IconConnector,draggable:!0,onDragStart:function(e){e.stopPropagation(),e.dataTransfer.setData("fromID",n.id)}}),o.a.createElement(F.a.div,{className:i.IconName,style:y,onClick:function(e){d&&(e.stopPropagation(),window.openRenameMenu(n.id))}},n.name),f?o.a.createElement("div",{className:i.IconControlContainer,onClick:function(e){return e.stopPropagation()}},"CONTAINER"===n.moduleType?o.a.createElement(Oe,{selectedModule:n,reRenderIcon:O}):null,o.a.createElement(me,{audioModule:window.audioModules[n.id],selectedModule:n,reRenderIcon:O}),o.a.createElement(ge,{selectedModule:n,modules:E}),o.a.createElement(he,{baseContainerID:x,selectedModule:n}),o.a.createElement(we,{selectedModule:n})):null),o.a.createElement(F.a.div,{className:i.ArcherElement,style:Object.assign({},D,C)},o.a.createElement("div",{style:{gridColumn:"".concat(1," / span 1"),gridRow:"".concat(1," / span 1")}},o.a.createElement(te.ArcherElement,{id:n.id+" input"},o.a.createElement("div",{style:{width:"10px",height:"10px"}}))),o.a.createElement("div",{style:{gridColumn:"".concat(1," / span 1"),gridRow:"".concat(3," / span 1")}},o.a.createElement(te.ArcherElement,{id:n.id+" controls"},o.a.createElement("div",{style:{width:"10px",height:"10px"}}))),o.a.createElement("div",{style:{gridColumn:"".concat(3," / span 1"),gridRow:"".concat(1," / span 1")}},o.a.createElement(te.ArcherElement,{id:n.id+" output",relations:n.outputs.map((function(e){var n=N[e],t=n.toID,a=n.param;return{targetId:""===a?t+" input":t+" controls",targetAnchor:"left",sourceAnchor:"right",style:{strokeColor:""===a?"red":"blue"}}}))},o.a.createElement("div",{style:{width:"10px",height:"10px"}})))))};var Ce=Object(l.a)({DropSquare:{width:R.iconGrid,height:R.iconGrid,borderStyle:"solid",borderRadius:"10px",zIndex:1}});var De=function(e){var n=e.row,t=e.col,r=Ce(),i=Object(J.b)(),l=Object(J.c)((function(e){return{modules:e.modules}})).modules,u=Object(a.useState)(!1),d=Object(c.a)(u,2),s=d[0],m=d[1],p={gridColumn:"".concat(t+1," / span 1"),gridRow:"".concat(n+1," / span 1"),borderColor:s?w:"transparent"};return o.a.createElement("div",{className:r.DropSquare,style:p,onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){3===e.dataTransfer.types.length&&m(!0)},onDragLeave:function(e){3===e.dataTransfer.types.length&&m(!1)},onDrop:function(e){var a=e.dataTransfer.getData("id"),o=l[window.fillContainerID],r=o.childModules.concat(o.childModules),c=l[a],u=function(e,n,t,a){for(var o=0;o<t.length;o++){var r=a[t[o]];if(r.row===e&&r.col===n)return r.id}return!1}(n,t,r,l);if(c)if(u){var d=e.dataTransfer.getData("fromRow"),s=e.dataTransfer.getData("fromCol");m(!1),window.setFillIsExpanded(!1),i(Z(a,n,t)),i(Z(u,Number(d),Number(s))),window.setTimeout(window.refreshArcherContainer,1)}else m(!1),window.setFillIsExpanded(!1),i(Z(a,n,t)),window.setTimeout(window.refreshArcherContainer,1);else if(!u){var p=e.dataTransfer.getData("moduleType"),f=e.dataTransfer.getData("name");m(!1),window.addModule(a,f,window.fillContainerID,p,i,n,t),window.setFillIsExpanded(!1)}}})};var ye=function(){var e=X(),n=Object(a.useState)(!1),t=Object(c.a)(n,2),r=t[0],i=t[1];window.setFillIsExpanded=i;var l=Object(a.useState)(!1),u=Object(c.a)(l,2),d=u[0],s=u[1];window.reRenderFillContainer=function(){s(!d)};var m,p=Object(J.c)((function(e){return{modules:e.modules,baseContainerID:e.baseContainerID}})),f=p.modules,g=p.baseContainerID,v=f[window.fillContainerID],b=function(e,n){var t=0,a=0;return e.forEach((function(e){var o=n[e];o.row>t&&(t=o.row),o.col>a&&(a=o.col)})),{maxRow:t,maxCol:a}}(v.childModules,f),h=b.maxRow,w=b.maxCol,O=0===v.childModules.length;m=O?{gridTemplateRows:"repeat(".concat(1,", ","auto",")"),gridTemplateColumns:"repeat(".concat(1,", ","auto",")")}:{gridTemplateRows:"repeat(".concat(r?h+2:h+1,", ","auto",")"),gridTemplateColumns:"repeat(".concat(r?w+2:w+1,", ","auto",")")};var I=Object(a.useRef)(null);return window.refreshArcherContainer=function(){var e;null===(e=I.current)||void 0===e||e.refreshScreen()},o.a.createElement("div",{className:e.FillBounder},o.a.createElement("div",{className:e.FillHeaderBounder},o.a.createElement("div",{className:e.FillHeader,style:{width:"".concat(v.name.length/2,"em")},onClick:function(e){e.stopPropagation(),window.openRenameMenu(window.fillContainerID)},onPointerDown:function(e){return e.stopPropagation()}},v.name),v.id===g?null:o.a.createElement(Te,{style:{height:".7em"},onPointerDown:function(){window.fillContainerID=v.parentID,window.currUnHighlight(),window.reRenderFillContainer()}},o.a.createElement("div",null,"back"))),o.a.createElement(te.ArcherContainer,{ref:I,svgContainerStyle:{zIndex:-1},strokeWidth:4,arrowLength:0},o.a.createElement("div",{className:e.Fill,style:m},O?o.a.createElement(De,{row:0,col:0}):W(0,r?h+2:h+1).map((function(e){return W(0,r?w+2:w+1).map((function(n){return o.a.createElement(De,{key:"".concat(e," ").concat(n),row:e,col:n})}))})).flat(),v.childModules.map((function(e){var n=f[e];return o.a.createElement(Ie,{key:n.id,mod:n,gridRow:n.row+1,gridCol:n.col+1})})))))};var je=Object(l.a)({CenterMenuBounder:{backgroundColor:"rgba(0,0,0,0.7)",position:"absolute",top:0,left:0,width:"100vw",height:"100vh",zIndex:100},CenterMenu:{backgroundColor:f,position:"absolute",top:"50vh",left:"50vw",transform:"translate(-50%, calc(-50% - 50px))",display:"flex",flexDirection:"column",alignItems:"center",borderRadius:"2vmin",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",minWidth:"15vw",padding:"1vmin 2vmin 2vmin 2vmin",border:"1px solid white",zIndex:101},Header:{padding:"1vmin 2vmin",margin:"0vmin 0vmin 2vmin 0vmin",borderColor:"white",borderStyle:"none none solid none",fontSize:M.large}});var Ee=function(e){var n=e.children,t=e.header,a=e.onClose,r=je();return o.a.createElement("div",{className:r.CenterMenuBounder,onClick:function(e){e.stopPropagation(),a()},onPointerDown:function(e){return e.stopPropagation()}},o.a.createElement("div",{className:r.CenterMenu,onClick:function(e){e.stopPropagation()}},o.a.createElement("div",{className:r.Header},t),n))},xe=(Object(l.a)({TestingArea:{backgroundColor:"black",position:"absolute",top:"45vh",left:"25vw",width:"45vw",height:"50vh",display:"flex",flexDirection:"column",zIndex:150},ButtonDiv:{display:"flex",flexFlow:"row wrap"},Button:{margin:"2vmin",padding:"1vmin",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{cursor:"pointer"}}}),new(0,window.AudioContext));var Ne=Object(l.a)({Button:{backgroundColor:O,borderColor:"transparent",borderRadius:"1vmin",borderStyle:"solid","&:active":{borderColor:"transparent"},"&:hover":{cursor:"pointer",borderColor:"white"},display:"flex",alignItems:"center",justifyContent:"center",padding:"1vmin",margin:"1vmin",textAlign:"center"}});var Te=function(e){var n=e.onClick,t=e.children,a=e.style,r=e.onPointerDown,i=Ne();return o.a.createElement("div",{className:i.Button,onClick:n,onPointerDown:r,style:a},t)},Se=t(3),Re=t(1),Me=["sine","square","triangle","sawtooth"];var ke=function(){var e=xe.createOscillator(),n={"set type":{controlType:"TYPE",paramID:"type"},frequency:{controlType:_,paramID:"frequency",value:e.frequency.value,range:[0,2e4]},detune:{controlType:_,paramID:"detune",value:e.detune.value,range:[-100,100]}},t={"set type":function(n){e.type=n},frequency:function(t){n.frequency.value=Number(t),e.frequency.value=Number(t)},detune:function(t){n.detune.value=Number(t),e.detune.value=Number(t)},kill:function(){e.stop()}};return e.start(),{audioNode:e,typeTypes:Me,connectingParamIDs:["frequency","detune"],controlData:n,controlSetFuncs:t}};var Ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=xe.createGain();n.gain.value=e;var t=["gain"],a={gain:{controlType:_,paramID:"gain",value:0,range:[-2e4,2e4]},"fine gain":{controlType:_,paramID:"gain",value:0,range:[-1,1]}};function o(){n.gain.value=a.gain.value+a["fine gain"].value}var r={gain:function(e){a.gain.value=Number(e),o()},"fine gain":function(e){a["fine gain"].value=Number(e),o()}};return{audioNode:n,connectingParamIDs:t,controlData:a,controlSetFuncs:r}};var Pe=function(){xe.resume();var e=xe.createGain();e.connect(xe.destination);var n={"master gain":{controlType:_,paramID:"gain",value:1,range:[0,5],maxRange:[0,20]},resume:{controlType:"BUTTON",paramID:"n/a"},suspend:{controlType:"BUTTON",paramID:"n/a"}},t={"master gain":function(t){n["master gain"].value=Number(t),e.gain.value=Number(t)},resume:function(e){xe.resume()},suspend:function(e){xe.suspend()}};return{audioNode:e,connectingParamIDs:[],controlData:n,controlSetFuncs:t}},Fe=["lowpass","lowshelf","highpass","highshelf","allpass","bandpass","notch","peaking"];var Ue=function(){var e=xe.createBiquadFilter(),n={"set type":{controlType:"TYPE",paramID:"type"},frequency:{controlType:_,paramID:"frequency",value:e.frequency.value,range:[0,xe.sampleRate/2],maxRange:[0,xe.sampleRate/2]},detune:{controlType:_,paramID:"detune",value:e.detune.value,range:[-50,50],maxRange:[-153600,153600]},Q:{controlType:_,paramID:"Q",value:e.Q.value,range:[-30,30]},gain:{controlType:_,paramID:"gain",value:e.gain.value,range:[-2e4,1400],maxRange:[-2e4,1400]}},t={"set type":function(n){e.type=n},frequency:function(t){n.frequency.value=Number(t),e.frequency.value=Number(t)},detune:function(t){n.detune.value=Number(t),e.detune.value=Number(t)},Q:function(t){n.Q.value=Number(t),e.Q.value=Number(t)},gain:function(t){n.gain.value=Number(t),e.gain.value=Number(t)}};return{audioNode:e,typeTypes:Fe,connectingParamIDs:["frequency","detune","Q","gain"],controlData:n,controlSetFuncs:t}};var _e=function(){var e=xe.createDynamicsCompressor(),n={threshold:{controlType:_,paramID:"threshold",value:e.threshold.value,range:[-100,0]},knee:{controlType:_,paramID:"knee",value:e.knee.value,range:[0,40]},ratio:{controlType:_,paramID:"ratio",value:e.ratio.value,range:[1,20]},attack:{controlType:_,paramID:"attack",value:e.attack.value,range:[0,1]},release:{controlType:_,paramID:"release",value:e.release.value,range:[0,1]}},t={threshold:function(t){n.threshold.value=Number(t),e.threshold.value=Number(t)},knee:function(t){n.knee.value=Number(t),e.knee.value=Number(t)},ratio:function(t){n.ratio.value=Number(t),e.ratio.value=Number(t)},attack:function(t){n.attack.value=Number(t),e.attack.value=Number(t)},release:function(t){n.release.value=Number(t),e.release.value=Number(t)}};return{audioNode:e,connectingParamIDs:["threshold","knee","ratio","attack","release"],controlData:n,controlSetFuncs:t}};var ze=function(){var e=xe.createStereoPanner(),n={pan:{controlType:_,paramID:"pan",value:e.pan.value,range:[-1,1],maxRange:[-1,1]}},t={pan:function(t){n.pan.value=Number(t),e.pan.value=Number(t)}};return{audioNode:e,connectingParamIDs:["pan"],controlData:n,controlSetFuncs:t}};var Le=function(){var e=xe.createDelay(60),n={"delay time":{controlType:_,paramID:"delayTime",value:e.delayTime.value,range:[0,2],maxRange:[0,60]}},t={"delay time":function(t){n["delay time"].value=Number(t),e.delayTime.value=Number(t)}};return{audioNode:e,connectingParamIDs:["delayTime"],controlData:n,controlSetFuncs:t}},Be=["no ramp","linear","exponential"];var He=function(){var e=xe.createConstantSource();e.offset.value=0;var n={"set value":{controlType:_,paramID:"offset",value:0,range:[-100,100]},"set ramp type":{controlType:"TYPE",paramID:"n/a",value:"no ramp"},"ramp length":{controlType:_,paramID:"n/a",value:1,range:[0,100],maxRange:[0,1e4]},kill:{controlType:"BUTTON",paramID:"n/a"}},t={"no ramp":function(t){n["set value"].value=Number(t),e.offset.value=Number(t)},linear:function(t){n["set value"].value=Number(t),e.offset.linearRampToValueAtTime(Number(t),xe.currentTime+n["set ramp length"].value)},exponential:function(t){n["set value"].value=Number(t),e.offset.exponentialRampToValueAtTime(Number(t),xe.currentTime+n["set ramp length"].value)}},a={"set value":function(e){t[n["set ramp"].value](e)},"set ramp type":function(e){n["set ramp type"].value=e},"set ramp length":function(e){n["set ramp length"].value=Number(e)},kill:function(){e.stop()}};return e.start(),{audioNode:e,connectingParamIDs:["offset"],controlData:n,controlSetFuncs:a,typeTypes:Be}};var We=function(e){if(e.current){var n={"set file":function(n){e.current.src=n}};return{audioNode:xe.createMediaElementSource(e.current),ref:e,connectingParamIDs:[],controlData:{"set file":{controlType:"FILE",paramID:"n/a"}},controlSetFuncs:n}}return null};var Ke=function(e){navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1,latency:0}}).then((function(n){var t=xe.createMediaStreamSource(n),a=xe.createChannelSplitter(2);t.connect(a);var o={"number of channels: ":{controlType:"INFO",paramID:"n/a",value:0},mute:{controlType:"SWITCH",paramID:"n/a",value:!1}},r={"number of channels: ":function(e){o["number of channels: "].value=t.channelCount},mute:function(e){var t="true"===e;o.mute.value=t,n.getAudioTracks()[0].enabled=t}},i={audioNode:a,connectingParamIDs:[],controlData:o,controlSetFuncs:r};window.audioModules=Object(Re.a)(Object(Re.a)({},window.audioModules),{},Object(Se.a)({},e,i))}))};var Ve=function(e){return{connectingParamIDs:[],controlData:{open:{controlType:"BUTTON",paramID:"n/a"}},controlSetFuncs:{open:function(){window.fillContainerID=e,window.highlightedID="",window.currUnHighlight=function(){},window.reRenderFillContainer()}}}};var Ge=function(e){var n=e.id,t=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(!window.audioModules[n]){var e=We(t);e&&(window.audioModules=Object(Re.a)(Object(Re.a)({},window.audioModules),{},Object(Se.a)({},n,e)))}})),o.a.createElement("audio",{ref:t,autoPlay:!0})};window.addAudioTag=function(e){window.audioTags[e]={id:e,srcName:""}},window.audioTags={};var qe=function(){var e=Object(a.useState)(!1),n=Object(c.a)(e,2),t=n[0],r=n[1];window.reRenderAudioTags=function(){r(!t)};var i=Object.keys(window.audioTags);return o.a.createElement(a.Fragment,null,i.map((function(e){return o.a.createElement(Ge,{key:e,id:e})})))},Ye=Object(l.a)({Bounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-around",borderRadius:"15px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",userSelect:"none",margin:"10px","&:hover":{cursor:"pointer"}},Switch:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",justifySelf:"flex-end",borderRadius:"15px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",userSelect:"none",margin:"10px"}});var Qe=function(e){var n=e.text,t=e.onSwitch,r=e.initState,i=e.style,l=Object(a.useState)(r),u=Object(c.a)(l,2),s=u[0],m=u[1],p=Ye(),f=Object(F.b)({cx:s?"65":"25",fill:s?"green":"red",config:{tension:250}});return o.a.createElement("div",{className:p.Bounder,style:i},o.a.createElement("div",{onClick:function(){t(!s),m(!s)}},n),o.a.createElement("svg",{onClick:function(){t(!s),m(!s)},width:"90",height:"30"},o.a.createElement("rect",{width:"50",height:"20",x:"20",y:"5",rx:"10",ry:"10",fill:d}),o.a.createElement(F.a.circle,{cx:f.cx,cy:"15",r:"15",fill:f.fill})))},Xe=Object(l.a)({KnobContainer:{display:"grid",gridTemplateRows:"auto",gridTemplateColumns:"auto",placeItems:"center",margin:"1vmin"},KnobSVG:{gridRow:"1",gridColumn:"1",width:"".concat(A.size+1,"vmin"),height:"".concat(A.size+1,"vmin"),zIndex:9},KnobText:{gridRow:"1",gridColumn:"1",fontSize:M.xxsmall,textAlign:"center",color:j,zIndex:10,width:"4em",borderStyle:"none",backgroundColor:"transparent","&::-webkit-outer-spin-button":{"-webkit-appearance":"none",margin:0},"&::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0}},InteractionLayer:{gridRow:"1",gridColumn:"1",zIndex:11,width:"".concat(A.size,"vmin"),height:"".concat(A.size,"vmin")},SettingsButton:{width:"".concat(A.size/6,"vmin"),height:"".concat(A.size/6,"vmin"),gridRow:"1",gridColumn:"1",placeSelf:"end",zIndex:12}}),Je=t(21),$e=t.n(Je);var Ze=function(e){var n=e.initValue,t=e.range,r=e.onChange,i=e.onEveryChange,c=e.onSettingsClick,l=e.inputVal,u=e.setInputVal,d=Xe(),s=Object(a.useRef)(null),m=(t[1]-t[0])*A.sensitivity/200,p=K(n,t),f=Object(a.useRef)(null),g=function(e){p=K(p-e.movementY*m,t),s.current&&(s.current.style.transform="rotate(".concat(ce(p,t),"deg)")),f.current&&(f.current.value="".concat(le(p))),i&&i(p)},v=function(){r&&r(p),u(le(p))};return o.a.createElement("div",{className:d.KnobContainer},o.a.createElement("svg",{className:d.KnobSVG,width:"".concat(A.size+1,"vmin"),height:"".concat(A.size+1,"vmin"),ref:s,style:{transform:"rotate(".concat(ce(n,t),"deg)")}},o.a.createElement("circle",{cx:"".concat((A.size+1)/2,"vmin"),cy:"".concat((A.size+1)/2,"vmin"),r:"".concat(A.size/2,"vmin"),stroke:E,strokeWidth:A.borderWidth,fill:y}),o.a.createElement("rect",{width:"".concat(A.markerWidth,"vmin"),height:"".concat(A.markerHeight,"vmin"),x:"".concat((A.size+1)/2-A.markerWidth/2,"vmin"),y:".5vmin",fill:x})),o.a.createElement("input",{className:d.KnobText,ref:f,onChange:function(e){u(e.target.value),i&&i(K(Number(e.target.value),t))},onBlur:function(e){var n=K(Number(e.target.value),t);r&&r(n),u(le(n))},onKeyDown:function(e){var n;13===e.keyCode&&(null===(n=f.current)||void 0===n||n.blur())},type:"number",value:l}),o.a.createElement("div",{className:d.InteractionLayer,title:"".concat(n),onClick:function(e){return e.stopPropagation()},onDragStart:function(e){return e.stopPropagation()},onPointerDown:function(e){e.stopPropagation(),e.preventDefault(),e.shiftKey?f.current&&(f.current.placeholder=f.current.value,f.current.value="",f.current.focus()):window.openPointerLayer(e.pointerId,g,v)}}),c?o.a.createElement("img",{className:d.SettingsButton,src:$e.a,alt:"settings",onClick:c}):null)};var en=Object(l.a)({PointerLayer:{width:"100vw",height:"100vh",position:"absolute",top:0,left:0,zIndex:300}});var nn=function(e){var n=e.pointerLayerData,t=e.resetPointerLayerData,r=en(),i=n.pointerId,c=n.onPointerMove,l=n.onPointerUp,u=Object(a.useRef)(null);return Object(a.useEffect)((function(){})),o.a.createElement("div",{className:r.PointerLayer,ref:u,onPointerMove:function(e){e.pointerId===i&&c(e)},onPointerUp:function(e){e.pointerId===i&&(l(e),t())}})};function tn(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{isOpen:e,fromID:n,toID:t}}function an(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return{isOpen:e,modID:n,dataKey:t,onChangeSubmit:a}}var on=Object(l.a)({IORecursionBounder:{display:"flex",alignSelf:"flex-start",marginLeft:"5vmin",flexDirection:"column",alignItems:"flex-start",height:"60vmin",width:"90%",overflowY:"scroll",overflowX:"visible","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"white",borderRadius:"2px"}},IORecursionInnerBounder:{display:"flex",alignSelf:"flex-start",marginLeft:"2vmin",flexDirection:"column",alignItems:"flex-start"}});var rn=function e(n){var t=n.id,r=n.isOutput,i=n.setConnection,l=Object(J.c)((function(e){return["CONTAINER"===e.modules[t].moduleType,e.modules[t].name,r?e.modules[t].connectionOutputs:e.modules[t].connectionInputs]})),u=Object(c.a)(l,3),d=u[0],s=u[1],m=u[2],p=Object(a.useState)(!1),f=Object(c.a)(p,2),g=f[0],v=f[1],b=on();return d?o.a.createElement(a.Fragment,null,o.a.createElement(Te,{style:{color:T},onClick:function(){v(!g)}},s),g?o.a.createElement("div",{className:b.IORecursionInnerBounder},m.map((function(n){return o.a.createElement(e,{key:n,id:n,isOutput:r,setConnection:i})}))):null):m.length>1?o.a.createElement(a.Fragment,null,o.a.createElement(Te,{style:{color:T},onClick:function(){v(!g)}},s),g?o.a.createElement("div",{className:b.IORecursionInnerBounder},m.map((function(e,n){return o.a.createElement(Te,{style:{color:N},onClick:function(){i(t,n)}},e)}))):null):o.a.createElement(Te,{onClick:function(){i(t,0)}},s)},cn={};var ln=function(e){var n=e.fromID,t=e.toID,r=e.onClose,i=on(),l=window.audioModules,u=Object(J.c)((function(e){return e.modules})),d=u[n],s=u[t],m=Object(a.useState)(0),p=Object(c.a)(m,2),f=p[0],g=p[1],v=Object(a.useState)(0),b=Object(c.a)(v,2),h=b[0],w=b[1],O=Object(a.useState)(n),I=Object(c.a)(O,2),C=I[0],D=I[1],y=Object(a.useState)(t),j=Object(c.a)(y,2),E=j[0],x=j[1],N=Object(J.b)(),T="CONTAINER"===d.moduleType,S="CONTAINER"===s.moduleType,R=d.connectionOutputs.length>1||T?"CHOOSE_OUTPUT":s.connectionInputs.length>1||S?"CHOOSE_INPUT":"CONNECT_TO",M=Object(a.useState)(R),k=Object(c.a)(M,2),A=k[0],P=k[1];return o.a.createElement(a.Fragment,null,"CHOOSE_OUTPUT"===A?o.a.createElement(Ee,{header:"choose output",onClose:r},o.a.createElement("div",{className:i.IORecursionBounder},d.connectionOutputs.map((function(e){return o.a.createElement(rn,{key:e+"output",id:T?e:n,isOutput:!0,setConnection:function(e,n){D(e),g(n),s.connectionInputs.length>1||"CONTAINER"===s.moduleType?P("CHOOSE_INPUT"):P("CONNECT_TO")}})})))):"CHOOSE_INPUT"===A?o.a.createElement(Ee,{header:"choose input",onClose:r},o.a.createElement("div",{className:i.IORecursionBounder},s.connectionInputs.map((function(e){return o.a.createElement(rn,{key:e+"input",id:S?e:t,isOutput:!1,setConnection:function(e,n){x(e),w(n),P("CONNECT_TO")}})})))):"CONNECT_TO"===A?o.a.createElement(Ee,{header:"connect ".concat(T?d.name+" - "+u[C].name:d.name," to ").concat(S?s.name+" - "+u[E].name:s.name),onClose:r},(S?0===u[s.connectionInputs[h]].connectionInputs.length:0===s.connectionInputs.length)?null:o.a.createElement(Te,{style:cn,onClick:function(){pe(l[C],l[E],"",f,h),N(ee(n,t,"",f,h,T?C:void 0,S?E:void 0)),r()}},"module"),0===l[E].connectingParamIDs.length?null:o.a.createElement(Te,{style:cn,onClick:function(e){e.stopPropagation(),P("CHOOSE_PARAM")}},"params")):"CHOOSE_PARAM"===A?o.a.createElement(Ee,{header:"props",onClose:r},l[E].connectingParamIDs.map((function(e,a){return o.a.createElement(Te,{style:cn,key:n+t+a,onClick:function(){pe(l[C],l[E],e,f,h),N(ee(n,t,e,f,h,T?C:void 0,S?E:void 0)),r()}},e)}))):null)},un=Object(l.a)({CMInputBounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},CenterMenuInput:{backgroundColor:d,color:"white",height:"2vmin",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:M.small,width:"23vmin","&:hover":{cursor:"text"}},InputSubmit:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:d,height:"2vmin",padding:"1vmin",margin:"1.5vmin 1.5vmin 1.5vmin 0.75vmin",borderRadius:"1vmin","&:hover":{cursor:"pointer"},fontSize:M.small},Error:{backgroundColor:C,width:"90%",color:"white",fontSize:M.small,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"1vmin",padding:"1vmin 0vmin",marginBottom:"1vmin"}});var dn=function(e){var n,t=e.toRenameID,r=e.onClose,i=un(),l=Object(a.useRef)(null),u=Object(J.c)((function(e){return e.modules})),d=Object(J.b)(),s=Object(a.useState)(!1),m=Object(c.a)(s,2),p=m[0],f=m[1];function g(){if(l&&l.current){var e=l.current.value;0===e.length?f(!0):(d(function(e,n){return{type:"RENAME_MODULE",id:e,newName:n}}(t,e)),r())}}return o.a.createElement(Ee,{header:"rename",onClose:r},o.a.createElement("div",{className:i.CMInputBounder},o.a.createElement("input",{className:i.CenterMenuInput,placeholder:null===(n=u[t])||void 0===n?void 0:n.name,onKeyUp:function(e){13===e.keyCode?g():27===e.keyCode&&r()},ref:l,autoFocus:!0}),o.a.createElement("div",{className:i.InputSubmit,onClick:function(){g()}},"enter")),p?o.a.createElement("div",{className:i.Error},"please enter a name"):null)},sn=Object(l.a)({CMInputBounder:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},CenterMenuInput:{backgroundColor:d,color:"white",height:"2vmin",padding:"1vmin",margin:"1.5vmin .75vmin 1.5vmin 1.5vmin",borderStyle:"none",borderRadius:"1vmin",fontSize:M.small,width:"15vmin","&:hover":{cursor:"text"}}});var mn=function(e){var n=e.onClose,t=e.modID,r=e.dataKey,i=e.onChangeSubmit,l=window.audioModules[t].controlData[r],u=l.maxRange,d=l.range,s=l.value,m=Object(a.useState)(d[0]),p=Object(c.a)(m,2),f=p[0],g=p[1],v=Object(a.useState)(d[1]),b=Object(c.a)(v,2),h=b[0],w=b[1],O=sn();return o.a.createElement(Ee,{header:"set range",onClose:n},o.a.createElement("div",{style:{fontSize:M.small}},u?"max range from ".concat(u[0]," to ").concat(u[1]):null),o.a.createElement("div",{className:O.CMInputBounder,onKeyDown:function(e){27===e.keyCode&&n()}},o.a.createElement("input",{className:O.CenterMenuInput,onChange:function(e){g(u?K(Number(e.target.value),[u[0],h]):Math.min(Number(e.target.value),h))},value:f,type:"number"}),o.a.createElement("input",{className:O.CenterMenuInput,onChange:function(e){w(u?K(Number(e.target.value),[f,u[1]]):Math.max(Number(e.target.value),f))},value:h,type:"number"})),o.a.createElement(Te,{onClick:function(){window.audioModules[t].controlData[r].range[0]=f,window.audioModules[t].controlData[r].range[1]=h,window.audioModules[t].controlSetFuncs[r](K(s,[f,h]).toString()),i([f,h]),n()}},"confirm"))};var pn=function(){var e=Object(a.useState)(tn(!1)),n=Object(c.a)(e,2),t=n[0],r=n[1];window.openConnectionMenu=function(e,n){r(tn(!0,e,n))};var i=Object(a.useState)({isOpen:!1,toRenameID:""}),l=Object(c.a)(i,2),u=l[0],d=l[1];window.openRenameMenu=function(e){d({isOpen:!0,toRenameID:e})};var s=Object(a.useState)(an(!1)),m=Object(c.a)(s,2),p=m[0],f=m[1];return window.openRangeSetMenu=function(e,n,t){f(an(!0,e,n,t))},o.a.createElement(a.Fragment,null,t.isOpen?o.a.createElement(ln,{fromID:t.fromID,toID:t.toID,onClose:function(){r(tn(!1))}}):null,u.isOpen?o.a.createElement(dn,{toRenameID:u.toRenameID,onClose:function(){d({isOpen:!1,toRenameID:""})}}):null,p.isOpen?o.a.createElement(mn,{modID:p.modID,dataKey:p.dataKey,onClose:function(){f(an(!1))},onChangeSubmit:function(e){p.onChangeSubmit(e)}}):null)};var fn=function(){return function(e,n,t,a,o,r,i){switch(a){case"OSCILLATOR":window.audioModules=Object(Re.a)(Object(Re.a)({},window.audioModules),{},Object(Se.a)({},e,ke())),o($(e,n,a,t,r,i,[],["0"]));break;case"GAIN":window.audioModules=Object(Re.a)(Object(Re.a)({},window.audioModules),{},Object(Se.a)({},e,Ae())),o($(e,n,a,t,r,i,["0"],["0"]));break;case"OUTPUT":window.audioModules=Object(Re.a)(Object(Re.a)({},window.audioModules),{},Object(Se.a)({},e,Pe())),o($(e,n,a,t,r,i,["0"],[]));break;case"AUTOFILTER":window.audioModules=Object(Re.a)(Object(Re.a)({},window.audioModules),{},Object(Se.a)({},e,Ue())),o($(e,n,a,t,r,i,["0"],["0"]));break;case"KOMPRESSOR":window.audioModules=Object(Re.a)(Object(Re.a)({},window.audioModules),{},Object(Se.a)({},e,_e())),o($(e,n,a,t,r,i,["0"],["0"]));break;case"STEREO_PANNER":window.audioModules=Object(Re.a)(Object(Re.a)({},window.audioModules),{},Object(Se.a)({},e,ze())),o($(e,n,a,t,r,i,["0"],["0"]));break;case"SIGNAL_DELAY":window.audioModules=Object(Re.a)(Object(Re.a)({},window.audioModules),{},Object(Se.a)({},e,Le())),o($(e,n,a,t,r,i,["0"],["0"]));break;case"CONSTANT":window.audioModules=Object(Re.a)(Object(Re.a)({},window.audioModules),{},Object(Se.a)({},e,He())),o($(e,n,a,t,r,i,[],["0"]));break;case"MEDIA_ELEMENT":window.addAudioTag(e),window.reRenderAudioTags(),o($(e,n,a,t,r,i,[],["0"]));break;case"LINE_IN":Ke(e),o($(e,n,a,t,r,i,[],["0 (L)","1 (R)"]));break;case"CONTAINER":window.audioModules=Object(Re.a)(Object(Re.a)({},window.audioModules),{},Object(Se.a)({},e,Ve(e))),o($(e,n,a,t,r,i,[],[]))}}};function gn(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return{isOpen:e,pointerId:n,onPointerMove:t,onPointerUp:a}}window.highlightedID="project",window.fillContainerID="project",window.audioModules={},window.addModule=fn();var vn=function(){var e=u(),n=Object(a.useState)(gn(!1)),t=Object(c.a)(n,2),r=t[0],i=t[1];return window.openPointerLayer=function(e,n,t){i(gn(!0,e,n,t))},o.a.createElement("div",{className:e.Bounder,onPointerDown:function(){window.currUnHighlight(),window.currUnHighlight=function(){}}},o.a.createElement("div",{className:e.ModuleViewBounder},o.a.createElement(ye,null)),o.a.createElement(Q,null),o.a.createElement(qe,null),r.isOpen?o.a.createElement(nn,{pointerLayerData:r,resetPointerLayerData:function(){i(gn(!1))}}):null,o.a.createElement(pn,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var bn=t(15),hn=t(22),wn=t(7),On=function(e,n){var t,a,o=n.id,r=n.name,i=n.moduleType,c=n.row,l=n.col,u=n.parentID,d=n.connectionInputs,s=n.connectionOutputs;switch(i){case"CONTAINER":return Object.assign({},e,(t={},Object(Se.a)(t,o,{id:o,name:r,row:c,col:l,parentID:u,moduleType:i,connectionInputs:d,connectionOutputs:s,inputs:[],outputs:[],containerControls:[],toContainerControls:[],childModules:[],isBaseContainer:!1,isContainerInput:!1,isContainerOutput:!1}),Object(Se.a)(t,u,Object(Re.a)(Object(Re.a)({},e[u]),{},{childModules:[].concat(Object(wn.a)(e[u].childModules),[o])})),t));default:return Object.assign({},e,(a={},Object(Se.a)(a,o,{id:o,name:r,row:c,col:l,parentID:u,moduleType:i,connectionInputs:d,connectionOutputs:s,toContainerControls:[],isContainerInput:!1,isContainerOutput:!1,inputs:[],outputs:[]}),Object(Se.a)(a,u,Object(Re.a)(Object(Re.a)({},e[u]),{},{childModules:[].concat(Object(wn.a)(e[u].childModules),[o])})),a))}},In=function(e,n){var t=n.id,a=n.newRow,o=n.newCol;return Object.assign({},e,Object(Se.a)({},t,Object(Re.a)(Object(Re.a)({},e[t]),{},{row:a,col:o})))},Cn=function(e,n){var t=n.id,a=n.newName;return Object.assign({},e,Object(Se.a)({},t,Object(Re.a)(Object(Re.a)({},e[t]),{},{name:a})))},Dn=function(e,n){var t,a=n.id,o=e[a].parentID;return Object.assign({},e,(t={},Object(Se.a)(t,a,Object(Re.a)(Object(Re.a)({},e[a]),{},{isContainerInput:!0})),Object(Se.a)(t,o,Object(Re.a)(Object(Re.a)({},e[o]),{},{connectionInputs:[].concat(Object(wn.a)(e[o].connectionInputs),[a])})),t))},yn=function(e,n){var t,a=n.id,o=e[a].parentID;return Object.assign({},e,(t={},Object(Se.a)(t,a,Object(Re.a)(Object(Re.a)({},e[a]),{},{isContainerInput:!1})),Object(Se.a)(t,o,Object(Re.a)(Object(Re.a)({},e[o]),{},{connectionInputs:e[o].connectionInputs.filter((function(e){return e!==a}))})),t))},jn=function(e,n){var t,a=n.id,o=e[a].parentID;return Object.assign({},e,(t={},Object(Se.a)(t,a,Object(Re.a)(Object(Re.a)({},e[a]),{},{isContainerOutput:!0})),Object(Se.a)(t,o,Object(Re.a)(Object(Re.a)({},e[o]),{},{connectionOutputs:[].concat(Object(wn.a)(e[o].connectionOutputs),[a])})),t))},En=function(e,n){var t,a=n.id,o=e[a].parentID;return Object.assign({},e,(t={},Object(Se.a)(t,a,Object(Re.a)(Object(Re.a)({},e[a]),{},{isContainerInput:!1})),Object(Se.a)(t,o,Object(Re.a)(Object(Re.a)({},e[o]),{},{connectionOutputs:e[o].connectionOutputs.filter((function(e){return e!==a}))})),t))},xn=function(e,n){var t,a=n.modID,o=n.controlID,r=e[a].parentID;return Object.assign({},e,(t={},Object(Se.a)(t,a,Object(Re.a)(Object(Re.a)({},e[a]),{},{toContainerControls:[].concat(Object(wn.a)(e[a].toContainerControls),[o])})),Object(Se.a)(t,r,Object(Re.a)(Object(Re.a)({},e[r]),{},{containerControls:[].concat(Object(wn.a)(e[r].containerControls),[{modID:a,controlID:o}])})),t))},Nn=function(e,n){var t,a=n.modID,o=n.controlID,r=e[a].parentID;return Object.assign({},e,(t={},Object(Se.a)(t,a,Object(Re.a)(Object(Re.a)({},e[a]),{},{toContainerControls:e[a].toContainerControls.filter((function(e){return e!==o}))})),Object(Se.a)(t,r,Object(Re.a)(Object(Re.a)({},e[r]),{},{containerControls:e[r].containerControls.filter((function(e){return e.modID!==a||e.controlID!==o}))})),t))},Tn={project:{id:"project",name:"project",row:0,col:0,moduleType:"CONTAINER",connectionInputs:[],connectionOutputs:[],toContainerControls:[],inputs:[],outputs:[],parentID:null,childModules:[],isBaseContainer:!0,isContainerInput:!1,isContainerOutput:!1,containerControls:[]}},Sn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tn,n=arguments.length>1?arguments[1]:void 0;if(!n)return e;switch(n.type){case"ADD_MODULE":return On(e,n);case"MOVE_MODULE":return In(e,n);case"RENAME_MODULE":return Cn(e,n);case"MARK_CONTAINER_INPUT":return Dn(e,n);case"UNMARK_CONTAINER_INPUT":return yn(e,n);case"MARK_CONTAINER_OUTPUT":return jn(e,n);case"UNMARK_CONTAINER_OUTPUT":return En(e,n);case"MARK_CONTAINER_CONTROL":return xn(e,n);case"UNMARK_CONTAINER_CONTROL":return Nn(e,n);default:return e}},Rn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"project",n=arguments.length>1?arguments[1]:void 0;if(!n)return e;switch(n.type){case"DOWN_1_BASE":case"CHANGE_BASE":return n.newID;default:return e}},Mn=0,kn=function(e,n,t){var a,o=t.fromID,r=t.toID,i=t.param,c=t.outputIndex,l=t.inputIndex,u=t.containerOutputChildID,d=t.containerInputChildID,s="".concat(o," ").concat(r," ").concat(Mn);return Mn++,{newModules:Object.assign({},e,(a={},Object(Se.a)(a,o,Object(Re.a)(Object(Re.a)({},e[o]),{},{outputs:[].concat(Object(wn.a)(e[o].outputs),[s])})),Object(Se.a)(a,r,Object(Re.a)(Object(Re.a)({},e[r]),{},{inputs:[].concat(Object(wn.a)(e[r].inputs),[s])})),a),u?Object(Se.a)({},u,Object(Re.a)(Object(Re.a)({},e[u]),{},{outputs:[].concat(Object(wn.a)(e[u].outputs),[s])})):{},d?Object(Se.a)({},d,Object(Re.a)(Object(Re.a)({},e[d]),{},{inputs:[].concat(Object(wn.a)(e[d].inputs),[s])})):{}),newConnections:Object(Re.a)(Object(Re.a)({},n),{},Object(Se.a)({},s,{connectionID:s,fromID:o,toID:r,param:i,outputIndex:c,inputIndex:l,containerOutputChildID:u,containerInputChildID:d}))}};function An(e,n){return Object.fromEntries(Object.entries(e).filter((function(e){for(var t=0;t<n.length;t++)if(e[0]===n[t])return!1;return!0})))}var Pn=function(e,n,t){var a,o=t.connectionID,r=n[o],i=r.fromID,c=r.toID,l=r.containerOutputChildID,u=r.containerInputChildID;return{newModules:Object.assign({},e,(a={},Object(Se.a)(a,i,Object(Re.a)(Object(Re.a)({},e[i]),{},{outputs:e[i].outputs.filter((function(e){return e!==o}))})),Object(Se.a)(a,c,Object(Re.a)(Object(Re.a)({},e[c]),{},{inputs:e[c].inputs.filter((function(e){return e!==o}))})),a),l?Object(Se.a)({},l,Object(Re.a)(Object(Re.a)({},e[l]),{},{outputs:e[l].outputs.filter((function(e){return e!==o}))})):{},u?Object(Se.a)({},u,Object(Re.a)(Object(Re.a)({},e[u]),{},{inputs:e[i].outputs.filter((function(e){return e!==o}))})):{}),newConnections:An(n,[o])}},Fn=function(e,n,t){var a=t.id,o=e[a].parentID,r=An(e,[a]);return{newModules:Object.assign({},Object.fromEntries(Object.entries(r).map((function(n){return[n[0],Object(Re.a)(Object(Re.a)({},n[1]),{},{inputs:n[1].inputs.filter((function(n){return!H(n,[].concat(Object(wn.a)(e[a].inputs),Object(wn.a)(e[a].outputs)))})),outputs:n[1].outputs.filter((function(n){return!H(n,[].concat(Object(wn.a)(e[a].inputs),Object(wn.a)(e[a].outputs)))}))})]}))),Object(Se.a)({},o,Object(Re.a)(Object(Re.a)({},e[o]),{},{childModules:e[o].childModules.filter((function(e){return e!==a})),connectionInputs:e[o].connectionInputs.filter((function(e){return e!==a})),connectionOutputs:e[o].connectionOutputs.filter((function(e){return e!==a})),containerControls:e[o].containerControls.filter((function(e){return e.modID!==a}))}))),newConnections:An(n,[].concat(Object(wn.a)(e[a].inputs),Object(wn.a)(e[a].outputs)))}},Un=function(e,n,t){if(!t)return{newModules:e,newConnections:n};switch(t.type){case"ADD_CONNECTION":return kn(e,n,t);case"REMOVE_CONNECTION":return Pn(e,n,t);case"REMOVE_MODULE":return Fn(e,n,t);default:return{newModules:e,newConnections:n}}},_n={modules:Sn(),connections:{},baseContainerID:Rn()};function zn(e,n){return"ADD_CONNECTION"===n.type||"REMOVE_CONNECTION"===n.type||"REMOVE_MODULE"===n.type?Un(e.modules,e.connections,n):{newModules:Sn(e.modules,n),newConnections:e.connections}}var Ln=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_n,n=arguments.length>1?arguments[1]:void 0,t=zn(e,n),a=t.newModules,o=t.newConnections;return{modules:a,connections:o,baseContainerID:Rn(e.baseContainerID,n)}},Bn=Object(bn.createStore)(Ln,Object(hn.composeWithDevTools)());i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(J.a,{store:Bn},o.a.createElement(vn,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[23,1,2]]]);
//# sourceMappingURL=main.30e46582.chunk.js.map